(()=>{var ot=Object.defineProperty;var d=(se,ae)=>ot(se,"name",{value:ae,configurable:!0});(window.webpackJsonp=window.webpackJsonp||[]).push([["rollup-secondary_a_required","TS.enterprise","TS.utility"],{"/xdr":function(se,ae){(function(){TS.registerModule("redux.prefs",{setUserPrefs:function(a){TS.interop.prefs.setUserPrefs(a)},setTeamPrefs:function(a){TS.interop.prefs.setTeamPrefs(a)},setEnterprisePrefs:function(a){TS.interop.prefs.setEnterprisePrefs({prefs:a})},setUserPref:function(a,t){TS.redux.prefs.getUserPref(a)!==t&&TS.interop.prefs.setUserPref({pref:a,value:t})},setTeamPref:function(a,t){TS.redux.prefs.getTeamPref(a)!==t&&TS.interop.prefs.setTeamPref({pref:a,value:t})},getUserPref:function(a){return TS.interop.prefs.getUserPref(a)},getTeamPref:function(a){return TS.interop.prefs.getTeamPref(a)},test:function(){var a={};return a}})})()},"2hNN":function(se,ae){(function(){TS.registerModule("redux.bots",{onStart:function(){Object.defineProperty(TS.model,"bots",{get:function(){return TS.redux.bots.getAllBots()},set:function(){return TS.boot_data.feature_tinyspeck&&TS.warn("TS.redux.bots: Set TS.model.bots"),!1}})},getBotByMsg:function(c){var v=t(c);return v?o(v):null},getAllBots:function(){return _.values(a())},bulkUpsertBots:function(c){_.isArray(c)&&TS.redux.dispatch(TS.interop.redux.models.bots.bulkUpsertBots({bots:c}))}});var a=TS.redux.bindSelectorToStore("TS.interop.redux.models.bots.getAllBots"),t=TS.redux.bindSelectorToStore("TS.interop.redux.models.bots.getBotByMsg"),f={},i={},l=d(function(){return TS.boot_data&&(TS.boot_data.version_ts==="dev"||TS.boot_data.version_ts==="local_js")},"_isDev"),e=d(function(c,v){return typeof v!="symbol"&&(_.isNumber(f[v])||(f[v]=0,i[v]=0),f[v]+=1),c[v]},"_getProperty"),n=d(function(c,v,h){return typeof v!="symbol"&&(_.isNumber(i[v])||(f[v]=0,i[v]=0),i[v]+=1),c[v]=h,!0},"_setProperty"),o=d(function(c){return!window.Proxy||!l()?c:new window.Proxy(c,{get:function(v,h){return e(v,h)},set:function(v,h,u){return n(v,h,u)}})},"_wrapBot")})()},"3Vm1":function(se,ae){(function(){TS.registerModule("user_groups",{updated_sig:new signals.Signal,updated_info_sig:new signals.Signal,changed_is_unknown_sig:new signals.Signal,unknown_resolution_rebuild_sig:new signals.Signal,legacyNeedsToFetchMembership(a){return a.users===void 0||_.size(a.users)!==a.user_count}})})()},"4Cq+":function(se,ae){(function(){TS.registerModule("bots",{legacyEnsureBotsInDataArePresent:function(a){var t=TS.interop.utility.extractAllBotIds(a);return TS.interop.bots.ensureBotsArePresent(t)}})})()},"4KQo":function(se,ae){(function(){TS.registerModule("utility.date",{do24hrTime:function(){return TS.model.user&&TS.prefs.prefs_loaded&&TS.prefs.getPref("time24")}})})()},"5+2p":function(se,ae){(function(){TS.registerModule("click",{onStart:function(){f(),t()},addHandler:function(e,n,o){_.isFunction(e)&&(o=n,n=e,e=null),a.push({selector:e,fn:n,prevent_on_drag:o||!1})},test:function(){return{addAll:t,setupBinding:f,handlers:function(){return a},resetHandlers:function(){a=[]},unbind:function(){$("body").off("click.ts_dot_click"),$("body").off("mousedown.ts_dot_click_mousedown")}}}});var a=[],t=d(function(){TS.click.addHandler(".inline_attachment.clickable, .inline_attachment.clickable + .reply_broadcast_rule",function(e,n){var o=["a",".media_caret",".msg_inline_video_buttons_div"].join(",");if(!$(e.target).closest(o).length){var c;n.is(".reply_broadcast")||n.closest(".reply_broadcast_rule").length?c=n.closest(".message_body").find('[data-action="open_conversation"]'):c=n.find(".attachment_from_url_link"),c[0]&&c[0].click()}},!0)},"_addAll"),f=d(function(){var e={};$("body").on("mousedown.ts_dot_click_mousedown",function(n){e.x=n.clientX,e.y=n.clientY}),$("body").on("click.ts_dot_click",function(n){if(!n.isDefaultPrevented()){var o=$(n.target);if(!(o.parents("[data-reactroot]").length||o.parents(".ReactModalPortal").length)){for(var c=i(n),v,h,u=0;u<a.length;u+=1)if(v=a[u],h=null,!(v.prevent_on_drag&&(n.clientX!=e.x||n.clientY!=e.y))){if(v.selector){if(h=o.closest(v.selector),!h.length)continue;v.fn(n,h,c),n.isDefaultPrevented()&&TS.has_pri[l]&&TS.log(l,`click on ${v.selector}`)}else v.fn(n,c);if(n.isDefaultPrevented())return}}}})},"_setupBinding"),i=d(function(e){var n=$(e.target);if(n.closest("#member_stars_list").length)return"starred_items";if(n.closest("#member_mentions").length)return"mentions";if(n.closest("#file_list").length)return"file_list";if(n.closest("#file_preview_scroller").length)return"file_preview";if(n.closest("#member_preview_scroller").length)return"member_preview";if(n.closest("#convo_scroller").length)return"conversation";if(n.closest("#groups_tab").length)return"groups";if(n.closest("#threads_msgs_scroller_div").length)return"threads";if(n.closest("#channel_page_scroller").length){var o=TS.shared.legacyGetActiveModelOb(),c="channel_page";return o.is_group&&!o.is_mpim?c="group_page":(o.is_im||o.is_mpim)&&(c="im_page"),c}return null},"_getPreviewOrigin"),l=2003})()},"54vr":function(se,ae){(function(){TS.registerModule("enterprise",{})})()},"6btA":function(se,ae){(function(){TS.registerModule("utility.msgs",{setMsgs:function(a,t){for(var f=0;f<t.length;f+=1)t[f]=TS.utility.msgs.makeSureMsgObIsValid(t[f]);return TS.utility.msgs.sortMsgs(t),a.msgs=t,a.msgs},sortMsgs:function(a){function t(f,i){return f.ts<i.ts?1:f.ts>i.ts?-1:0}d(t,"compare"),a.sort(t)},legacyMsgDeletedWorker:function(a,t){TS.pins&&TS.pins.legacyRemoveMsg(t.deleted_ts,a)},makeSureMsgObIsValid:function(a){return a},_handleLegacyAttachment:function(a,t){if(!a){TS.warn("attachment is null!");return}return delete a.mrkdwn_in,a._index=t,"id"in a&&(a.id=a.id.toString()),a},updateCommentReferences:function(a){if(a){var t=TS.interop.channels.getAllChannels();_.forEach(t,function(f){_.forEach(f.msgs,function(i){if(!(!i.file||i.file.id!==a.id)&&i.comment){var l=_.find(a.comments,{id:i.comment.id});l&&(i.comment=l)}})})}},ingestMessagesFromBootData:function(a){if(TS.boot_data.msgs){var t=TS.boot_data.msgs[a.id]||[],f=TS.interop.messages.preprocessImsgs(t.filter(i=>!!i.ts),a.id);TS.utility.msgs.setMsgs(a,f)}},maybeClearPrevLastRead:function(a){a=a||TS.shared.legacyGetActiveModelOb(),a&&a._prev_last_read&&(a._prev_last_read=void 0)}})})()},"7EQy":function(se,ae){(function(){TS.registerModule("team",{team_name_changed_sig:new signals.Signal,onStart:function(){TS.team.team_name_changed_sig.add(t)},ensureTeamProfileFields:function(){return a||(a=TS.interop.api.call("team.profile.get").then(function(f){TS.redux.teams.upsertTeam(_.assign({id:TS.boot_data.team_id},{profile:f.data.profile}))}),a)},getTeamProfileFieldById:function(f){TS.model.team.profile.fields.length||TS.warn("Ensure profile fields exist before calling getTeamProfileFieldById");for(var i=0;i<TS.model.team.profile.fields.length;i+=1)if(TS.model.team.profile.fields[i].id===f)return TS.model.team.profile.fields[i];return null},getVisibleTeamProfileFields:function(){return TS.model.team.profile.fields.length||TS.warn("Ensure profile fields exist before calling getVisibleTeamProfileFields"),TS.model.team.profile.fields.filter(function(f){return!f.is_hidden})},getHiddenTeamProfileFields:function(){return TS.model.team.profile.fields.length||TS.warn("Ensure profile fields exist before calling getHiddenTeamProfileFields"),TS.model.team.profile.fields.filter(function(f){return f.is_hidden})},sortTeamProfileFieldsByOrdering:function(f){if(!f||!f.length)TS.warn("Ensure profile fields exist before calling sortTeamProfileFieldsByOrdering");else return _.clone(f).sort(function(i,l){return i.ordering-l.ordering})},getVisibleTeamProfileFieldsForMember:function(f,i){return f&&f.profile?(TS.model.team.profile.fields.length||TS.warn("Ensure profile fields exist before calling getVisibleTeamProfileFieldsForMember"),TS.model.team.profile.fields.filter(function(l){return(i||_.get(f.profile,["fields",l.id,"value"]))&&!l.is_hidden}).map(function(l){var e=_.get(f.profile,["fields",l.id,"value"]),n=_.get(f.profile,["fields",l.id,"alt"]),o=e&&l.type==="date"?TS.interop.datetime.convertISOtoUTCReadableDate(e):n;return $.extend(!0,{value:e,alt:o},l)})):[]}});var a,t=d(function(){$("#team_name").text(TS.model.team.name),document.title=document.title.replace(TS.model.last_team_name,TS.model.team.name),TS.model.last_team_name=TS.model.team.name},"_handleTeamRename")})()},"8FFK":function(se,ae){(function(){TS.registerModule("prefs",{all_notifications_prefs_changed_sig:new signals.Signal,highlight_words_changed_sig:new signals.Signal,seen_welcome_2_changed_sig:new signals.Signal,emoji_mode_changed_sig:new signals.Signal,obey_inline_img_limit_changed_sig:new signals.Signal,messages_theme_changed_sig:new signals.Signal,expand_inline_imgs_changed_sig:new signals.Signal,expand_internal_inline_imgs_changed_sig:new signals.Signal,expand_non_media_attachments_changed_sig:new signals.Signal,webapp_spellcheck_changed_sig:new signals.Signal,color_names_in_list_changed_sig:new signals.Signal,search_exclude_channels_changed_sig:new signals.Signal,box_enabled_changed_sig:new signals.Signal,dropbox_enabled_changed_sig:new signals.Signal,read_changed_sig:new signals.Signal,push_changed_sig:new signals.Signal,time24_changed_sig:new signals.Signal,sidebar_behavior_changed_sig:new signals.Signal,dtop_notif_changed_sig:new signals.Signal,muted_channels_changed_sig:new signals.Signal,mac_ssb_bullet_changed_sig:new signals.Signal,team_hide_referers_changed_sig:new signals.Signal,sidebar_theme_changed_sig:new signals.Signal,no_invites_widget_in_sidebar_changed_sig:new signals.Signal,k_key_omnibox_auto_hide_count_changed_sig:new signals.Signal,display_real_names_override_changed_sig:new signals.Signal,team_display_real_names_changed_sig:new signals.Signal,team_perms_pref_changed_sig:new signals.Signal,privacy_policy_seen_changed_sig:new signals.Signal,two_factor_update_seen_changed_sig:new signals.Signal,compliance_export_start_changed_sig:new signals.Signal,team_disallow_public_file_urls_changed_sig:new signals.Signal,mentions_exclude_at_channels_changed_sig:new signals.Signal,mentions_exclude_at_user_groups_changed_sig:new signals.Signal,team_auth_mode_changed_sig:new signals.Signal,team_sso_auth_restrictions_changed_sig:new signals.Signal,preferred_skin_tone_changed_sig:new signals.Signal,separate_private_channels_changed_sig:new signals.Signal,separate_shared_channels_changed_sig:new signals.Signal,whats_new_read_changed_sig:new signals.Signal,team_dnd_enabled_changed_sig:new signals.Signal,team_dnd_start_hour_changed_sig:new signals.Signal,team_dnd_end_hour_changed_sig:new signals.Signal,team_invites_only_admins_changed_sig:new signals.Signal,tz_changed_sig:new signals.Signal,keyboard_changed_sig:new signals.Signal,msg_input_send_btn_changed_sig:new signals.Signal,msg_input_send_btn_auto_set_changed_sig:new signals.Signal,team_allow_calls_changed_sig:new signals.Signal,team_calling_app_name_changed_sig:new signals.Signal,team_calling_app_id_changed_sig:new signals.Signal,frecency_jumper_changed_sig:new signals.Signal,jumbomoji_changed_sig:new signals.Signal,hide_hex_swatch_changed_sig:new signals.Signal,channel_sort_changed_sig:new signals.Signal,show_memory_instrument_changed_sig:new signals.Signal,enable_unread_view_changed_sig:new signals.Signal,enable_react_emoji_picker_changed_sig:new signals.Signal,team_disable_file_editing_changed_sig:new signals.Signal,team_disable_file_deleting_changed_sig:new signals.Signal,team_display_email_addresses_changed_sig:new signals.Signal,email_alerts_changed_sig:new signals.Signal,team_uses_customized_custom_status_presets_changed_sig:new signals.Signal,team_loud_channel_mentions_limit_changed_sig:new signals.Signal,locale_changed_sig:new signals.Signal,enable_shared_channels_changed_sig:new signals.Signal,prefs_loaded:!1,setPrefs:function(t){var f=TS.prefs.getPref("muted_channels");TS.redux.prefs.setUserPrefs(t),TS.prefs.prefs_loaded=!0,TS.prefs.mergeFrecencyJumper(TS.ui.frecency.isEnterprise()?TS.prefs.getPref("frecency_ent_jumper"):TS.prefs.getPref("frecency_jumper")),TS.prefs.setUserColors(TS.prefs.getPref("user_colors")),TS.prefs.setLoudChannels(TS.prefs.getPref("loud_channels")),TS.prefs.setSuppressedChannels(TS.prefs.getPref("at_channel_suppressed_channels")),TS.prefs.setPushSuppressedChannels(TS.prefs.getPref("push_at_channel_suppressed_channels")),TS.prefs.setNeverChannels(TS.prefs.getPref("never_channels")),TS.prefs.setMutedChannels(TS.prefs.getPref("muted_channels"),f),TS.prefs.setLoudChannelsSet(TS.prefs.getPref("loud_channels_set")),TS.prefs.setPushLoudChannels(TS.prefs.getPref("push_loud_channels")),TS.prefs.setPushMentionChannels(TS.prefs.getPref("push_mention_channels")),TS.prefs.setPushLoudChannelsSet(TS.prefs.getPref("push_loud_channels_set")),TS.prefs.setSearchExcludeChannels(TS.prefs.getPref("search_exclude_channels")),TS.prefs.setChannelSort(TS.prefs.getPref("channel_sort")),TS.prefs.setSidebarThemeCustomValues(TS.utility.parseJSONOrElse(TS.prefs.getPref("sidebar_theme_custom_values"),void 0)),TS.prefs.setTheme(),TS.prefs.setPrefLocal("emoji_autocomplete_big",!1)},setChannelSort:function(t){TS.model.channel_sort=t},setHighlightWords:function(t){TS.prefs.setPrefLocal("highlight_words",t)},setSuppressedChannels:function(t){let{skipSettingLocalPref:f=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f||TS.prefs.setPrefLocal("at_channel_suppressed_channels",t),TS.model.at_channel_suppressed_channels=[],t&&typeof t=="string"&&(TS.model.at_channel_suppressed_channels=TS.model.at_channel_suppressed_channels.concat(t.split(",")))},setPushSuppressedChannels:function(t){let{skipSettingLocalPref:f=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f||TS.prefs.setPrefLocal("push_at_channel_suppressed_channels",t),TS.model.push_at_channel_suppressed_channels=[],t&&typeof t=="string"&&(TS.model.push_at_channel_suppressed_channels=TS.model.push_at_channel_suppressed_channels.concat(t.split(",")))},setLoudChannels:function(t){let{skipSettingLocalPref:f=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f||TS.prefs.setPrefLocal("loud_channels",t),TS.model.loud_channels=[],t&&typeof t=="string"&&(TS.model.loud_channels=TS.model.loud_channels.concat(t.split(",")))},setNeverChannels:function(t){let{skipSettingLocalPref:f=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f||TS.prefs.setPrefLocal("never_channels",t),TS.model.never_channels=[],t&&typeof t=="string"&&(TS.model.never_channels=TS.model.never_channels.concat(t.split(",")))},setMutedChannels:function(t,f){var i;if(f||(f=TS.prefs.getPref("muted_channels")),f!==t||!a)i=TS.prefs.getPref("muted_channels")&&typeof TS.prefs.getPref("muted_channels")=="string"?TS.prefs.getPref("muted_channels").split(","):[],TS.prefs.setPrefLocal("muted_channels",t);else return;a=!0;var l,e,n=[],o=[];t&&typeof t=="string"&&(n=n.concat(t.split(",")),o=_.difference(i,n));const c=!1;for(l=0;l<n.length;l+=1)e=TS.redux.channels.getEntityById(n[l],c),e&&e.unread_cnt&&(e._show_in_list_even_though_no_unreads=!0);return TS.model.channels.forEach(function(v){TS.notifs.isCorGMuted(v.id)||(v._show_in_list_even_though_no_unreads=!1)}),TS.model.groups.forEach(function(v){TS.notifs.isCorGMuted(v.id)||(v._show_in_list_even_though_no_unreads=!1)}),TS.redux.channels.updateMutedChannels(n),o},setLoudChannelsSet:function(t){let{skipSettingLocalPref:f=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f||TS.prefs.setPrefLocal("loud_channels_set",t),TS.model.loud_channels_set=[],t&&typeof t=="string"&&(TS.model.loud_channels_set=TS.model.loud_channels_set.concat(t.split(",")))},setPushLoudChannels:function(t){let{skipSettingLocalPref:f=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f||TS.prefs.setPrefLocal("push_loud_channels",t),TS.model.push_loud_channels=[],t&&typeof t=="string"&&(TS.model.push_loud_channels=TS.model.push_loud_channels.concat(t.split(",")))},setPushMentionChannels:function(t){let{skipSettingLocalPref:f=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f||TS.prefs.setPrefLocal("push_mention_channels",t),TS.model.push_mention_channels=[],t&&typeof t=="string"&&(TS.model.push_mention_channels=TS.model.push_mention_channels.concat(t.split(",")))},setPushLoudChannelsSet:function(t){let{skipSettingLocalPref:f=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f||TS.prefs.setPrefLocal("push_loud_channels_set",t),TS.model.push_loud_channels_set=[],t&&typeof t=="string"&&(TS.model.push_loud_channels_set=TS.model.push_loud_channels_set.concat(t.split(",")))},setSearchExcludeChannels:function(t){let{skipSettingLocalPref:f=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f||TS.prefs.setPrefLocal("search_exclude_channels",t),TS.model.search_exclude_channels=[],t&&typeof t=="string"&&(TS.model.search_exclude_channels=TS.model.search_exclude_channels.concat(t.split(",")))},mergeFrecencyJumper:function(t){return(!t||typeof t!="object")&&(t=TS.utility.parseJSONOrElse(t||null)||{}),TS.model.frecency_jumper=t,!0},setUserColors:function(t){let{skipSettingLocalPref:f=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};f||TS.prefs.setPrefLocal("user_colors",t);var i=t?JSON.parse(t):{};TS.model.user_colors=i||{}},setTheme:function(){TS.prefs.getPref("messages_theme")==="default"&&TS.prefs.setPrefLocal("messages_theme","light_with_avatars"),TS.prefs.setPrefLocal("theme","light"),TS.prefs.setPrefLocal("avatars",!0),TS.prefs.getPref("messages_theme")==="dense"?(TS.prefs.setPrefLocal("theme","dense"),TS.prefs.setPrefLocal("avatars",!1)):TS.prefs.getPref("messages_theme")==="light"?(TS.prefs.setPrefLocal("theme","light"),TS.prefs.setPrefLocal("avatars",!1)):TS.prefs.getPref("messages_theme")==="light_with_avatars"&&(TS.prefs.setPrefLocal("theme","light"),TS.prefs.setPrefLocal("avatars",!0))},legacyOnTeamPrefChanged:function(t){t.name==="msg_edit_window_mins"?TS.prefs.setTeamPrefLocal("msg_edit_window_mins",t.value):t.name==="allow_message_deletion"?TS.prefs.setTeamPrefLocal("allow_message_deletion",!!t.value):t.name==="hide_referers"?(TS.prefs.setTeamPrefLocal("hide_referers",!!t.value),TS.prefs.team_hide_referers_changed_sig.dispatch()):t.name==="display_real_names"?(TS.prefs.setTeamPrefLocal("display_real_names",!!t.value),TS.prefs.team_display_real_names_changed_sig.dispatch()):t.name==="display_email_addresses"?(TS.prefs.setTeamPrefLocal("display_email_addresses",!!t.value),TS.prefs.team_display_email_addresses_changed_sig.dispatch()):t.name.indexOf("who_can_")===0?TS.prefs.getTeamPref(t.name)!=t.value&&(TS.prefs.setTeamPrefLocal(t.name,t.value),TS.prefs.team_perms_pref_changed_sig.dispatch(t.name)):t.name==="compliance_export_start"?TS.prefs.getTeamPref("compliance_export_start")!=t.value&&(TS.prefs.setTeamPrefLocal("compliance_export_start",t.value),TS.prefs.compliance_export_start_changed_sig.dispatch()):t.name==="disallow_public_file_urls"?(TS.prefs.setTeamPrefLocal("disallow_public_file_urls",!!t.value),TS.prefs.team_disallow_public_file_urls_changed_sig.dispatch()):t.name==="auth_mode"?(TS.prefs.setTeamPrefLocal("auth_mode",t.value),TS.prefs.team_auth_mode_changed_sig.dispatch()):t.name==="sso_auth_restrictions"?(TS.prefs.setTeamPrefLocal("sso_auth_restrictions",t.value),TS.prefs.team_sso_auth_restrictions_changed_sig.dispatch()):t.name==="dnd_enabled"?(TS.prefs.setTeamPrefLocal("dnd_enabled",t.value),TS.prefs.team_dnd_enabled_changed_sig.dispatch()):t.name==="dnd_start_hour"?(TS.prefs.setTeamPrefLocal("dnd_start_hour",t.value),TS.prefs.team_dnd_start_hour_changed_sig.dispatch()):t.name==="dnd_end_hour"?(TS.prefs.setTeamPrefLocal("dnd_end_hour",t.value),TS.prefs.team_dnd_end_hour_changed_sig.dispatch()):t.name==="invites_only_admins"?(TS.prefs.setTeamPrefLocal("invites_only_admins",t.value),TS.prefs.team_invites_only_admins_changed_sig.dispatch()):t.name==="allow_calls"?(TS.prefs.setTeamPrefLocal("allow_calls",t.value),TS.prefs.team_allow_calls_changed_sig.dispatch()):t.name==="calling_app_id"?(TS.prefs.setTeamPrefLocal("calling_app_id",t.value),TS.prefs.team_calling_app_id_changed_sig.dispatch()):t.name==="calling_app_name"?(TS.prefs.setTeamPrefLocal("calling_app_name",t.value),TS.prefs.team_calling_app_name_changed_sig.dispatch()):t.name==="disable_file_editing"?(TS.prefs.setTeamPrefLocal("disable_file_editing",t.value),TS.prefs.team_disable_file_editing_changed_sig.dispatch()):t.name==="disable_file_deleting"?(TS.prefs.setTeamPrefLocal("disable_file_deleting",t.value),TS.prefs.team_disable_file_deleting_changed_sig.dispatch()):t.name==="uses_customized_custom_status_presets"?(TS.prefs.setTeamPrefLocal(t.name,t.value),TS.prefs.team_uses_customized_custom_status_presets_changed_sig.dispatch()):t.name==="loud_channel_mentions_limit"?(TS.prefs.setTeamPrefLocal(t.name,t.value),TS.prefs.team_loud_channel_mentions_limit_changed_sig.dispatch()):t.name==="enable_shared_channels"?(TS.prefs.setTeamPrefLocal(t.name,t.value),TS.prefs.enable_shared_channels_changed_sig.dispatch()):t.name==="dropbox_legacy_picker"?(TS.prefs.setTeamPrefLocal(t.name,t.value),TS.prefs.dropbox_enabled_changed_sig.dispatch()):TS.prefs.setTeamPrefLocal(t.name,t.value)},getPref:function(t){return TS.redux.prefs.getUserPref(t)},setPrefLocal:function(t,f){TS.redux.prefs.setUserPref(t,f)},getTeamPref:function(t){return TS.redux.prefs.getTeamPref(t)},setTeamPrefLocal:function(t,f){TS.redux.prefs.setTeamPref(t,f)},legacyOnPrefChanged:function(t){switch(t.name){case"all_notifications_prefs":TS.prefs.setPrefLocal("all_notifications_prefs",t.value),TS.prefs.all_notifications_prefs_changed_sig.dispatch(t.value);break;case"locale":TS.prefs.setPrefLocal("locale",t.value),TS.prefs.locale_changed_sig.dispatch(t.value);break;case"flannel_server_pool":TS.prefs.setPrefLocal("flannel_server_pool",t.value);break;case"color_names_in_list":TS.prefs.setPrefLocal("color_names_in_list",!!t.value),TS.prefs.color_names_in_list_changed_sig.dispatch();break;case"display_real_names_override":TS.prefs.setPrefLocal("display_real_names_override",t.value),TS.prefs.display_real_names_override_changed_sig.dispatch();break;case"growls_enabled":TS.prefs.setPrefLocal("growls_enabled",!!t.value),TS.prefs.dtop_notif_changed_sig.dispatch();break;case"sidebar_theme":TS.prefs.getPref("sidebar_theme")!==t.value&&(TS.prefs.setPrefLocal("sidebar_theme",t.value),TS.prefs.sidebar_theme_changed_sig.dispatch());break;case"sidebar_theme_custom_values":TS.prefs.getPref("sidebar_theme_custom_values")!==t.value&&(TS.prefs.setSidebarThemeCustomValues(JSON.parse(t.value)),TS.prefs.sidebar_theme_changed_sig.dispatch());break;case"expand_inline_imgs":TS.prefs.setPrefLocal("expand_inline_imgs",!!t.value),TS.prefs.expand_inline_imgs_changed_sig.dispatch();break;case"webapp_spellcheck":TS.prefs.setPrefLocal("webapp_spellcheck",!!t.value),TS.prefs.webapp_spellcheck_changed_sig.dispatch();break;case"expand_internal_inline_imgs":TS.prefs.setPrefLocal("expand_internal_inline_imgs",!!t.value),TS.prefs.expand_internal_inline_imgs_changed_sig.dispatch();break;case"expand_non_media_attachments":TS.prefs.setPrefLocal("expand_non_media_attachments",!!t.value),TS.prefs.expand_non_media_attachments_changed_sig.dispatch();break;case"messages_theme":TS.prefs.setPrefLocal("messages_theme",t.value),TS.prefs.setTheme(),TS.prefs.messages_theme_changed_sig.dispatch();break;case"highlight_words":TS.prefs.setHighlightWords(t.value),TS.prefs.highlight_words_changed_sig.dispatch();break;case"at_channel_suppressed_channels":TS.prefs.setSuppressedChannels(t.value),TS.prefs.dtop_notif_changed_sig.dispatch();break;case"push_at_channel_suppressed_channels":TS.prefs.setPushSuppressedChannels(t.value),TS.prefs.push_changed_sig.dispatch();break;case"loud_channels":TS.prefs.setLoudChannels(t.value);break;case"never_channels":TS.prefs.setNeverChannels(t.value);break;case"muted_channels":TS.boot_data.feature_tinyspeck&&TS.interop.console.info("PREFS",`muted_channels updated: ${t.value}`),TS.prefs.setMutedChannels(t.value),TS.prefs.muted_channels_changed_sig.dispatch();break;case"loud_channels_set":TS.prefs.setLoudChannelsSet(t.value),TS.prefs.dtop_notif_changed_sig.dispatch();break;case"push_loud_channels":TS.prefs.setPushLoudChannels(t.value);break;case"push_mention_channels":TS.prefs.setPushMentionChannels(t.value);break;case"push_loud_channels_set":TS.prefs.setPushLoudChannelsSet(t.value),TS.prefs.push_changed_sig.dispatch();break;case"emoji_use":break;case"user_colors":_.each(_.keys(TS.model.user_colors),function(f){var i=TS.interop.members.getMemberById(f);i&&TS.members.setMemberUserColor(i,i.color)}),TS.prefs.setUserColors(t.value),_.forOwn(TS.model.user_colors,function(f,i){var l=TS.interop.members.getMemberById(i);l&&TS.members.setMemberUserColor(l,f)});break;case"graphic_emoticons":TS.prefs.setPrefLocal("graphic_emoticons",t.value),TS.prefs.emoji_mode_changed_sig.dispatch();break;case"ss_emojis":TS.prefs.setPrefLocal("ss_emojis",t.value),TS.prefs.emoji_mode_changed_sig.dispatch();break;case"obey_inline_img_limit":TS.prefs.setPrefLocal("obey_inline_img_limit",t.value),TS.prefs.obey_inline_img_limit_changed_sig.dispatch();break;case"search_only_my_channels":case"search_only_current_team":case"search_exclude_bots":break;case"search_exclude_channels":TS.prefs.setSearchExcludeChannels(t.value),TS.prefs.search_exclude_channels_changed_sig.dispatch();break;case"has_uploaded":TS.prefs.setPrefLocal("has_uploaded",!!t.value);break;case"has_invited":TS.prefs.setPrefLocal("has_invited",!!t.value);break;case"has_created_channel":TS.prefs.setPrefLocal("has_created_channel",!!t.value);break;case"no_joined_overlays":TS.prefs.setPrefLocal("no_joined_overlays",!!t.value);break;case"no_created_overlays":TS.prefs.setPrefLocal("no_created_overlays",!!t.value);break;case"seen_welcome_2":TS.prefs.setPrefLocal("seen_welcome_2",!!t.value),TS.prefs.seen_welcome_2_changed_sig.dispatch();break;case"box_enabled":TS.prefs.setPrefLocal("box_enabled",!!t.value),TS.prefs.box_enabled_changed_sig.dispatch();break;case"dropbox_enabled":TS.prefs.setPrefLocal("dropbox_enabled",!!t.value),TS.prefs.dropbox_enabled_changed_sig.dispatch();break;case"mark_msgs_read_immediately":TS.prefs.getPref("mark_msgs_read_immediately")!==!!t.value&&(TS.prefs.setPrefLocal("mark_msgs_read_immediately",!!t.value),TS.prefs.read_changed_sig.dispatch());break;case"start_scroll_at_oldest":TS.prefs.getPref("start_scroll_at_oldest")!==!!t.value&&(TS.prefs.setPrefLocal("start_scroll_at_oldest",!!t.value),TS.prefs.read_changed_sig.dispatch());break;case"mac_ssb_bullet":TS.prefs.getPref("mac_ssb_bullet")!==!!t.value&&(TS.prefs.setPrefLocal("mac_ssb_bullet",!!t.value),TS.prefs.mac_ssb_bullet_changed_sig.dispatch());break;case"all_channels_loud":TS.prefs.getPref("all_channels_loud")!==!!t.value&&(TS.prefs.setPrefLocal("all_channels_loud",!!t.value),TS.prefs.dtop_notif_changed_sig.dispatch());break;case"push_everything":TS.prefs.getPref("push_everything")!==!!t.value&&(TS.prefs.setPrefLocal("push_everything",!!t.value),TS.prefs.push_changed_sig.dispatch());break;case"push_mention_alert":TS.prefs.getPref("push_mention_alert")!==!!t.value&&(TS.prefs.setPrefLocal("push_mention_alert",!!t.value),TS.prefs.push_changed_sig.dispatch());break;case"push_dm_alert":TS.prefs.getPref("push_dm_alert")!==!!t.value&&(TS.prefs.setPrefLocal("push_dm_alert",!!t.value),TS.prefs.push_changed_sig.dispatch());break;case"time24":TS.prefs.getPref("time24")!==!!t.value&&(TS.prefs.setPrefLocal("time24",!!t.value),TS.prefs.time24_changed_sig.dispatch());break;case"sidebar_behavior":TS.prefs.getPref("sidebar_behavior")!=t.value&&(TS.prefs.setPrefLocal("sidebar_behavior",t.value),TS.prefs.sidebar_behavior_changed_sig.dispatch());break;case"two_factor_update_seen":TS.model.two_factor_update_seen!=t.value&&(TS.mode.prefs.two_factor_update_seen=t.value,TS.prefs.two_factor_update_seen_changed_sig.dispatch());break;case"privacy_policy_seen":TS.prefs.getPref("privacy_policy_seen")!=t.value&&(TS.prefs.setPrefLocal("privacy_policy_seen",t.value),TS.prefs.privacy_policy_seen_changed_sig.dispatch());break;case"last_seen_at_channel_warning":TS.prefs.getPref("last_seen_at_channel_warning")!=t.value&&TS.prefs.setPrefLocal("last_seen_at_channel_warning",t.value);break;case"mentions_exclude_at_channels":TS.prefs.getPref("mentions_exclude_at_channels")!=t.value&&(TS.prefs.setPrefLocal("mentions_exclude_at_channels",t.value),TS.prefs.mentions_exclude_at_channels_changed_sig.dispatch());break;case"mentions_exclude_at_user_groups":TS.prefs.getPref("mentions_exclude_at_user_groups")!=t.value&&(TS.prefs.setPrefLocal("mentions_exclude_at_user_groups",t.value),TS.prefs.mentions_exclude_at_user_groups_changed_sig.dispatch());break;case"no_invites_widget_in_sidebar":TS.prefs.getPref("no_invites_widget_in_sidebar")!=t.value&&(TS.prefs.setPrefLocal("no_invites_widget_in_sidebar",t.value),TS.prefs.no_invites_widget_in_sidebar_changed_sig.dispatch());break;case"k_key_omnibox_auto_hide_count":TS.prefs.getPref("k_key_omnibox_auto_hide_count")!=t.value&&(TS.prefs.setPrefLocal("k_key_omnibox_auto_hide_count",t.value),TS.prefs.k_key_omnibox_auto_hide_count_changed_sig.dispatch());break;case"show_sidebar_quickswitcher_button":TS.prefs.getPref("show_sidebar_quickswitcher_button")!=t.value&&TS.prefs.setPrefLocal("show_sidebar_quickswitcher_button",t.value);break;case"preferred_skin_tone":TS.prefs.getPref("preferred_skin_tone")!=t.value&&(TS.prefs.setPrefLocal("preferred_skin_tone",t.value),TS.prefs.preferred_skin_tone_changed_sig.dispatch());break;case"separate_private_channels":TS.prefs.getPref("separate_private_channels")!=t.value&&(TS.prefs.setPrefLocal("separate_private_channels",t.value),TS.prefs.separate_private_channels_changed_sig.dispatch());break;case"separate_shared_channels":TS.prefs.getPref("separate_shared_channels")!=t.value&&(TS.prefs.setPrefLocal("separate_shared_channels",t.value),TS.prefs.separate_shared_channels_changed_sig.dispatch());break;case"whats_new_read":TS.prefs.getPref("whats_new_read")!=t.value&&(TS.prefs.setPrefLocal("whats_new_read",t.value),TS.prefs.whats_new_read_changed_sig.dispatch());break;case"tz":TS.prefs.getPref("tz")!=t.value&&(TS.prefs.setPrefLocal("tz",t.value),TS.prefs.tz_changed_sig.dispatch());break;case"keyboard":TS.prefs.getPref("keyboard")!=t.value&&(TS.prefs.setPrefLocal("keyboard",t.value),TS.prefs.keyboard_changed_sig.dispatch());break;case"msg_input_send_btn":TS.prefs.getPref("msg_input_send_btn")!=t.value&&(TS.prefs.setPrefLocal("msg_input_send_btn",t.value),TS.prefs.msg_input_send_btn_changed_sig.dispatch());break;case"msg_input_send_btn_auto_set":TS.prefs.getPref("msg_input_send_btn_auto_set")!=t.value&&(TS.prefs.setPrefLocal("msg_input_send_btn_auto_set",t.value),TS.prefs.msg_input_send_btn_auto_set_changed_sig.dispatch());break;case"frecency_jumper":if(TS.ui.frecency.isEnterprise())break;TS.prefs.conditionallyClogFrecencyDueToSizeChange("PREF_USER_TEAM_FRECENCY_SHRINKAGE",JSON.stringify(TS.model.frecency_jumper),t.value),TS.prefs.mergeFrecencyJumper(t.value)&&TS.prefs.frecency_jumper_changed_sig.dispatch();break;case"frecency_ent_jumper":TS.prefs.conditionallyClogFrecencyDueToSizeChange("PREF_USER_ORG_FRECENCY_SHRINKAGE",JSON.stringify(TS.model.frecency_jumper),t.value),TS.log(666,"Received a pref_change event for frecency_ent_jumper."),TS.prefs.mergeFrecencyJumper(t.value)&&TS.prefs.frecency_jumper_changed_sig.dispatch();break;case"jumbomoji":TS.prefs.getPref("jumbomoji")!=t.value&&(TS.prefs.setPrefLocal("jumbomoji",t.value),TS.prefs.jumbomoji_changed_sig.dispatch());break;case"hide_hex_swatch":TS.prefs.getPref("hide_hex_swatch")!=t.value&&(TS.prefs.setPrefLocal("hide_hex_swatch",t.value),TS.prefs.hide_hex_swatch_changed_sig.dispatch());break;case"a11y_animations":TS.prefs.getPref("a11y_animations")!==t.value&&TS.prefs.setPrefLocal("a11y_animations",t.value);break;case"show_memory_instrument":TS.prefs.getPref("show_memory_instrument")!==t.value&&(TS.prefs.setPrefLocal("show_memory_instrument",t.value),TS.prefs.show_memory_instrument_changed_sig.dispatch());break;case"channel_sort":TS.prefs.getPref("channel_sort")!==t.value&&(TS.prefs.setPrefLocal("channel_sort",t.value),TS.prefs.setChannelSort(TS.prefs.getPref("channel_sort")),TS.prefs.channel_sort_changed_sig.dispatch());break;case"enable_unread_view":TS.prefs.getPref("enable_unread_view")!==t.value&&(TS.prefs.setPrefLocal("enable_unread_view",t.value),TS.prefs.enable_unread_view_changed_sig.dispatch());break;case"enable_react_emoji_picker":TS.prefs.getPref("enable_react_emoji_picker")!==t.value&&(TS.prefs.setPrefLocal("enable_react_emoji_picker",t.value),TS.prefs.enable_react_emoji_picker_changed_sig.dispatch());break;case"client_logs_pri":TS.prefs.setPrefLocal(t.name,t.value),TS.console.setAppropriatePri();break;case"email_alerts":TS.prefs.setPrefLocal(t.name,t.value),TS.prefs.email_alerts_changed_sig.dispatch();break;default:TS.prefs.setPrefLocal(t.name,t.value)}},hex_regex:/^#?([0-9a-f]{6})$/i,conditionallyClogFrecencyDueToSizeChange:function(t,f,i){i.length/f.length<.1&&TS.interop.clog.track(t,{updated_user_client_prefs:{existing_frecency:f,new_frecency:i}})},setSidebarThemeCustomValues:function(t){var f=!1;t&&typeof t=="object"&&t.length===void 0&&_.forOwn(t,function(i,l){if(f=!1,!i||!i.substr||(t[l]=i.substr(0,7),!i.match(TS.prefs.hex_regex)))return!1;f=!0}),f?TS.prefs.setPrefLocal("sidebar_theme_custom_values",JSON.stringify(t)):(TS.prefs.setPrefLocal("sidebar_theme","default"),TS.prefs.setPrefLocal("sidebar_theme_custom_values",JSON.stringify(TS.sidebar_themes.default_themes.default_theme)))},setMultiPrefsByAPI:function(t,f){var i="";if(_.forOwn(t,function(e,n){i+=`&${encodeURIComponent(n)}=${encodeURIComponent(e)}`}),!i){TS.error(" no prefs to set?");return}var l={prefs:i};return TS.prefs.setPrefByAPI(l,f)},setPrefByAPI:function(t,f){return TS.interop.api.callExpedited("users.prefs.set",t).then(function(i){const{data:e,args:n}=i;if(e&&e.prefs&&n){const o=n.name&&[n.name]||_.keys(TS.interop.url.queryStringParse(n.prefs));_.forEach(o,c=>TS.prefs.legacyOnPrefChanged({name:c,value:e.prefs[c]}))}if(f)return f(!0,e,n)}).catch(function(i){const{args:l}=i;var e;l.hasOwnProperty("name")?e=`pref name: ${l.name}`:l.prefs&&(e="(multiple prefs)"),TS.interop.utility.getLogger({getState:TS.redux.getState}).error(e,"TS.prefs.setPrefByAPI call got a not ok rsp",{subtype:"API response error"}),setTimeout(function(){l.prefs?TS.error("multi preferences setting failed."):TS.error(`"${l.name}" preference setting failed.`)},0)})},setTeamPrefByAPI:function(t,f,i){return TS.interop.api.callExpedited("team.prefs.set",{prefs:JSON.stringify(t)}).then(function(l){const{data:e}=l;if(TS.web){i=i||[];var n=Object.keys(t).concat(i);n.forEach(function(o){e.prefs.hasOwnProperty(o)&&(t.hasOwnProperty(o)||TS.prefs.getTeamPref(o)!==e.prefs[o])&&TS.prefs.legacyOnTeamPrefChanged({name:o,value:e.prefs[o]})})}return Promise.resolve(e.prefs)}).catch(function(l){const{data:e}=l;return f&&f(e),Promise.reject(e)})},removeTeamFromEnterpriseExcludeTeamPref:function(t){if(!TS.boot_data.page_needs_enterprise)return;const f=TS.prefs.getPref("enterprise_excluded_app_teams");if(!f)return;const i=f?f.split(","):[];_.pull(i,t),TS.prefs.setPrefByAPI({name:"enterprise_excluded_app_teams",value:i.join(",")})}});var a=!1})()},"9mk2":function(se,ae){(function(){TS.registerModule("help",{max_title_chars:100})})()},Chwb:function(se,ae){(function(){TS.registerModule("menu.member",{member:null,onStart:function(){},startWithEnterpriseMemberHeader:function(t){var f=15;if(!TS.menu.isRedundantClick(t)&&!TS.model.menu_is_showing){TS.menu.buildIfNeeded(),TS.menu.clean();var i={enterprise_name:$("[data-enterprise-name]").val(),signout_url:TS.boot_data.signout_url};TS.menu.$menu_header.addClass("hidden").empty(),TS.menu.$menu_items.html(TS.templates.menu_enterprise_member_header(i)),TS.menu.$menu_items.on("click.menu","li",a),TS.kb_nav.setSubmitItemHandler(a),TS.menu.start(t,null,{menu_class:"member_menu"});var l=$("[data-header-menu-toggle]"),e=-TS.menu.$menu.outerWidth()+l.outerWidth(),n=l.outerHeight()+f;TS.menu.positionAt(l,e,n),t.preventDefault()}},end:function(){TS.menu.member.member=null,TS.menu.end(),TS.menu.clean()}});var a=d(function(t){var f=$(this).attr("id");f!=="sign_out"&&f!=="view_account"&&(t.preventDefault(),TS.warn(`not sure what to do with clicked element id:${f}`))},"_onEnterpriseMemberHeaderClick")})()},Cs7e:function(se,ae){(function(){TS.registerModule("menu",{$menu:null,$submenu:null,$submenu_origin:null,$submenu_parent:null,$menu_header:null,$menu_items:null,$menu_list_container:null,$menu_list:null,$menu_footer:null,menu_lazy_load:null,user_group:null,$target_element:null,$secondary_target_element:null,large_dom_trigger:500,menu_items_hidden:!0,has_submenu:!1,menu_closed_sig:new signals.Signal,onStart:function(){},buildIfNeeded:_.once(function(){TS.menu.$menu=$(TS.templates.menu());var i=TS.menu.$menu;if(TS.boot_data.app!=="mobile"&&TS.qs_args.new_scroll!="0"){if(i.appendTo($("body")),!TS.environment.supports_custom_scrollbar){var l=TS.qs_args.debug_scroll=="1";i.find("#menu_items_scroller").monkeyScroll({debug:l})}i.detach()}TS.menu.$menu_header=i.find("#menu_header"),TS.menu.$menu_body=i.find(".menu_body"),TS.menu.$menu_list_container=i.find("#menu_list_container"),TS.menu.$menu_list=i.find("#menu_list"),TS.menu.$menu_items=i.find("#menu_items"),TS.menu.$menu_footer=i.find("#menu_footer")}),startWithList:function(i,l,e){if(!(!l||!l.length)&&!TS.menu.isRedundantClick(i))if(e=e||{},TS.menu.buildIfNeeded(),TS.menu.clean(),TS.menu.$menu_header.addClass("hidden").empty(),TS.menu.$menu_items.html(l.html()),TS.menu.$menu.addClass(e.menu_class),(e.close_on_click||e.onClick)&&TS.menu.$menu_items.on("click.menu","li",function(o){typeof e.onClick=="function"&&e.onClick(o),e.close_on_click&&TS.menu.end()}),TS.menu.start(i,void 0,e),e.attach_to_target_at_full_width)TS.menu.$menu.css({width:"100%",top:"calc(100% + 3px)",left:"0"});else{var n=f(e.align_right);TS.menu.positionAt(TS.menu.$target_element,n.left,n.top)}},did_start_slack_menu_signal_listeners:!1,stopListeningForRebuildWorthiness:function(){TS.menu.did_start_slack_menu_signal_listeners=!1},startWithEditTeamProfileListActions:function(i,l,e){if(!TS.menu.isRedundantClick(i)&&!TS.model.menu_is_showing){TS.menu.buildIfNeeded();var n=$(i.target),o=TS.team.getTeamProfileFieldById(n.data("id")),c={id:o.id,hidden:!!(o&&o.is_hidden),is_scim:e.is_scim};TS.menu.clean(),TS.menu.$menu_header.addClass("hidden").empty(),TS.menu.$menu_items.html(TS.templates.admin_menu_edit_team_profile_list_action_items(c)),TS.menu.$menu_items.on("click.menu","li",l),TS.menu.start(i),TS.menu.positionAt(n.find('[data-action="edit_team_profile_list_menu"]'),-(TS.menu.$menu.width()+6),0),TS.menu.keepInBounds()}},positionAt:function(i,l,e){l=l||0,e=e||0;var n=i.offset(),o=n.left+l,c=n.top+e;TS.menu.$menu.css({top:c,left:o})},isRedundantClick:function(i){return!!(i&&TS.menu.last_e&&(i.target==TS.menu.last_e.target||i.currentTarget==TS.menu.last_e.currentTarget))},isLarge:function(){return TS.menu&&TS.menu.$menu&&TS.menu.$menu.find("li").length>TS.menu.large_dom_trigger},start:function(i,l,e){if(e=e||{},TS.menu.last_e=i,!t){var n=$(i.target).offset(),o=n.left+$(i.target).width()+10,c=n.top;l&&(o=i.pageX+10,c=i.pageY+10)}_.isFunction(e.needs_to_remain_open)&&(TS.menu.needs_to_remain_open=e.needs_to_remain_open),$(".tooltip").hide(),TS.tips.hideAll(),$(i.currentTarget).addClass("active"),TS.menu.$target_element=$(i.currentTarget),TS.model.menu_is_showing=!0;var v=TS.menu.$menu;e.onClose&&v.one("closed",e.onClose),e.menu_class&&v.addClass(e.menu_class);var h=TS.menu.isLarge();t||v.css({top:c,left:o});var u=v.find("#menu_items_scroller");u.scrollTop(0),e.attach_to_target_at_full_width?TS.menu.$target_element.after(v):v.appendTo($("body")),e.keep_menu_open_if_target_clicked_again&&TS.menu.$menu.addClass("keep_menu_open_if_target_clicked_again"),!h&&!t?(v.css("opacity",0),v.stop().transition({opacity:1},200)):v.css("opacity",1),v.find(".menu_close").on("click",TS.menu.end),e.ignore_bounds||TS.menu.keepInBounds(),TS.ui.utility.updateClosestMonkeyScroller(u,!0),TS.menu.menu_lazy_load&&TS.menu.menu_lazy_load.detachEvents&&TS.menu.menu_lazy_load.detachEvents(),TS.menu.menu_lazy_load=TS.menu.$menu_items.find(".lazy").lazyload({container:$("#menu_items_scroller"),all_images_same_size:!0,throttle:250}),e.ignore_bounds||$(window).bind("resize",TS.menu.keepInBounds),$(window.document).bind("keydown",TS.menu.onKeyDown),$("html").bind("mousedown touchstart",TS.menu.onMouseDown);var m=v.find(".menu_list"),S=m.length?m:v.find("#menu_items");TS.menu.has_submenu?TS.kb_nav.start(S,"li:not(.divider)",v,{onLeftKeyDownIfSubmenuExists:TS.menu.onLeftKeyDownIfSubmenuExists,onRightKeyDownIfSubmenuExists:TS.menu.onRightKeyDownIfSubmenuExists}):TS.kb_nav.start(S,"li:not(.divider)");var b=m.length?m.first().find("a, button").first():null;TS.ui&&TS.ui.a11y&&TS.ui.a11y.focusAndAddTabindex(b),t=!1,a=e.on_esc},clean:function(){TS.menu.$menu_footer.empty(),TS.menu.$menu_header.removeClass("hidden"),TS.menu.$menu.removeClass("no_min_width no_max_width profile_preview flex_menu search_filter_menu popover_menu no_icons team_menu member_menu file_menu all_unreads_sort_order_menu searchable_member_list_filter_menu selectable member_file_filter_menu app_card keep_menu_open_if_target_clicked_again member_file_filter_menu").css("max-height",""),TS.menu.$menu.removeAttr("data-qa"),TS.menu.$menu.find("#menu_items_scroller").css("max-height",""),TS.menu.$menu.find(".arrow, .arrow_shadow").remove(),TS.menu.$menu_items.off("mouseenter.section_header"),TS.menu.$menu.removeClass("narrow_menu"),TS.menu.$menu_body.off("mouseenter.section_header"),TS.menu.needs_to_remain_open=void 0,TS.menu.$menu.removeClass("date_picker"),TS.boot_data.page_needs_enterprise&&(TS.menu.$menu_list_container.html('<div id="menu_list" role="menu"></div>').removeClass("populated"),TS.menu.$menu_list=TS.menu.$menu.find("#menu_list"),TS.menu.$menu.off("keydown","#file_member_filter .member_filter")),TS.menu.$menu.removeAttr("data-model-ob-id"),TS.menu.$menu.removeAttr("data-thread-ts"),TS.menu.$menu.find(".member_item")&&(TS.menu.$menu.find(".member_item").remove(),TS.menu.$menu.find(".list_items").css("height",0)),a=null},end:function(){if(!(_.isFunction(TS.menu.needs_to_remain_open)&&TS.menu.needs_to_remain_open())){TS.menu.$submenu&&TS.menu.$submenu_parent&&TS.menu.$submenu_parent.submenu("destroy"),TS.menu.$menu.width(""),TS.model.menu_is_showing=!1,TS.menu.menu_items_hidden=!0,TS.menu.has_submenu=!1,TS.menu.$submenu_parent=null,TS.menu.submenu_template_args={},TS.menu.did_start_slack_menu_signal_listeners&&TS.menu.stopListeningForRebuildWorthiness();var i=TS.menu.$menu,l=d(function(){TS.model.menu_is_showing||(setTimeout(function(){TS.model.menu_is_showing||(TS.menu.last_e=null)},50),i.detach(),TS.menu.$menu_header.empty(),TS.menu.$menu_footer.empty(),TS.menu.$menu_items.empty(),TS.menu.$menu_items.removeClass("hidden"),TS.menu.$menu_body.empty(),TS.menu.clean())},"menu_end");!TS.menu.isLarge()&&!t?i.stop().transition({opacity:0},200,l):l(),i.trigger("closed"),TS.menu.$target_element&&(TS.menu.$target_element.removeClass("active"),TS.menu.$target_element=null),TS.menu.$secondary_target_element&&(TS.menu.$secondary_target_element.removeClass("active"),TS.menu.$secondary_target_element=null),TS.menu.user_group=null,TS.menu.$menu_header.unbind("click.menu"),TS.menu.$menu_items.off("click.menu"),TS.menu.$menu_body.off("click.menu"),$(window).unbind("resize",TS.menu.keepInBounds),$(window.document).unbind("keydown",TS.menu.onKeyDown),$("html").unbind("mousedown touchstart",TS.menu.onMouseDown),TS.members.view.team_filter_changed_sig.remove(TS.kb_nav.clearHighlightedItem),$(".file_list_item.active").removeClass("active"),TS.tips.unhideAll(),TS.menu.search_filter_is_showing=!1,$("#search_filter_menu_label").removeClass("active"),$("#mentions_filter_menu_label").removeClass("active"),$("#flex_menu_toggle").removeClass("menu_open"),$("#channel_actions_toggle").removeClass("active"),$("#menu_member_dm_input").length&&TS.utility.contenteditable.unload($("#menu_member_dm_input")),i.removeClass("narrow_menu"),TS.menu.menu_lazy_load&&TS.menu.menu_lazy_load.detachEvents&&(TS.menu.menu_lazy_load.detachEvents(),TS.menu.menu_lazy_load=null),TS.kb_nav.end(),TS.menu.menu_closed_sig.dispatch()}},onKeyDown:function(i){var l=TS.utility.keymap,e=i.which,n=i.metaKey||i.ctrlKey||i.altKey;if(e==l.esc){if(TS.utility.contenteditable.hasFocus($("#menu_member_dm_input")))return;i.stopPropagation(),i.preventDefault(),TS.menu.end(),a&&a()}else!n&&!TS.utility.isArrowKey(e)&&e!=l.tab&&e!=l.enter&&e!=l.shift&&(TS.kb_nav.clearHighlightedItem(),TS.utility.contenteditable.focus($("#menu_member_dm_input")))},onLeftKeyDownIfSubmenuExists:function(){var i=!1;if(TS.menu.$submenu&&TS.menu.$submenu.hasClass("kb_active")){TS.menu.$submenu.removeClass("kb_active"),TS.kb_nav.end(),TS.kb_nav.highlightItemWithKey(TS.menu.$submenu_origin);var l=TS.menu.$menu.find(".menu_list"),e=l.length?l:TS.menu.$menu.find("#menu_items");TS.kb_nav.start(e,"li:not(.divider)",TS.menu.$menu,{onLeftKeyDownIfSubmenuExists:TS.menu.onLeftKeyDownIfSubmenuExists,onRightKeyDownIfSubmenuExists:TS.menu.onRightKeyDownIfSubmenuExists}),["member_current_status_item","switch_teams"].indexOf(TS.menu.$submenu_origin.attr("id"))===-1&&TS.menu.$submenu_origin.submenu("destroy"),i=!0}return i},onRightKeyDownIfSubmenuExists:function(){var i=!1;return TS.menu.$submenu&&(TS.menu.$submenu.hasClass("kb_active")?(TS.menu.$submenu.removeClass("kb_active"),TS.menu.end()):(TS.menu.$submenu.addClass("kb_active"),TS.kb_nav.end(),TS.kb_nav.highlightItemWithKey(TS.menu.$submenu.find("li:not(.divider)").first()),TS.kb_nav.start(TS.menu.$submenu.find("ul"),"li:not(.divider)",TS.menu.$submenu,{onLeftKeyDownIfSubmenuExists:TS.menu.onLeftKeyDownIfSubmenuExists,onRightKeyDownIfSubmenuExists:TS.menu.onRightKeyDownIfSubmenuExists})),i=!0),i},onMouseDown:function(i){var l=$(i.target);TS.menu.$menu&&TS.menu.$menu.hasClass("keep_menu_open_if_target_clicked_again")&&l.is(TS.menu.$target_element)||(l.closest("#menu, .submenu, .trap_menu_clicks").length===0||l.hasClass("popover_mask"))&&TS.menu.end()},keepInBounds:function(){window.requestAnimationFrame?TS.utility.rAF(TS.menu.keepInBoundsThrottled):TS.menu.keepInBoundsThrottled()},keepInBoundsThrottled:function(){var i=TS.menu.$menu,l=10,e=i.dimensions_rect(),n={top:0+l,right:$(window).width()-l,bottom:$(window).height()-(l+14),left:0+l};TS.utility.doesRectContainRect(n,e)||(e.left<n.left?i.css("left",n.left):e.right>n.right&&i.css("left",Math.max(n.left,n.right-e.width)),e.top<n.top?i.css("top",n.top):e.bottom>n.bottom&&i.css("top",Math.max(n.top,n.bottom-e.height+$(window).scrollTop())))}});var t=!1,f=d(function(i){var l=3,e=TS.menu.$target_element.outerHeight()+l,n=0;return i&&(n=TS.menu.$target_element.outerWidth()-TS.menu.$menu.outerWidth()),{left:n,top:e}},"_getOffsets");$.widget("TS.submenu",{_create:function(){this.element.data("has-submenu",!0);var i=TS.interop.i18n.t("submenu","menu_source")(),l=`<div class="menu submenu${this.options.help?" submenu_help":""}" data-origin-id="${this.element.attr("id")}" data-model-ob-id="${this.element.data("modelObId")}"><ul aria-hidden="true" aria-label="${i}">${this.options.items_html}</ul></div>`,e=-13,n=11,o=TS.menu.$menu.offset().left+TS.menu.$menu.width()+e,c=this.element.offset().top-n;if(this.$submenu=$(l),this.$submenu.appendTo("body"),TS.menu.$submenu=this.$submenu,TS.menu.$submenu_origin=this.element,o+this.$submenu.width()>window.innerWidth){var v=TS.menu.$menu.offset().left-e,h=window.innerWidth-o;v>h&&(o=TS.menu.$menu.offset().left-this.$submenu.width()-e)}if(c+this.$submenu.height()>window.innerHeight){var u=c,m=Math.abs(window.innerHeight-(c+this.$submenu.height()));u>m?c=window.innerHeight-this.$submenu.height()-n:c=n}this.$submenu.css({position:"absolute",left:`${o}px`,top:`${c}px`});var S=this.options.onclick;S&&this.$submenu.on("click",function(b){S.call(this,b)})},_destroy:function(){TS.menu.$submenu=null,TS.menu.$submenu_origin=null,this.options.ondestroy&&this.options.ondestroy(),this.$submenu.remove()}})})();var a},EXLS:function(se,ae){(function(){TS.registerModule("redux.user_groups",{onStart:function(){Object.defineProperty(TS.model,"user_groups",{get:function(){return TS.redux.user_groups.getAllUserGroups()},set:function(){return TS.error("TS.redux.user_groups: trying to set TS.model.user_groups???"),!1}})},getAllUserGroups:function(){var f=TS.interop.userGroups.getAllUserGroups();return f===a||(t=_.values(f).sort(TS.interop.i18n.mappedSorter("_name_lc")),a=f),t}});var a,t})()},EcSN:function(se,ae){(function(){TS.registerModule("ui.fs_modal",{is_showing:!1,transition_duration:250,start:function(q){if(TS.ui.fs_modal.is_showing)return s(q);m=_.defaults({},q,S),TS.ui.fs_modal.is_showing=!0,TS.tips.hideAll(),b(),m.modal_class&&a.addClass(m.modal_class),m.modal_bg_class&&t.addClass(m.modal_bg_class),m.modal_contents_container_class&&a.find(".contents_container").addClass(m.modal_contents_container_class),i=a.find(".contents"),l=a.find("#fs_modal_sidebar"),e=a.find("#fs_modal_header"),o=a.find("#fs_modal_footer_content");var ne;if(m.body_template_html?(ne=m.body_template_html,m.body&&TS.warn("Both body and body_template_html were passed in settings to TS.ui.fs_modal.start(). Using body_template.")):ne=TS.templates.fs_modal_generic_contents({settings:m,fs_modal_header:_.includes(m.modal_class,"fs_modal_header"),fs_modal_footer:_.includes(m.modal_class,"fs_modal_footer")}),i.html(ne),m.header_html&&e.replaceWith(m.header_html),m.footer_html&&o.html(m.footer_html),m.sidebar_html&&l.html(m.sidebar_html),q.title&&a.attr("aria-label",q.title),!q.title&&e&&a.attr("aria-labelledby","fs_modal_header"),$("#client-ui").attr("aria-hidden",!0),a.on("click",".dialog_go",w),a.on("click",".dialog_secondary_go",x),a.on("click",".dialog_cancel",F),$(window.document).off(".fs_modal"),$(window.document).on("keydown.fs_modal",U),$(window.document).on("focusin.fs_modal",ee),f.on("click",function(){m.esc_for_ok?w():F()}),$("html").addClass("fs_modal_active"),setTimeout(function(){t&&t.addClass("active"),a&&a.addClass("active")},0),a.find("input").length?a.find("input").first().focus():document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur(),m.onShow&&m.onShow(),m.onShowComplete||TS.model.is_our_app&&TS.interop.desktop.legacyAreDragRegionsRequired()){var oe=!1,D=g();h=setTimeout(function(){oe=!0,A(),m.onShowComplete&&m.onShowComplete(),a.off(`${D}.fs_modal_show_complete`)},600),a.one(`${D}.fs_modal_show_complete`,function(){oe||(A(),clearTimeout(h),m.onShowComplete&&m.onShowComplete())})}},close:function(q){F(q)},bindBackButton:function(q){$("#fs_modal_back_btn").off("click.fs_modal").on("click.fs_modal",q)},unbindBackButton:function(){$("#fs_modal_back_btn").off("click.fs_modal")},showBackButton:function(){$("#fs_modal_back_btn").removeClass("hidden")},hideBackButton:function(){$("#fs_modal_back_btn").addClass("hidden")},activate:function(){a.addClass("active"),t.addClass("active")},deactivate:function(){a.removeClass("active"),t.removeClass("active")},hideFooter:function(){n.length&&(a.removeClass("fs_modal_footer"),n.addClass("hidden"))},isShowing:function(){return TS.ui.fs_modal.is_showing}});var a,t,f,i,l,e,n,o,c=!1,v,h,u=".modal,[role=dialog]:not(.modal),[role=alertdialog]:not(.modal)",m=null,S={title:"",body:"",body_template_html:null,show_go_button:!0,show_secondary_go_button:!1,show_cancel_button:!0,go_button_text:TS.interop.i18n.t("OK","fs_modal")(),go_button_class:"",secondary_go_button_text:TS.interop.i18n.t("OK 2","fs_modal")(),secondary_go_button_class:"",cancel_button_text:TS.interop.i18n.t("Cancel","fs_modal")(),disable_default_controls:!1,disable_esc:!1,onGo:null,onSecondaryGo:null,onCancel:null,onEnd:null,esc_for_ok:!1,onShow:null,enter_always_gos:!1,fullscreen:!1,modal_class:null,modal_bg_class:null,modal_contents_container_class:null,sidebar_html:null,header_html:null,footer_html:null,full_height_contents:!1},b=d(function(){t=null,a=null,e=null,n=null,o=null,f=null,i=null,l=null;var q={settings:m,fs_modal_header:_.includes(m.modal_class,"fs_modal_header"),fs_modal_footer:_.includes(m.modal_class,"fs_modal_footer"),fs_modal_sidebar:_.includes(m.modal_class,"fs_modal_sidebar"),disable_default_controls:m.disable_default_controls},ne=TS.templates.fs_modal(q);$("body").append(ne),t=$("#fs_modal_bg"),a=$("#fs_modal"),e=$("#fs_modal_header"),n=$("#fs_modal_footer"),f=$("#fs_modal_close_btn")},"_build"),w=d(function(){if(!TS.ui.fs_modal.is_showing){TS.error("not showing?");return}m.onGo?m.onGo()!==!1&&F():F()},"_go"),x=d(function(){if(!TS.ui.fs_modal.is_showing){TS.error("not showing?");return}m.onSecondaryGo?m.onSecondaryGo()!==!1&&F():F()},"_secondaryGo"),U=d(function(q){if(q.which==TS.utility.keymap.enter&&(TS.utility.getActiveElementProp("NODENAME")==="BODY"||m.enter_always_gos))m.show_go_button&&(w(),q.preventDefault());else if(q.which==TS.utility.keymap.esc){if(m.disable_esc)return;m.esc_for_ok?w():(F(),m.clog_name&&TS.interop.clog.track(`${m.clog_name}_ACTION`,{source:m.clog_source,action:"close_modal",trigger:"esc_key"}))}},"_onKeyDown"),ee=d(function(q){var ne=$(u).filter(function(){return $(this).css("display")!=="none"}).toArray(),oe=_.sortBy(ne,function(Y){return parseInt($(Y).css("z-index"),10)}).pop();if(a.is(oe)){var D=q.target;!a.is(D)&&!a.has(D).length&&a.focus()}},"_onFocus"),F=d(function(q){Z(q)&&(a&&a.removeClass("active"),t&&t.removeClass("active"),setTimeout(function(){$("html").removeClass("fs_modal_active")},TS.ui.fs_modal.transition_duration),m.onCancel&&m.onCancel(),T())},"_cancel"),y=d(function(){a.removeAttr("aria-label"),a.removeAttr("aria-labelledby"),a.remove(),t.remove(),TS.ui.fs_modal.is_showing=!1,j()},"_clean"),T=d(function(){setTimeout(function(){y(),$("#client-ui").removeAttr("aria-hidden")},TS.ui.fs_modal.transition_duration),$(window.document).off("keydown.fs_modal"),$(window.document).off("focusin.fs_modal"),clearTimeout(h),a.off(`${g()}.fs_modal_show_complete`),m.onEnd&&m.onEnd(),TS.tips.unhideAll()},"_end"),s=d(function(q){a.removeClass("active"),m.onCancel&&m.onCancel();var ne=t.attr("id",null).addClass("fs_modal_bg");return new Promise(oe=>{setTimeout(function(){a.remove(),TS.ui.fs_modal.is_showing=!1,oe(TS.ui.fs_modal.start(q)),setTimeout(ne.remove.bind(ne),TS.ui.fs_modal.transition_duration)},TS.ui.fs_modal.transition_duration)})},"_swap"),g=d(function(){var q={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",transition:"transitionend"};for(var ne in q)if(a[0].style[ne]!==void 0)return q[ne]},"_getTransitionEndEventName"),A=d(function(){if(!(!TS.model.is_our_app||!TS.interop.desktop.legacyAreDragRegionsRequired())){if(_.get(window,"desktop.app.updateDragRegion")){window.desktop.app.updateDragRegion([]);return}TS.interop.desktop.legacyUpdateNoDragRegion([]);var q=$("#fs_modal").find("header").find("button, a").toArray();c||(TSSSB.nodrag.updateElements(q),c=!0),v=_.debounce(()=>{TS.interop.utility.requestIdleCallback(()=>TSSSB.nodrag.updateElements(q),{timeout:200})},400),$(window).off("resize.setupNoDragFSM").on("resize.setupNoDragFSM",v)}},"_setupNoDragRegions"),j=d(function(){!TS.model.is_our_app||!TS.interop.desktop.legacyAreDragRegionsRequired()||(c=!1,$(window).off("resize.setupNoDragFSM"),TS.interop.desktop.legacyUpdateNoDragRegion([]))},"_tearDownNoDragRegions"),Z=d(function(q){return q?!0:!(TS.ui.lazy_filter_select.is_list_open||TS.model.menu_is_showing||TS.model.dialog_is_showing||TS.utility.isTabCompleteShowing())},"_canClose")})()},"F/UT":function(se,ae){(function(){TS.registerModule("mpims",{switched_sig:new signals.Signal,message_changed_sig:new signals.Signal,onStart:function(){TS.prefs.display_real_names_override_changed_sig.add(t),TS.prefs.team_display_real_names_changed_sig.add(t),TS.members.changed_profile_sig.add(a)},legacyGetMembersInDisplayOrder:function(e){if(e){var n=TS.model&&TS.model.user?TS.model.user.id:TS.boot_data.user_id;return _.chain(e.members).without(n).map(o=>TS.redux.members.getPotentiallyUnknownMemberById(o)).compact().value()}},legacyGetDisplayName:function(e,n,o,c,v){var h=_.isInteger(c);return e._display_name&&!n&&!o&&!h&&!v?e._display_name:e._display_name_truncated&&!n&&!o&&!v&&h?e._display_name_truncated:v?l(e):i(e,n)},getMemberCount:function(e){return e&&e.members?Math.min(Math.max((e.members.length||1)-1,2),9):null},checkMpimMatch:function(e,n,o){if(e){for(var c=!0,v=!0,h=TS.mpims.legacyGetMembersInDisplayOrder(e),u=0;u<n.length;u+=1){for(var m=!1,S=0;S<h.length;S+=1)(TS.utility.members.checkMemberMatch(h[S],n[u],c)||o&&TS.utility.members.checkMemberMatch(h[S],o[u],c))&&(m=!0);m||(v=!1)}return v}}});var a=d(function(e){TS.model.mpims.forEach(function(n){n.members.indexOf(e.id)!==-1&&f(n)})},"_memberRealNameChanged"),t=d(function(){TS.model.mpims.forEach(f)},"_realNamePrefChanged"),f=d(function(e){e._display_name=void 0},"_clearDisplayNameCache"),i=d(function(e){var n=TS.mpims.legacyGetMembersInDisplayOrder(e);if(_.find(n,"is_unknown"))return"";var c=_(n).map(function(h){var u=TS.interop.rules.members.getPrefCompliantMemberName(h);return u}).compact().value(),v=c.join(", ");return e._display_name=v,v},"_getDisplayTitle"),l=d(function(e){var n=TS.mpims.legacyGetMembersInDisplayOrder(e),o=n.map(function(v){return TS.interop.rules.members.getPrefCompliantMemberName(v)}),c=TS.interop.i18n.listify(o,{strong:!0}).join("");return c},"_getDmBadgeDisplayName")})()},Foai:function(se,ae){(function(){TS.registerModule("files",{team_file_deleted_sig:new signals.Signal,team_file_deleted_success_sig:new signals.Signal,team_file_changed_sig:new signals.Signal,team_file_comment_added_sig:new signals.Signal,team_file_comment_deleted_sig:new signals.Signal,file_uploaded_sig:new signals.Signal,onStart:function(){TS.prefs.team_disable_file_editing_changed_sig.add(TS.files.upsertAndSignal),TS.files.file_uploaded_sig.add(f)},isFileAuthorExternal:function(i){if(!_.isObject(i))return!1;var l=TS.interop.members.getMemberById(i.user);return _.isObject(l)?TS.interop.rules.members.isExternal(l):!1},getFileById:function(i){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return TS.redux.files.getFileById(i,l)},getThumbSrcForFile:function(i,l){try{i=t(i)}catch{return!1}const e={suppressAnimations:!TS.prefs.getPref("a11y_animations"),...l};return TS.interop.files.getThumbSrcForFile(i,e)},fileIsImage:function(i){try{i=t(i)}catch{return!1}return TS.interop.files.fileIsImage(i)},fileIsPDF:function(i){try{i=t(i)}catch{return!1}return i.filetype==="pdf"||i.converted_pdf},getFileCommentById:function(i,l){for(var e,n=0;n<i.comments.length;n+=1)if(e=i.comments[n],e.id==l)return e;return null},addCommentToFile:function(i,l){var e=TS.files.getFileCommentById(l,i.id);return e||(i._rxn_key=TS.rxns.getRxnKey("file_comment",i.id),TS.rxns.upsertRxnsFromDataAndUpdateUI(i._rxn_key,i.reactions),delete i.reactions,l.comments.push(i),TS.files.sortCommentsOnFile(l),TS.files.team_file_comment_added_sig.dispatch(l,i),i)},sortCommentsOnFile:function(i){function l(e,n){return e.timestamp>n.timestamp?1:e.timestamp<n.timestamp?-1:0}d(l,"compare"),i.comments.sort(l)},upsertFile:function(i,l){l=l||"no reason";var e="NOOP",n=[];if(Object.keys(i).length<2)return TS.error("upserting a bad file object! it has less than 2 properties",i,`with reason: ${l}`),{status:e,file:i,what_changed:n};i&&_.isString(i)&&TS.interop.utility.looksLikeFileId(i)?(TS.interop.files.markObjectsAsFresh([i]),i=TS.files.getFileById(i)):TS.interop.files.markObjectsAsFresh([i.id]);var o=TS.files.getFileById(i.id),c,v,h;if(i=TS.interop.files.processFileForUpserting(i),o){if(i._rxn_key=TS.rxns.getRxnKey("file",i.id),v=TS.rxns.getExistingRxnsByKey(i._rxn_key),v&&!i.reactions?TS.error(`file:${i.id} (${l}) has reactions in local model, but we are upserting an object that does NOT have reactions, which seems suspicious`):TS.rxns.upsertRxnsFromDataAndUpdateUI(i._rxn_key,i.reactions),delete i.reactions,i.comments)for(h=0;h<i.comments.length;h+=1)c=i.comments[h],c._rxn_key=TS.rxns.getRxnKey("file_comment",c.id),v=TS.rxns.getExistingRxnsByKey(c._rxn_key),v&&!c.reactions?TS.warn(`comment:${i.id} (${l}) has reactions in local model, but we are upserting an object that does NOT have reactions, which seems suspicious`):TS.rxns.upsertRxnsFromDataAndUpdateUI(c._rxn_key,c.reactions),delete c.reactions;i.initial_comment&&(i.initial_comment._rxn_key=TS.rxns.getRxnKey("file_comment",i.initial_comment.id),v=TS.rxns.getExistingRxnsByKey(i.initial_comment._rxn_key),v&&!i.initial_comment.reactions?TS.warn(`initial_comment:${i.id} (${l}) has reactions in local model, but we are upserting an object that does NOT have reactions, which seems suspicious`):TS.rxns.upsertRxnsFromDataAndUpdateUI(i.initial_comment._rxn_key,i.initial_comment.reactions),delete i.initial_comment.reactions);for(var u in i)if(u==="channels"||u==="ims"||u==="groups"||u==="pinned_to"||u==="to"||u==="from"||u==="cc"||u==="attachments"){var m=!1,S=_.isArray(i[u])?i[u]:[],b=_.isArray(o[u])?o[u]:[];u==="to"||u==="from"||u==="cc"||u==="attachments"?b.length!=S.length&&(m=!0):b.join("")!=S.join("")&&(m=!0),m&&(e="CHANGED",n.push(u))}else u==="preview"?o[u]!==i[u]&&(e="CHANGED",n=n.concat([u,"content","content_html","content_highlight_html"])):u==="comments"?i[u]&&!TS.utility.areSimpleObjectsEqual(i[u],o[u],`file:${i.id} ${i.name}`)&&(e="CHANGED",n.push(u)):u==="content"?i[u]&&o[u]!=i[u]&&(e="CHANGED",n.push(u)):u==="editor"||u==="state"?i[u]!=o[u]&&(n.push(u),e="CHANGED"):u==="initial_comment"||u==="reactions"||(u==="channel_map"||u==="group_map"||u==="im_map"||u==="teams"||u==="teams_shared_with"||u==="users")&&!TS.utility.isScalar(i[u])||(u==="video"?i[u]&&!TS.utility.areSimpleObjectsEqual(i[u],o[u],`file:${i.id} ${i.name}`)&&(e="CHANGED",n.push(u)):u==="shares"?TS.utility.areSimpleObjectsEqual(o[u],i[u])||(e="CHANGED"):u==="pinned_info"?TS.utility.areSimpleObjectsEqual(o[u],i[u])||(e="CHANGED",n.push(u)):o[u]!=i[u]&&(i[u]&&!TS.utility.isScalar(i[u])?TS.warn(`${u} is not scalar! it needs to be handled by upsertFile specifically to test if it has changed! ${typeof i[u]}`):(typeof i[u]!="boolean"||!i[u]!=!o[u])&&(n.push(`${u} [${o[u]}] -> [${i[u]}]`),e="CHANGED")));o=i}else if(i&&_.isObject(i)){if(e="ADDED",i._rxn_key=TS.rxns.getRxnKey("file",i.id),TS.rxns.upsertRxnsFromDataAndUpdateUI(i._rxn_key,i.reactions),delete i.reactions,i.comments){for(h=0;h<i.comments.length;h+=1)c=i.comments[h],c._rxn_key=TS.rxns.getRxnKey("file_comment",c.id),TS.rxns.upsertRxnsFromDataAndUpdateUI(c._rxn_key,c.reactions),delete c.reactions;i.initial_comment&&(i.initial_comment._rxn_key=TS.rxns.getRxnKey("file_comment",i.initial_comment.id),TS.rxns.upsertRxnsFromDataAndUpdateUI(i.initial_comment._rxn_key,i.initial_comment.reactions),delete i.initial_comment.reactions)}o=i}return e==="CHANGED"&&_.includes(n,"comments")&&TS.utility.msgs.updateCommentReferences(o),e!=="NOOP"&&(_.isEmpty(o.comments)&&delete o.comments,TS.redux.dispatch(TS.interop.redux.models.files.addFile(o))),{status:e,file:o,what_changed:n}},upsertAndSignal:function(i,l){var e=TS.files.upsertFile(i,l);return e.status==="CHANGED"&&TS.files.team_file_changed_sig.dispatch(e.file),e},cancelCurrentUpload:function(){a&&a.abort()},nonImageCanUseFSFV:function(i){return i?TS.model.pdf_viewer_enabled&&i.mode==="hosted"&&TS.files.fileIsPDF(i)&&i.size<=5e7:!1},test:function(){return{_handleFileUploaded:f}}});var a=null,t=d(function(i){var l=_.isString(i)?TS.files.getFileById(i):i;if(!_.isObject(l))throw new Error("Expected file or file ID.");return l},"_ensureFileObject"),f=d(function(i,l){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!i)return;const n=TS.files.getFileById(l);if(n)if(e.thread_ts){const o=e.channels,c=e.thread_ts;TS.redux.dispatch(TS.interop.redux.actions.requestOfflineHistory({channelId:o,threadTs:c})),e.broadcast&&TS.redux.dispatch(TS.interop.redux.actions.requestOfflineHistory({channelId:o}))}else TS.interop.files.getFileShareLocations(n).forEach(c=>TS.redux.dispatch(TS.interop.redux.actions.requestOfflineHistory({channelId:c})))},"_handleFileUploaded")})()},G4VQ:function(se,ae){(function(){var a=10,t=10,f=100,i=100,l=33,e=100;TS.registerComponent("SearchableEnterpriseTeamList",{_constructor:function(n){this.id=n.id,this.triggered_by_user_action=n.triggered_by_user_action,this.$_container=n.$container,this.$_long_list_view,this.$_search_bar,this.$_search_input,this.$_clear_icon,this._team_searcher={},this._have_all_teams=!1,this._model_ob_id=n.model_ob_id,this._omit_my_team=!!n.omit_my_team,this._current_query="",this._approx_item_height=30,this._long_list_view_height=0,this._long_list_view_items_height=0,this._long_list_view_initial_height=null,this._fetch_page_p=null,this._resize_sig_handler=null,this.team_clicked_sig=new signals.Signal},destroy:function(){this.$_container.off(),this.$_long_list_view&&this.$_long_list_view.off(),this.$_search_input&&this.$_search_input.off(),this.$_clear_icon&&this.$_clear_icon.off(),this.$_long_list_view&&this.$_long_list_view.length&&$.data(this.$_long_list_view.get(0),"TS-longListView")&&this.$_long_list_view.longListView("destroy"),this.$_search_bar&&this.$_search_bar.remove()},showInitial:function(){var n=this;this.$_long_list_view=this.$_container.find(".p-searchable_enterprise_team_list__scroller"),this._showLoadingState(),this._fetchPage().then(function(){n._hideLoadingState()}).then(function(){return n._setupLongListView(),n._maybeSetupSearchBar(),null})},maybeRerenderLongListView:function(){this.$_long_list_view&&_.get(this._team_searcher,"items")&&this.$_long_list_view.longListView("setItems",this._team_searcher.items,!0,!0)},_fetchPage:function(){if(this._fetch_page_p)return this._fetch_page_p;var n=this;return this._setupSearcher(),this._fetch_page_p=TS.teams.promiseToSearchTeams(this._team_searcher).then(function(){n._fetch_page_p=null,n._have_all_teams=n._team_searcher.num_remaining<=0}),this._fetch_page_p},_setupSearcher:function(){this._team_searcher.max_api_results=this._current_query?f:t;var n=TS.interop.utility.looksLikeMemberId(this._model_ob_id)?TS.interop.members.getMemberById(this._model_ob_id):TS.redux.channels.getEntityById(this._model_ob_id);this._team_searcher.included_ids=TS.interop.utility.looksLikeMemberId(_.get(n,"id"))?_.get(n,"enterprise_user.teams",[]):TS.interop.rules.channels.getInternalTeamIds(TS.redux.getState(),n),_.get(TS.model.user,"is_restricted")&&(this._team_searcher.included_ids=_.intersection(_.get(TS.model.user,"enterprise_user.teams"),this._team_searcher.included_ids)),this._omit_my_team&&(this._team_searcher.omitted_ids=[TS.model.team.id]),this._current_query&&(this._team_searcher.query=this._current_query)},_fetchProcessAndDisplayPage:function(){var n=this;return this._fetchPage().then(function(){return n._maybeHideNoResultsState(),_.get(n._team_searcher,"items.length")?n.$_long_list_view.longListView("setItems",n._team_searcher.items,!0,!0):n._showNoResultsState(),null}).then(function(){return TS.utility.rAF(function(){n._long_list_view_height=n.$_long_list_view.height(),n._long_list_view_items_height=n.$_long_list_view.find(".list_items").height(),n._recursivelyFillLongListViewToHeight()}),null})},_maybeSetupSearchBar:function(){var n=this;if(!this.$_search_bar){var o=TS.interop.utility.looksLikeMemberId(this._model_ob_id)?TS.interop.members.getMemberById(this._model_ob_id):TS.redux.channels.getEntityById(this._model_ob_id),c;TS.interop.utility.looksLikeMemberId(_.get(o,"id"))?c=_.get(o,"enterprise_user.teams.length"):_.get(o,"is_global_shared")?c=1/0:c=TS.interop.rules.channels.getInternalTeamIds(TS.redux.getState(),o).length,c>=a&&(n.$_long_list_view.before(TS.templates.teams_search_bar()),n.$_search_bar=n.$_container.find(".p-searchable_enterprise_team_list__search_bar"),n.$_search_input=n.$_search_bar.find(".p-searchable_enterprise_team_list__input"),n._setupSearchInput())}},_setupSearchInput:function(){var n=this;this.$_search_bar.find(".p-searchable_enterprise_team_list__search.loading").replaceWith(TS.templates.teams_search_bar_input()),this.$_search_input=this.$_search_bar.find(".p-searchable_enterprise_team_list__input"),this.$_clear_icon=this.$_container.find(".icon_close"),this.$_search_input.bind("keyup.searchable_enterprise_team_list",this._handleSearchKeyUp.bind(this)),this.$_clear_icon.bind("click",function(){n._reset(),Promise.resolve().then(function(){return n.$_search_input.focus(),null})}),this.triggered_by_user_action&&this.$_search_input.focus()},_setupLongListView:function(){var n=this,o=TS.interop.utility.looksLikeMemberId(this._model_ob_id);this.$_long_list_view.longListView({items:this._team_searcher.items||[],approx_item_height:this._approx_item_height,approx_divider_height:this._approx_divider_height,calcItemHeight:function(c){return c.outerHeight()},makeElement:function(){return $(TS.templates.teams_list_item())},renderItem:function(c,v){var h=TS.model.team.id!==v.id,u=o&&h;c.html(TS.templates.teams_team_row({team:v,linked:u?n._buildTeamLink(v):!1,target:u?n._buildTeamLinkTarget(v):""})),TS.utility.makeSureAllLinksHaveTargets(c)}}),this.$_long_list_view.on("click","[data-long-list-item]",function(c){n.team_clicked_sig.dispatch(c,TS.teams.getTeamById($(c.target).closest(".p-enterprise_team_item").find("[data-team-id]").data("teamId")))}),this._resize_sig_handler=_.throttle(function(){n._long_list_view_height=n.$_long_list_view.height(),n._long_list_view_items_height=n.$_long_list_view.find(".list_items").height(),n._long_list_view_initial_height||(n._long_list_view_initial_height=n._long_list_view_height)},l),this.$_long_list_view.on("scroll",_.debounce(function(c){if(!n._current_query){var v=n._long_list_view_items_height-($(c.target).scrollTop()+n._long_list_view_height);v<i&&n._fetchProcessAndDisplayPage()}},e)),TS.utility.rAF(function(){n._recursivelyFillLongListViewToHeight()})},_recursivelyFillLongListViewToHeight:function(){var n=this;this._current_query||this._long_list_view_items_height<=this._long_list_view_height&&!this._have_all_teams&&this._fetchProcessAndDisplayPage().then(function(){n._long_list_view_items_height=n.$_long_list_view.find(".list_items").height()})},_reset:function(){this._team_searcher={},this._current_query="",this.$_search_input.val(""),this.$_clear_icon.addClass("hidden"),this._have_all_teams=!1,this._maybeHideNoResultsState(),this.$_long_list_view.longListView("setItems",[],!0,!0),this.$_long_list_view.scrollTop(0),this.$_long_list_view.height(this._long_list_view_initial_height),this._fetchProcessAndDisplayPage()},_showLoadingState:function(){this.$_long_list_view.before(TS.templates.infinite_spinner({color:"white",size:"medium"}))},_hideLoadingState:function(){this.$_container.find(".infinite_spinner").remove()},_showNoResultsState:function(){var n=this.$_container.find(".no_results");n.length>0&&n.remove();var o=this,c={query:this._current_query},v=TS.templates.teams_searchable_no_results(c);this.$_long_list_view.hide().before(v),this.$_container.on("click",".clear_enterprise_team_filter",function(){o._reset()})},_maybeHideNoResultsState:function(){var n=this.$_container.find(".no_results");if(n.length!=0){var o=this.$_container.find(".other_matches");o&&o.remove(),n.remove(),this.$_long_list_view.show()}},_handleSearchKeyUp:function(n){var o=$(n.target).val();o.trim()!==this._current_query&&(this._fetch_page_p&&(this._fetch_page_p.cancel(),this._fetch_page_p=null),this._team_searcher={},this._have_all_teams=!1,this._current_query=o.trim(),this._fetchProcessAndDisplayPage(),this.$_long_list_view.scrollTop(0),this.$_clear_icon.toggleClass("hidden",!this._current_query))},_buildTeamLink:function(n){return`${TS.utility.enterprise.buildTeamUrl(n.domain)}home`},_buildTeamLinkTarget:function(n){return TS.utility.enterprise.buildTeamUrl(n.domain)},test:function(){var n={};return Object.defineProperty(n,"MINIMUM_TEAMS_FOR_SEARCH",{get:function(){return a},set:function(o){a=o}}),Object.defineProperty(n,"FETCH_PAGE_SIZE",{get:function(){return t},set:function(o){t=o}}),Object.defineProperty(n,"FETCH_PAGE_SIZE_SEARCH",{get:function(){return f},set:function(o){f=o}}),n}})})()},GNek:function(se,ae){(function(){TS.registerModule("redux.reactions",{getReactionsForKey:function(a){return TS.interop.redux.models.reactions.getReactionsForKey(TS.redux.getState(),a)},upsertReactions:function(a,t,f){const i=TS.redux.reactions.getReactionsForKey(a),l=TS.redux.dispatch(TS.interop.redux.models.reactions.upsertReactions({key:a,reactions:t,fromUserAction:f}));let e="NOOP";return l&&(t&&_.isEmpty(i)?e="ADDED":_.isEqual(i,t)||(e="CHANGED")),{status:e,what_changed:[],rxns:t}}})})()},GhXE:function(se,ae){(function(){const a="STORAGE";TS.registerModule("storage",{version:"0.85",msgs_version:window.boot_data&&boot_data.cache_version||"unknown_version",cache_ts_version:window.boot_data&&boot_data.cache_ts_version||"unknown_version",do_compression:!TS.model.is_our_app&&typeof window.Worker<"u"&&(!window.bowser||!bowser.phantom&&!bowser.msie),test:function(){return{getLocalStorage:oe,setLocalStorage:D,getKeys:x,set:q}},onStart:function(){TS.storage.onStart=function(){},TS.storage.do_compression||(TS.interop.console.info(a,"Special case: force-enabling LS compression for this session."),TS.storage.do_compression=!0),TS.storage.version+=TS.storage.do_compression?"-compressed-LZString":"";var M=e||!ne||function(){return!TS.storage.storageAvailable()&&(ee(),!TS.storage.storageAvailable())?(TS.interop.console.info(a,"TS.storage.storageAvailable() = false in onStart after flushing all our keys, so disabling"),!0):!1}();TS.has_pri[R]&&(TS.log(R,`TS.storage.onStart should_disable:${M}`),TS.log(R,`TS.storage.do_compression:${TS.storage.do_compression} (_ls.getItem('is_compressed') === 'yes'):${ne&&ne.getItem("is_compressed")==="yes"}`)),TS.ui.window_unloaded_sig.add(y),TS.ui.window_focus_changed_sig.add(T),TS.storage.setDisabled(M),q("rxn_records",null);var E=TS.storage.fetchExpandableState();TS.redux.dispatch(TS.interop.redux.features.expandables.bulkSetExpanded(E))},setDisabled:function(M){e!=M&&(M||!ne?(e=!0,ne&&ee()):(e=!1,U()),TS.log(R,`_disabled:${e}`))},storageAvailable:function(){if(!ne)return!1;try{var M="test_to_see_if_we_can_write_to_local_storage";return ne.setItem(M,"foo"),ne.removeItem(M),!0}catch{return!1}},storageSize:function(M){var E=0;if(!ne)return E;for(var k=x(),O=0,z,W,V=0;V<k.length;V+=1)O+=1,z=k[V],W=ne.getItem(z),!W&&W!==""?TS.interop.console.info(a,`${z} not measurable value, typeof:${typeof W}`):(E+=W.length,M&&TS.info(`${z}=${(W.length*2/1024).toFixed(2)}KB (total=${(E/1024).toFixed(2)}KB)`));return M&&TS.info(`total for ${O} items is ${(E/1024).toFixed(2)}KB`),E},flush:function(M){TS.has_pri[R]&&TS.log(R,"TS.storage.flush()"),ee(),M&&TS.storage.clearBufferAndCache()},clearBufferAndCache:function(){TS.has_pri[R]&&TS.log(R,"TS.storage.clearBufferAndCache()"),o={},c={},TS.compresion&&TS.compression.terminate()},fetchStorageVersion:function(){return j("storage_version")},storeStorageVersion:function(M){q("storage_version",M,!0)},fetchCacheTSStorageVersion:function(){return j("storage_cache_ts_version")},_makeMsgInputId:function(M){return`msg_input_${M}`},fetchLastMsgInput:function(M){var E=j(TS.storage._makeMsgInputId(M),null);return E==="\u4000"?(TS.interop.utility.getLogger({getState:TS.redux.getState}).error({storage_version:TS.storage.fetchStorageVersion(),ts_storage_version:TS.storage.version,is_our_app:TS.model.is_our_app,typeof_window_worker:typeof window.Worker,has_bowser:!!window.bowser},"decompress_general_compressed_fail"),""):E},legacyGetAllDraftChannelIds:function(){return x().map(E=>E.match(/msg_input_(C|G|D)[A-Z0-9]{8,}$/)?E.split("_")[3]:void 0).filter(E=>E&&!!TS.storage.fetchLastMsgInput(E))||[]},fetchOldestTs:function(M){return j(l(M),null)},fetchLastEventTS:function(M){return j("last_event_ts","",M)||""},storeUIState:function(M){q("ui_state",M)},fetchExpandableState:function(){var M=j("expandable_state",{});return M&&typeof M=="object"?M:{}},fetchCustomEmoji:function(){return j("custom_emoji",null)||null},fetchStaticTranslations:function(){return j("static_translations",null)||null},storeStaticTranslations:function(M){q("static_translations",M)},fetchApps:function(){return j("apps",null)||null},fetchCmds:function(){return j("cmds",null)||null},storeFilterState:function(M){q("team_filter_state",M)},fetchFrecency:function(M){return j(`frecency_${M}`)},storeFrecency:function(M,E){q(`frecency_${M}`,E)},clearFrecency:function(M){q(`frecency_${M}`,"")},fetchLastEKMChangeTimestamp:function(){return j("last_ekm_change_ts","0")||"0"},storeLastEKMChangeTimestamp:function(M){q("last_ekm_change_ts",M)}});var t=`${window.boot_data.user_id}_`,f="channel_msgs_",i="oldest_msg_ts_",l=d(function(M){return i+M},"_makeOldestTsId"),e,n=!1,o={},c={},v=1e3,h=!1,u=1e3,m=!1,S=1e3,b=!1,w=!1,x=d(function(){var M=[];if(!ne)return M;var E=ne.length;if(!E)return M;for(var k=0;k<E;k+=1)M.push(ne.key(k));return M},"_getKeys"),U=d(function(){var M;if(!e){var E=TS.storage.fetchStorageVersion()||"",k=E.indexOf("-compressed")!=-1||ne.getItem("is_compressed")==="yes";TS.storage.do_compression&&!k?(TS.interop.console.info(a,"migrating to compressed format"),M=x(),M.forEach(function(W){var V=W.replace(t,""),Q=Z(W,ne.getItem(W)),K=`converting: ${W} -> ${V} val.length: ${Q==null?-1:String(Q).length}`;q(V,null),q(V,Q),j(V)==Q?TS.has_pri[R]&&TS.log(R,`${K} SUCCESS _get(name) has a value:${!!j(V)}, and it it the same as val`):TS.error(`${K} FAILURE _get(name) !== val`)}),TS.interop.console.info(a,`migration to compressed format complete, ${M.length} migrated`),TS.storage.storeStorageVersion(TS.storage.version)):TS.has_pri[R]&&TS.log(R,"no migration needed"),ne.setItem("is_compressed",TS.storage.do_compression?"yes":"no")}var O=TS.storage.fetchCacheTSStorageVersion();TS.has_pri[R]&&TS.log(R,`storage_cache_ts_version:${O}`);var z=TS.storage.fetchStorageVersion()||"";TS.has_pri[R]&&(TS.log(R,`TS.storage.version:${TS.storage.version}`),TS.log(R,`storage_version:${z}`),TS.log(R,`TS.storage last_unload_flushing: ${j("last_unload_flushing")}`),TS.log(R,`TS.storage.storageAvailable(): ${TS.storage.storageAvailable()}`)),M=x(),TS.has_pri[R]&&TS.dir(R,M,"_getKeys()"),TS.storage.storageAvailable()?z!=TS.storage.version?(TS.log(R,`storage_version:${z} does not match TS.storage.version:${TS.storage.version} so flushing all our keys: ${M.join(", ")}`),ee()):TS.storage.fetchLastEventTS()||(TS.log(R,"TS.storage.fetchLastEventTS() is empty so flushing channel data"),F()):(TS.log(R,"TS.storage.storageAvailable() = false so flushing all our keys"),ee()),TS.storage.storeStorageVersion(TS.storage.version)},"_setUp"),ee=d(function(){x().forEach(function(M){M.indexOf(t)===0&&ne.removeItem(M)})},"_removeAllOurKeys"),F=d(function(){var M=x();TS.has_pri[R]&&TS.log(R,M,"_getKeys()");for(var E,k=0;k<M.length;k+=1)E=M[k],E.indexOf(t)===0&&(E.indexOf(f)==-1&&E.indexOf(i)==-1||(ne.removeItem(E),delete o[E]));for(E in o)E.indexOf(t)===0&&(E.indexOf(f)==-1&&E.indexOf(i)==-1||delete o[E]);c={},M=x(),TS.dir(488,M,"_getKeys()")},"_completelyEmptyAllStorage"),y=d(function(){n=!0,q("last_unload_flushing",new Date().toString(),!0),A(!0,"_windowUnloaded"),TS.compression.terminate()},"_windowUnloaded"),T=d(function(){A(!0,"_windowBlurred")},"_windowBlurred"),s=d(function(M){return typeof M=="string"||typeof M=="number"||!M?M:JSON.stringify(M)},"_prepareValForStorage"),g=d(function(M){return M==="undefined"||M==="null"?null:M},"_correctBadValsFromStorage"),A=d(function(M,E){if(!e){var k=new Date,O=Date.now(),z,W=0,V,Q=TS.model&&TS.model.team&&TS.model.team.domain&&TS.boot_data.feature_tinyspeck,K,te,de,fe,ue;for(V in o)if(!o[V].being_flushed){if(fe=s(o[V].val),fe==null)ne.removeItem(V),delete o[V],delete c[V];else try{Y(V,fe)}catch(_e){TS.error(0,_e),ee(),delete o[V],delete c[V];continue}if(W+=1,z=Date.now()-O,Q&&TS.has_pri[R]&&TS.log(R,`_flushBuffer _ls.setItem ${V}: ${z}ms ${o[V]&&o[V].val&&o[V].val.toString?o[V].val.toString().substr(0,100):"NULL?"}`),!M&&(K=new Date-k,!b&&K>S)){b=!0,de=new Date;try{te=TS.storage.storageSize()}catch{}de=new Date-de,ue=`Took ${K}ms for ${W} item (!all case) (threshold is ${S} ms). Key: ${V}. Buffer length: ${o[V]&&o[V].val&&o[V].val.toString()?o[V].val.toString().length:"unknown (not a string)"}. localStorage size: ${te||"unknown"}. Time to read LS size: ${de}`,TS.info(`_flushBuffer exceeded slow write threshold: ${ue}`)}if(o[V]&&(o[V].being_flushed=!0),!M){TS.has_pri[R]&&TS.log(R,`_flushBuffer: Wrote one item. why: ${E}`);return}c={}}if(W&&!w&&(K=new Date-k,K>S)){w=!0;try{te=TS.storage.storageSize()}catch{}ue=`Took ${K}ms for ${W} items (threshold is ${S} ms). localStorage size: ${te}. App open for ${((Date.now()-TS.boot_data.start_ms)/1e3/60).toFixed(2)} min. why: ${E}`,TS.info(`_flushBuffer exceeded slow write threshold (all case): ${ue}`)}TS.has_pri[R]&&(W===0?TS.log(R,"_flushBuffer: Nothing to save."):TS.log(R,`_flushBuffer: Saved ${W}${W===1?" item":" items"} why: ${E}`))}},"_flushBuffer"),j=d(function(M,E,k){var O=t+M;if(k&&TS.info(`_get name:${M} k:${O} disabled:${e} _buffer["${O}"].val:${o[O]&&o[O].val}`),e||O in o)return o[O]&&o[O].val||E;if(c.hasOwnProperty(O))return c[O];var z=Z(O,B(O,ne.getItem(O)),E,k);return c[O]=z,z},"_get"),Z=d(function(M,E,k,O){var z=new Date,W=g(E);O&&TS.info(`_get _correctBadValsFromStorage(_ls.getItem(k)) k:${M} typeof result:${typeof W} /^[{[]/.test(result):${/^[{[]/.test(W)}`);var V;if(W&&typeof W=="string"&&/^[{[]/.test(W)&&(W=TS.utility.parseJSONOrElse(W)||W),W=W||(k!==void 0?k:null),z=new Date-z,!h&&z>v){h=!0;try{V=TS.storage.storageSize()}catch{}var Q=`_get took longer than threshold: Took ${z}ms to read ${M} (theshold is ${v}ms), length = ${W&&!isNaN(W.length)?W.length:"unknown"}. Storage size: ${V}`;TS.info(Q)}return W},"_convertTypeForFetch"),q=d(function(M,E,k,O){var z=!1,W=new Date,V,Q=t+M;if(o[Q]={val:E,being_flushed:!1},c[Q]=o[Q].val,O&&TS.info(`_set immediate:${k} name:${M} k:${Q} disabled:${e} do_compression:${TS.storage.do_compression} _buffer["${Q}"].val:${o[Q].val}`),k){if(!e){var K=s(E);if(K==null)ne.removeItem(Q),delete o[Q];else try{Y(Q,K,k)}catch{TS.interop.console.warn(`_set _ls.setItem failed, flushing. TS.storage.storageSize():${TS.storage.storageSize(!1)}`),z=!0}}if(O&&TS.info(`_set failed:${z}`),!z)if(O&&TS.info(`_set _buffer["${Q}"]:${o[Q]&&JSON.stringify(o[Q])}`),W=new Date-W,W>u){if(TS.interop.console.info(a,`_set immediately ${M}: ${W}ms ${E&&E.toString?E.toString().substr(0,100):"NULL?"}`),!m){m=!0;try{V=TS.storage.storageSize()}catch{}var te=`_set exceeded slow set threshold (immediate): Took ${W}ms to write ${Q} (theshold is ${u}ms), length = ${E&&!isNaN(E.length)?E.length:"unknown"}. Storage length: ${V}`;TS.info(te)}}else TS.has_pri[R]&&TS.log(R,`_set GOOD immediately: ${k} ${M}: ${W}ms`,E)}},"_set"),ne=window.localStorage,oe=d(function(){return ne},"_getLs"),D=d(function(M){ne=M},"_setLs"),Y=d(function(M,E,k){if(E=String(E),TS.storage.do_compression){TS.compression.compress(M,E,k||n,J);return}J({k:M,str:E})},"_compressAndStore"),J=d(function(M){ne.setItem(M.k,M.str);var E=d(function(k){var O=ne.getItem(M.k);if(O===M.str){k>1&&TS.interop.console.info(a,`${M.k} now saved, try #${k}`),delete o[M.k],delete c[M.k];return}if(k>1&&(!o[M.k]||o[M.k].val!=M.str)){TS.error(`buffer changed for ${M.k} so we don't care anymore, a new value is being set for it, try #${k}`);return}TS.error(`WTF not saved, try #${k} ${M.k} ${(M.str||"").length} typeof ob.str:${typeof M.str} from_ls:${typeof O}`),ne.setItem(M.k,M.str),setTimeout(E,1e3,k+1)},"testAndFinishOrTryAgain");E(1)},"_afterCompress"),B=d(function(M,E){if(!TS.storage.do_compression)return E==="\u4000"?(TS.interop.utility.getLogger({getState:TS.redux.getState}).error({storage_version:TS.storage.fetchStorageVersion(),ts_storage_version:TS.storage.version,is_our_app:TS.model.is_our_app,typeof_window_worker:typeof window.Worker,has_bowser:!!window.bowser},"decompress_empty_string_fail"),""):E;var k=Date.now();E&&(E=LZString.decompress(E));var O=Date.now()-k;return E&&TS.has_pri[R]&&TS.log(R,`${M} took ${O}ms to _decompress str.length: ${E.length}`),E==="\u4000"?(TS.interop.utility.getLogger({getState:TS.redux.getState}).error({storage_version:TS.storage.fetchStorageVersion(),ts_storage_version:TS.storage.version,is_our_app:TS.model.is_our_app,typeof_window_worker:typeof window.Worker,has_bowser:!!window.bowser},"decompress_double_compressed_fail"),""):E},"_decompress"),R=488})()},HUaD:function(se,ae){(function(){TS.registerModule("enterprise.workspaces",{onStart:function(){},showRequestDialog:function(){let{displayModernToast:a=_.noop}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var t="#generic_dialog",f=".dialog_go",i="enterprise.teams.creationrequests.create",l="#input_ws_team_name",e="#textarea_ws_team_message",n,o;function c(){var v=$(t),h=v.find(f);return n&&o?(h.removeAttr("disabled"),!0):(h.attr("disabled",!0),!1)}d(c,"checkForm"),TS.generic_dialog.start({title:TS.interop.i18n.t("Request creation of a new workspace","enterprise_workspaces")(),body:TS.templates.ws_request_dialog(),show_cancel_button:!0,show_go_button:!0,go_button_text:TS.interop.i18n.t("Send Request","enterprise_workspaces")(),onGo:function(){var v=$(t),h=$(l),u=_.escape(h.val()),m=$(e),S=m.val(),b=v.find(f);b.addClass("ladda-button"),b.attr("data-style","expand-right");var w=Ladda.create(b[0]);w.start();var x={name:_.unescape(u),reason:S};return TS.boot_data.app==="client"&&(x.enterprise_token=TS.model.enterprise_api_token),TS.interop.api.callExpedited(i,x).then(function(){a({type:"success",teamName:u}),TS.generic_dialog.end(),TS.generic_dialog.cancel()}).catch(function(U){if(!U||!U.data){TS.error(`WTF: error, but no response or data on ${i}?`,U);return}var ee=U.data;a({type:"error",errorType:ee.error,teamName:u}),TS.error(`${i} failed with error: ${ee.error||"undefined"}`),w.stop()}),!1}}),$(l).on("keyup change",function(){n=TS.ui.validation.validate($(l)),c()}),$(e).on("keyup change",function(){o=TS.ui.validation.validate($(e)),c()}),$(l).focus(),$(t).find(f).attr("disabled",!0)}})})()},HfRC:function(se,ae){(function(){TS.registerModule("rxns",{upsertRxnsFromDataAndUpdateUI:function(t,f){var i=a(t,f);return i},getRxnKey:function(t,f,i){return t==="message"&&!i&&TS.error("getRxnKey: no c_id provided for message rxn_key"),t!=="message"&&i&&TS.error("getRxnKey: c_id provided for but this is not a message rxn_key"),`${t}-${f}-${i||""}`},getExistingRxnsByKey:function(t){var f=TS.redux.reactions.getReactionsForKey(t);return f&&f.length?f:null},test:function(){return{upsertRxnsFromData:a}}});var a=d(function(t,f){return TS.redux.reactions.upsertReactions(t,f,!1)},"_upsertRxnsFromData")})()},I1WX:function(se,ae){(function(){TS.registerModule("templates.helpers",{onStart:function(){TS.templates.helpers.register()},register:function(){Handlebars.registerHelper("debugger",function(){debugger}),Handlebars.registerHelper("i18n_ns",function(e){if(!_.isObject(this)){TS.warn(`Cannot set i18n namespace "${e}". Chances are you\u2019ve inadvertently changed the context in a Handlebars partial to something that\u2019s not an object.`);return}this._i18n_ns&&(this._i18n_ns_history?this._i18n_ns_history.push(this._i18n_ns):this._i18n_ns_history=[this._i18n_ns]),this._i18n_ns=e}),Handlebars.registerHelper("_i18n_ns_end",function(){this._i18n_ns_history&&this._i18n_ns_history.length&&(this._i18n_ns=this._i18n_ns_history.pop())}),Handlebars.registerHelper("i18n_img",function(e){var n=e.fn(this),o=e&&e.hash&&e.hash.locales?e.hash.locales:null;return o&&(o=o.replace(/\s/g,""),o.split(",").indexOf(TS.interop.i18n.locale)>-1&&(n=n.replace(/(\..+$)/,`.${TS.interop.i18n.locale}$1`))),n}),Handlebars.registerHelper("t",function(e){var n;typeof e=="string"?(n=e,e=arguments[1]):n=e.fn();var o;e.hash.ns!==void 0?o=e.hash.ns:this._i18n_ns!==void 0?o=this._i18n_ns:o=e.data.root&&e.data.root._i18n_ns?e.data.root._i18n_ns:"";var c=this;_.isObject(c)||(c={this:c});var v={},h;_.forOwn(e.hash,function(x,U){v[U]=c[U],c[U]=Handlebars.Utils.escapeExpression(x)});var u=n.match(/{[^\s}]+}/g);if(u&&u.length){var m=d(function(x){var U=x.split(".");if(U.length>1){var ee=0,F=U.length,y=c;for(ee;ee<F;ee+=1)if(y=y[U[ee]],y===void 0)return;return y}return c[x]},"getValue"),S,b=0,w=u.length;for(b;b<w;b+=1)h=u[b].slice(1,-1),e.hash[h]===void 0&&(S=m(h),S!==void 0&&(v[h]=c[h],c[h]=Handlebars.Utils.escapeExpression(S)))}return e.hash.debug&&(TS.info("debug handlerbars t helper"),TS.info(this)),c.__handlebars=!0,n=TS.interop.i18n.t(n,o)(c),_.forOwn(v,function(x,U){c[U]=x}),n}),Handlebars.registerHelper("zdLocale",function(){return TS.interop.i18n.zdLocale()}),Handlebars.registerHelper("exampleEmail",function(e){return TS.utility.exampleEmailAddress(e)}),Handlebars.registerHelper("convertTimestampToMilliseconds",function(e){return e*1e3}),Handlebars.registerHelper("listify",function(e,n){n.hash.map&&(e=_.map(e,n.hash.map));var o=_.get(n.hash,"conjunction"),c=_.get(n.hash,"strong"),v=_.get(n.hash,"no_escape"),h=TS.interop.i18n.listify(e,{conj:o,strong:c,noEscape:v});return new Handlebars.SafeString(h.join(""))}),Handlebars.registerHelper("isClient",function(e){return TS.boot_data.app==="client"?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("isChrome",function(e){return TS.model.is_chrome_desktop||TS.model.is_chrome_mobile?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("isWeb",function(e){return TS.boot_data.app==="web"||TS.boot_data.app==="space"||TS.boot_data.app==="calls"?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("isMac",function(e){return TS.model.is_mac?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("isWin",function(e){return TS.model.is_win?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("isLin",function(e){return TS.model.is_lin?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("isOurApp",function(e){return TS.model.is_our_app?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("feature",function(e){var n=e.hash.flag;return TS.qs_args[n]==1||TS.boot_data[n]==1?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("pageNeedsEnterprise",function(e){return TS.boot_data.page_needs_enterprise?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("isChannelRequired",function(e,n){return TS.interop.rules.channels.isRequired(e)?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("experiment",function(e){var n=e.hash.name,o=e.hash.group||"treatment";return TS.interop.experiments.getGroupForUser(n)===o?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("stripWhitespace",function(e){return e.replace(/\s+/g,"")}),Handlebars.registerHelper("cash",function(e){var n=e.hash.all_digits||!1,o=e.hash.currency_code||"USD",c=parseInt(e.hash.value,10);return TS.interop.currency.formatCurrency(c,o,{displayTrailingZeroes:n})}),Handlebars.registerHelper("possessive",function(e){return TS.interop.i18n.possessive(e)}),Handlebars.registerHelper("fullPossessiveString",function(e){return TS.interop.i18n.fullPossessiveString(e)}),Handlebars.registerHelper("toLowerCase",function(e){return e.toLowerCase()}),Handlebars.registerHelper("initialsSafe",function(e){var n=TS.interop.rules.teams.getTeamInitials(e,{limit:2});return new Handlebars.SafeString(n)}),Handlebars.registerHelper("json",function(e){return typeof e=="object"&&e!==null&&e.name==="json"?JSON.stringify(this):JSON.stringify(e)}),Handlebars.registerHelper("currentTeamName",function(){return _.escape(_.get(TS.model.team,"name",""))}),Handlebars.registerHelper("currentTeamNameSafe",function(){return new Handlebars.SafeString(_.escape(_.get(TS.model.team,"name","")))}),Handlebars.registerHelper("isSlackbot",function(e){return TS.interop.rules.members.isSlackbot(e)}),Handlebars.registerHelper("convertFilesize",function(e){return TS.interop.utility.convertFilesize(e)}),Handlebars.registerHelper("roundToThree",function(e){return TS.utility.roundToThree(e)}),Handlebars.registerHelper("toDate",function(e){return TS.interop.datetime.formatDate(e,"{date_num}",{customFormat:"YYYY-MM-DD, LT"})}),Handlebars.registerHelper("toCalendarDate",function(e){return TS.interop.datetime.toCalendarDate(e)}),Handlebars.registerHelper("toCalendarDateOrNamedDay",function(e){return TS.interop.datetime.toCalendarDateOrNamedDay(e)}),Handlebars.registerHelper("toCalendarDateIfYesterdayOrToday",function(e){return TS.interop.datetime.toCalendarDateIfYesterdayOrToday(e)}),Handlebars.registerHelper("toCalendarDateOrNamedDayShort",function(e){return TS.interop.datetime.toCalendarDateOrNamedDay(e,{shortenMonth:!0})}),Handlebars.registerHelper("toTime",function(e,n,o){return(!e||_.isObject(e))&&(e=window.moment().unix()),TS.interop.datetime.formatDate(e,"{time}",{do24hrTime:TS.utility.date.do24hrTime(),includeMeridiem:n!==!1,includeSeconds:o===!0})}),Handlebars.registerHelper("toTimeAgo",function(e){return TS.interop.datetime.toTimeAgo(e,{alwaysAgo:!0})}),Handlebars.registerHelper("toTimeDuration",function(e){return TS.interop.datetime.toTimeDuration(e)}),Handlebars.registerHelper("toHour",function(e){return TS.interop.datetime.toHour(e)}),Handlebars.registerHelper("shouldShowMemberTimezone",function(e){return e.tz&&!e.is_slackbot&&!e.is_bot}),Handlebars.registerHelper("memberLocalTime",function(e){var n=e&&e.tz?e.tz:"America/Los_Angeles",o=TS&&TS.boot_data&&TS.boot_data.dst_offsets&&TS.boot_data.dst_offsets[e.tz]&&TS.boot_data.dst_offsets[e.tz].tz_offset?TS.boot_data.dst_offsets[e.tz].tz_offset:-25200,c=TS.interop.datetime.memberLocalTime(Date.now(),{timeZone:n,timeZoneOffset:o,do24hrTime:TS.utility.date.do24hrTime()}),v=TS.interop.i18n.t('<span class="timezone_value">{local_time}</span> local time',"date_utilities")({local_time:c});return new Handlebars.SafeString(v)}),Handlebars.registerHelper("isToday",function(e,n){return TS.interop.datetime.isToday(TS.interop.datetime.toDateObject(e))?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("if_equal",function(e,n){return n=a(n),e==n.hash.compare?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("if_not_equal",function(e,n){return n=a(n),e!=n.hash.compare?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("if_gt",function(e,n){return n=a(n),e>n.hash.compare?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("if_lt",function(e,n){return n=a(n),e<n.hash.compare?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("or",function(e,n,o){return o=a(o),e||n?o.fn(this):o.inverse(this)}),Handlebars.registerHelper("and",function(e,n,o){return o=a(o),e&&n?o.fn(this):o.inverse(this)}),Handlebars.registerHelper("foreach",function(e,n){return n.inverse&&!e.length?n.inverse(this):e.map(function(o,c){var v={index:c,value:o,length:e.length};return v.first=c===0,v.last=c===e.length-1,n.fn(v)}).join("")}),Handlebars.registerHelper("repeat",function(e,n){for(var o="",c=0;c<e;c+=1)o+=n.fn(c);return o}),Handlebars.registerHelper("newWindowName",TS.templates.builders.newWindowName),Handlebars.registerHelper("truncate",function(e,n){var o=truncate(e,n);return o.replace(/&#64;/g,"@")}),Handlebars.registerHelper("truncateToNearestWordBoundary",TS.utility.truncateToNearestWordBoundary),Handlebars.registerHelper("proxyImgUrls",function(e){var n=$(`<div>${e}</div>`);return TS.templates.builders.proxyImgUrlsForEmails(n),n.html()}),Handlebars.registerHelper("isArchived",function(e){return TS.interop.rules.channels.isArchived(e)}),Handlebars.registerHelper("isEnterpriseTeam",function(e){return TS.boot_data.page_needs_enterprise?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("memberIsUnavailable",function(e,n){return n=a(n),TS.interop.rules.members.isUnavailable(TS.redux.getState(),e)?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("isModelObExtShared",function(e,n){return TS.interop.utility.isModelObjectExternal(e)?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("shouldUseInitialsIcon",function(e,n,o){return e&&e.icon&&(e.icon.image_default||n)?o.fn(this):o.inverse(this)}),Handlebars.registerHelper("makeTeamNameList",function(e,n){if(n=n||{},n=n.hash||n,!e)return"";var o=_.map(e,v=>TS.teams.getTeamById(v)).map(v=>TS.interop.rules.teams.isUnknown(v)?TS.templates.unknown_team({id:v.id,subtler:n.subtler}):_.escape(TS.interop.rules.teams.getTeamDisplayName(v))),c=TS.interop.i18n.listify(o,{...n,noEscape:!0}).join("");if(c)return new Handlebars.SafeString(c)}),Handlebars.registerHelper("mpimMemberCount",function(e){return TS.mpims.getMemberCount(e)}),Handlebars.registerHelper("mpimDisplayName",function(e,n,o,c,v){n=n===!0,v=v===!0;var h=TS.mpims.legacyGetDisplayName(e,n,o===!0,c,v);return n||v?new Handlebars.SafeString(h):h}),Handlebars.registerHelper("currentUserId",function(){return TS.model.user.id}),Handlebars.registerHelper("makeMemberPresenceIcon",function(e){return TS.warn("Presence icons should not be used outside of the client application, because they rely on a WS connection to keep presence up to date. Rendering anyway, but be careful out there!"),new Handlebars.SafeString(TS.templates.makeMemberPresenceIcon(e))}),Handlebars.registerHelper("showDraftIcon",function(e,n){return TS.templates.builders.legacyShowDraftIcon(e)?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("makeMemberPreviewLink",function(){var e=TS.templates.builders.makeMemberPreviewLink.apply(this,arguments);return new Handlebars.SafeString(e)}),Handlebars.registerHelper("makeMemberPreviewLinkImage",function(){return new Handlebars.SafeString(TS.templates.builders.makeMemberPreviewLinkImage.apply(this,arguments))}),Handlebars.registerHelper("makeProfileImage",TS.templates.builders.makeProfileImage),Handlebars.registerHelper("makePendingUserImage",function(){return new Handlebars.SafeString(TS.templates.builders.makePendingUserImage.apply(this,arguments))}),Handlebars.registerHelper("emojiGraphicReplace",function(e,n){var o={};return n&&typeof n=="string"?o.force_style=n:o.obey_emoji_mode_pref=!0,new Handlebars.SafeString(TS.emoji.graphicReplace(e,o))}),Handlebars.registerHelper("getMemberPreviewLinkImageArgs",function(e,n,o,c,v,h,u){var m;if(typeof e=="object"?m=e:m=TS.interop.members.getMemberById(e),!m||!m.profile)return"";o=o===!0,c=c===!0,v=v===!0,h=h===!0,u=typeof u=="string"?u:!1,e==="USLACKBOT"&&u&&(m=TS.utility.slackbot.getWithFeels(u));var S,b,w;switch(b="background-image: ",w=[],n){case 20:TS.environment.is_retina?S=m.profile.image_48:S=m.profile.image_24;break;case 24:TS.environment.is_retina?S=m.profile.image_48:S=m.profile.image_24;break;case 32:TS.environment.is_retina?S=m.profile.image_72:S=m.profile.image_32;break;case 36:TS.environment.is_retina?S=m.profile.image_72:S=m.profile.image_48;break;case 48:TS.environment.is_retina?S=m.profile.image_72:S=m.profile.image_48;break;case 56:TS.environment.is_retina?S=m.profile.image_192:S=m.profile.image_72;break;case 72:TS.environment.is_retina?S=m.profile.image_192:S=m.profile.image_72;break;case 192:TS.environment.is_retina?S=m.profile.image_512||m.profile.image_192:S=m.profile.image_192;break;case 512:TS.environment.is_retina?S=m.profile.image_1024||m.profile.image_512||m.profile.image_192:S=m.profile.image_512||m.profile.image_192;break;default:TS.environment.is_retina?S=m.profile.image_72:S=m.profile.image_48;break}if(w.push(`url('${S}')`),n===512){var x=TS.environment.is_retina?m.profile.image_72:m.profile.image_48;w.push(`url('${x}')`)}o?b=w.length?w.join(", "):"":b=w.length?b+w.join(", "):"";var U={omit_link:c,omit_badge:v,lazy:o,member:m,size:n,include_restricted_overlay:!h||!0,bg_img_style:b};return U}),Handlebars.registerHelper("getGuestBadgeSize",function(e){var n;switch(e){case 24:n=10;break;case 32:case 36:case 48:n=16;break;case 72:n=24;break;case 192:n=48;break;case 512:n=96;break;default:n=16}return n}),Handlebars.registerHelper("getTeamBadgeSize",f),Handlebars.registerHelper("getMemberNameById",function(e){var n=TS.interop.members.getMemberById(e);return n?n.name:e}),Handlebars.registerHelper("getPrefCompliantMemberNameById",function(e){return TS.interop.rules.members.getPrefCompliantMemberNameById(e)}),Handlebars.registerHelper("getMemberComponentPrimaryName",function(e,n){return n?n==="real_name"?TS.interop.rules.members.getMemberRealName(e):TS.getMemberMentionName(e):TS.interop.rules.members.getPrefCompliantMemberName(e,!1,!1)}),Handlebars.registerHelper("memberIsInvited",function(e,n){return e&&e.is_invited_user?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("memberComponentHasSecondaryName",function(e,n,o){var c=!1;return e&&(n?n==="real_name"?c=!!TS.interop.rules.members.getMemberProfileFieldDisplayName(e):c=!!TS.interop.rules.members.getMemberRealName(e):c=!!TS.interop.rules.members.getMemberSecondaryName(e)),c&&!e.is_invited_user?o.fn(this):o.inverse(this)}),Handlebars.registerHelper("getMemberComponentSecondaryName",function(e,n){if(n){if(n==="real_name")return TS.interop.rules.members.getMemberProfileFieldDisplayName(e);if(n==="display_name")return TS.interop.rules.members.getMemberProfileFieldDisplayName(e)?TS.interop.rules.members.getMemberRealName(e):""}return TS.interop.rules.members.getMemberSecondaryName(e)}),Handlebars.registerHelper("getPrefCompliantMemberName",function(e,n,o){return TS.interop.rules.members.getPrefCompliantMemberName(e,n===!0,o===!0)}),Handlebars.registerHelper("getMemberAsContentsString",function(e){return TS.interop.texty.getMemberAsContentsString(e)}),Handlebars.registerHelper("getTeamById",function(e){return TS.teams.getTeamById(e)}),Handlebars.registerHelper("getTeamDisplayName",function(e){return TS.interop.rules.teams.isUnknown(e)?new Handlebars.SafeString(TS.templates.unknown_team({id:e.id})):TS.interop.rules.teams.getTeamDisplayName(e)}),Handlebars.registerHelper("getMemberPreviewLinkTarget",function(e){return TS.utility.shouldLinksHaveTargets()?new Handlebars.SafeString(`target="/team/${e.id}"`):""}),Handlebars.registerHelper("getMemberProfileFieldDisplayName",function(e){return TS.interop.rules.members.getMemberProfileFieldDisplayName(e)}),Handlebars.registerHelper("getMemberSecondaryName",function(e){return TS.interop.rules.members.getMemberSecondaryName(e)}),Handlebars.registerHelper("getMemberProfileFieldDisplayName",function(e){return TS.interop.rules.members.getMemberProfileFieldDisplayName(e)}),Handlebars.registerHelper("getMemberRealName",function(e){return TS.interop.rules.members.getMemberRealName(e)}),Handlebars.registerHelper("getMemberProfileFieldDisplayNameandRealNameInCorrectOrder",function(e){var n=_.escape(TS.interop.rules.members.getPrefCompliantMemberName(e)),o;e.is_self?o=TS.interop.i18n.t("(you)","templates_helpers")():o=_.escape(TS.interop.rules.members.getMemberSecondaryName(e));var c=`<span class="member_real_name">${n}</span>`,v=`<span class="member_preferred_name">${o}</span>`;return new Handlebars.SafeString(c+v)}),Handlebars.registerHelper("memberHasIm",function(e){var n=e.hash.member,o=!1;return n&&TS.redux.channels.getImByMemberId(n.id)&&(o=!0),o?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("memberHasImUnreadCount",function(e){var n=e.hash.member,o=!1;if(n){var c=TS.redux.channels.getImByMemberId(n.id);c&&c.unread_cnt&&(o=!0)}return o?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("getUnreadCountForIMByMemberId",function(e){var n=TS.redux.channels.getImByMemberId(e);return n?n.unread_cnt:""}),Handlebars.registerHelper("makeMemberLinksWithDisplayNames",function(e){if(!e)return"";var n=e.split(/\s*,\s*/).map(function(o){return TS.templates.builders.makeMemberPreviewLink(TS.interop.members.getMemberById(o))}).join(", ");return new Handlebars.SafeString(n)});function i(e){var n=TS.interop.members.getMemberById(e.user);if(!n)return TS.warn(`Missing member in makeIMLink: ${e.user}`),TS.templates.search_im_link({im_exists:!1,im_member_id:e.user,im_name:e.user,im_id:e.id,member_color:"unknown"});var o={im_exists:!TS.interop.rules.channels.isImWithDeletedMember(e),im_member_id:n.id,im_name:TS.ims.getDisplayNameOfUserForIm(e),im_id:e.id,member_color:`color_${n?`${n.id} color_${n.color}`:"unknown"}`};if(TS.utility.shouldLinksHaveTargets()){var c=`/messages/${e.id}`;TS.interop.rules.channels.isImWithDeletedMember(e)&&(c=TS.templates.builders.newWindowName()),o.target=c}return TS.templates.search_im_link(o)}d(i,"makeIMLink"),Handlebars.registerHelper("makeIMLink",function(e){return new Handlebars.SafeString(i(e))}),Handlebars.registerHelper("getBotName",TS.templates.builders.getBotName);function l(e){var n=TS.interop.members.getMemberById(e);return n?`color_${n.id} color_${n.color}`:"color_unknown"}d(l,"getMemberColorClassById"),Handlebars.registerHelper("getMemberColorClassById",l),Handlebars.registerHelper("memberIsAdmin",function(e){var n=TS.interop.members.getMemberById(e.hash.id);return n?n.is_admin?e.fn(this):e.inverse(this):e.inverse(this)}),Handlebars.registerHelper("currentUserIsAdmin",function(e){return TS.model.user.is_admin?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("currentUserIsOwner",function(e){return TS.model.user.is_owner?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("tinyspeck",function(e){return TS.boot_data.feature_tinyspeck?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("fileIsImage",function(e){var n=TS.files.getFileById(e.hash.id);return n?n.mimetype&&n.mimetype.indexOf("image/")===0?e.fn(this):e.inverse(this):e.inverse(this)}),Handlebars.registerHelper("mimeTypeIsImage",function(e){return e.hash.type&&e.hash.type.indexOf("image/")===0?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("nonImageCanUseFSFV",function(e,n){return TS.files.nonImageCanUseFSFV(e)?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("makeFilePrivacyLabel",function(e){var n="",o=e.is_public,c=e.groups.length>0||e.ims.length>0,v=e.mode==="email",h=e.mode==="snippet",u=e.mode!="post"&&e.mode!="space"&&!v&&!h;return e.mode==="post"||e.mode==="space"?o?n=TS.interop.i18n.t("Shared","templates_helpers")():c?n=TS.interop.i18n.t("Private","templates_helpers")():n=TS.interop.i18n.t("Draft","templates_helpers")():o&&v?n=TS.interop.i18n.t("Shared email","templates_helpers")():o&&h?n=TS.interop.i18n.t("Shared snippet","templates_helpers")():o&&u?n=TS.interop.i18n.t("Shared file","templates_helpers")():c&&v?n=TS.interop.i18n.t("Private email","templates_helpers")():c&&h?n=TS.interop.i18n.t("Private snippet","templates_helpers")():c&&u&&(n=TS.interop.i18n.t("Private file","templates_helpers")()),n}),Handlebars.registerHelper("isFileAuthorExternal",function(e){return TS.files.isFileAuthorExternal(e)}),Handlebars.registerHelper("maybeGetIconForTeamProfileField",function(e){var n=["slack","apple","android","twitter","github","google","windows","youtube","skype","facebook","asana","linkedin","tumblr","instagram","soundcloud","flickr","pinterest","tripit","hangouts","viber","line"];if(e=e.toLowerCase(),n.indexOf(e)>-1)return`<i class="ts_icon ts_icon_${e}"></i>`}),Handlebars.registerHelper("isSkypeTeamProfileField",function(e,n){return e.type==="text"&&e.label.toLocaleLowerCase()==="skype"?n.fn(this):n.inverse(this)}),Handlebars.registerHelper("getSafeSkypeURLComponent",function(e){var n=e.match(/^[a-zA-Z][a-zA-Z0-9.,\-_@]{5,31}/);return n?n[0]:""}),Handlebars.registerHelper("math",function(e,n,o){return arguments.length<4&&(o=n,n="+"),e=parseFloat(e),o=parseFloat(o),{"+":e+o,"-":e-o,"*":e*o,"/":e/o,"%":e%o}[n]}),Handlebars.registerHelper("loadingHTML",function(){return new Handlebars.SafeString(TS.templates.builders.loadingHTML())}),Handlebars.registerHelper("versioned_loading_animation",function(){return cdn_url+"/80588/img/loading.gif"}),Handlebars.registerHelper("versioned_loading_hash_animation",function(){return cdn_url+"/80588/img/loading_hash_animation_@2x_vogue.gif"}),Handlebars.registerHelper("versioned_upload_file_icon",function(e){if(e==="1x")return cdn_url+"/80588/img/upload_file_icon.png";if(e==="2x")return cdn_url+"/80588/img/upload_file_icon@2x.png"}),Handlebars.registerHelper("versioned_default_application_icon",function(){return cdn_url+"/80588/img/apps/default_new_app_icon.png"}),Handlebars.registerHelper("versioned_tos_book_illustration",function(e){if(e==="1x")return cdn_url+"/80588/img/signup/book_illustration.png";if(e==="2x")return cdn_url+"/80588/img/signup/book_illustration@2x.png"}),Handlebars.registerHelper("versioned_basic_analytics_upsell_banner_image",function(){return cdn_url+"/80588/img/enterprise/ent_basic_analytics_upsell_banner_image.gif"}),Handlebars.registerHelper("number",function(e){return _.isUndefined(e)?"":TS.interop.i18n.number(e)||""}),Handlebars.registerHelper("atLabel",function(e){return TS.templates.builders.atLabel(e)}),Handlebars.registerHelper("getMemberTypeClass",TS.templates.builders.getMemberTypeClass),Handlebars.registerHelper("dangerouslyRenderHTML",function(e){return new Handlebars.SafeString(e)}),Handlebars.registerHelper("getTeamIconOfSize",function(e,n){return e&&e.icon?e.icon[`image_${n}`]:null}),Handlebars.registerHelper("listItemCount",function(e){return _.isUndefined(e)?(TS.error("The template helper listItemCount failed because it was passed undefined"),0):(e=TS.utility.parseJSONOrElse(e,e),_.isString(e)&&e.length?e.split(",").length:e.length)}),Handlebars.registerHelper("getIconSizeToFit",function(e){return TS.interop.utility.getIconSizeToFit(e,[230,132,102,88,68,44,34])}),Handlebars.registerHelper("teamRetentionDuration",function(e){return e&&TS.interop.rules.channels.isPrivateChannel(e)?TS.prefs.getTeamPref("group_retention_duration"):TS.prefs.getTeamPref("retention_duration")}),Handlebars.registerHelper("teamRetentionType",function(e){return e&&TS.interop.rules.channels.isPrivateChannel(e)?TS.prefs.getTeamPref("group_retention_type"):TS.prefs.getTeamPref("retention_type")}),Handlebars.registerHelper("escape",function(e){return _.escape(e)})},test:function(){return{_optionsFnInverseBooleanHelper:a,_inlineImgSrcForFile:t}}});var a=d(function(i){return typeof i.fn!="function"&&(i.fn=function(){return!0}),typeof i.inverse!="function"&&(i.inverse=function(){return!1}),i},"_optionsFnInverseBooleanHelper"),t=d(function(i,l){return typeof i=="string"&&(i=TS.files.getFileById(i)),!i||!TS.files.fileIsImage(i)?!1:(l||(l=480),TS.files.getThumbSrcForFile(i,{maxSize:l}))},"_inlineImgSrcForFile"),f=d(function(i){var l;switch(i){case 32:case 36:case 48:l=16;break;case 72:l=22;break;case 192:case 512:break;default:l=16}return l},"_getTeamBadgeSize")})()},IZwQ:function(se,ae){(function(){TS.registerModule("ui.lazy_filter_select",{STYLES:{default:"default",filter_in_list:"filter_in_list",normal:"normal",small:"small"},onStart:function(){$("select[data-lazy-filter-select], label[data-lazy-filter-select] select").addClass("hidden").lazyFilterSelect({use_data_attributes:!0})},create:function(r,C){if(C.use_data_attributes){var G=Object.keys(r.data());G.forEach(function(me){if(me.indexOf("lazyFilterSelect")>-1&&me!=="TS-lazyFilterSelect"&&r.data(me)!==""){var ge=r.data(me);(ge==="true"||ge==="false")&&(ge=ge==="true"),C[me.replace("lazyFilterSelect","").toLowerCase()]=ge}})}r.prop("tagName")==="SELECT"&&typeof C.single>"u"&&(C.single=!r.prop("multiple"));var L=$.extend({},a,C);C.approx_divider_height===void 0&&(L.approx_divider_height*=1),C.approx_item_height===void 0&&(L.approx_item_height*=1);var X=$('<div class="lazy_filter_select">');L.classes&&X.addClass(L.classes),r.prop("disabled")&&(L.disabled=!0),L.disabled&&X.addClass("disabled"),L.style=_.get(TS.ui.lazy_filter_select.STYLES,L.style,TS.ui.lazy_filter_select.STYLES.default),I(L)&&!L.single&&(TS.warn("Multi-select lazyFilterSelect instances can't use the 'filter_in_list' style. Using 'default' style instead."),L.style=TS.ui.lazy_filter_select.default);var le=TS.templates.lazy_filter_select_container({instance:L,aria_labelledby:r.attr("aria-labelledby"),STYLES:TS.ui.lazy_filter_select.STYLES});return X.html(le),L.append?X.appendTo(r):X.insertAfter(r),X.addClass(`${L.style}_style`),L.single&&(X.addClass("single"),X.attr("tabindex",0)),L.width&&X.css("width",L.width),L.css&&X.css(L.css),L.$container=X,L.$select=r,L.$input_container=X.find(".lfs_input_container"),L.$lfs_value=X.find(".lfs_value"),L.$input=X.find(".lfs_input"),L.$list_container=X.find(".lfs_list_container"),L.$list=X.find(".lfs_list"),L.$status=X.find(".lfs_status"),L.$status_loading_indicator=L.$status.find(".lfs_status_loading_indicator"),L.$status_content=L.$status.find(".lfs_status_content"),I(L)?L.$filter_input=X.find(".lfs_filter_input"):L.$filter_input=L.$input,L._page_number=1,L._slug_id_counter=1,L.run=Y,L.data_promise?(R(L)&&L._running_promise.cancel("Uhhh..."),L._running_promise=B(L,"").then(function(me){L.data=me,L.run(),l(L)},function(me){l(L),TS.interop.utility.getLogger({getState:TS.redux.getState}).error(me,"LFS error"),ie(L,me,"Something failed while trying to return the initial data for lazyFilterSelect.")})):(L.data&&(L.data=L.data.slice()),_.forEach(L.data,function(me,ge,ve){me&&me._is_interop_channel_object&&(ve[ge]=_.assign({},me))}),L.run(),l(L)),L.current_items_in_view_signal=new signals.Signal,L},is_list_open:!1});var a={allow_item_unselect:!1,allow_list_position_above:!1,always_visible:!1,append:!1,approx_divider_height:28,approx_item_height:30,data_promise:null,data_qa:"lfs",disabled:!1,filter:function(r,C){var G=r.toString();if(C=C.toLowerCase(),r instanceof jQuery||r instanceof HTMLElement){G=$(r).text();var L=$(r).attr("data-additional-search-field");if(L&&L.toLowerCase().indexOf(C)>-1)return!0}return G.toLowerCase().indexOf(C)>-1},input_debounce_wait_time:void 0,listItemClass:null,max_selected_items:1/0,min_query_length:0,monkey_scroll:!0,no_default_selection:!1,noResultsTemplate:function(r){return H(this)&&r.length<this.min_query_length?TS.interop.i18n.t("{query_length, plural, =0 {Start typing to see results\u2026} other {Keep typing to see results\u2026}}","lazy_filter_select")({query_length:r.length}):TS.interop.i18n.t("No items matched {query}","lazy_filter_select")({query:TS.interop.i18n.safeString(`<strong>${_.escape(r)}</strong>`)})},errorTemplate:function(r){return r||TS.interop.i18n.t("Couldn't load results.","lazy_filter_select")()},onInputBlur:_.noop,onInputFocus:_.noop,onReady:function(){},onItemAdded:function(){},onItemRemoved:function(){},onKeyDown:function(){},onMaxItemsSelected:function(){},onListShown:_.noop,onListHidden:_.noop,adjustAvailableSpaceAbove:_.identity,adjustAvailableSpaceBelow:_.identity,placeholder_text:TS.interop.i18n.t("Choose an option\u2026","lazy_filter_select")(),filter_placeholder_text:TS.interop.i18n.t("Search","lazy_filter_select")(),renderDividerFunc:null,render_item_func:null,restrict_input_container_height:!1,restrict_preselected_item_removal:!1,scroll_threshold:1e3,set_height:!0,single:!1,sluggify:{enabled:!1,delimiter:null,key_name:null,validator:null},style:TS.ui.lazy_filter_select.STYLES.default,template:function(r){var C=r.toString(),G,L;return(r instanceof jQuery||r instanceof HTMLElement)&&(C=$(r).text(),G=N($(r).attr("data-additional-search-field"),this),L=N($(r).attr("data-ts-icon"),this)),C=N(C,this),G&&(C+=` <span class="addl_text">${G}</span>`),L&&(C+=` <ts-icon class="addl_icon ${L}"></ts-icon>`),new Handlebars.SafeString(C)},tokenClass:null,tokenTemplate:null,tokenTemplateSingle:null,use_data_attributes:!1,_$active:null,_all_done_fetching:!1,_list_built:!1,_list_visible:!1,_mouse:{},_page_number:1,_prevent_blur:!1,_previous_val:"",_running_promise:null,_scroll_callback_was_called:!1,_selected:[],_showing_status:!1};$.widget("TS.lazyFilterSelect",{_create:function(){this.instance=TS.ui.lazy_filter_select.create(this.element,this.options)},_destroy:function(){this.instance.$container.remove(),delete this.instance},blur:function(){this.instance.$filter_input.blur()},clearValue:function(){if(this.instance.single){if(this.instance._selected.length){var r=this.instance.$input_container.find(".lfs_item");oe(this.instance,r)}}else q(this.instance)},container:function(){return this.instance.$container},disable:function(){u(this.instance)},disabled:function(){return this.instance.disabled},enable:function(){S(this.instance)},focus:function(){this.instance.$filter_input.focus()},getInstance:function(){return this.instance},hideList:function(){ee(this.instance,{force:!0}),Se(this.instance)},recomputeHeight:function(){_e(this.instance)},setValue:function(r,C){var G=this.element[0].selectedIndex;this.element.val(r),this.element[0].selectedIndex<0&&(this.element[0].selectedIndex=0);var L=this.element[0].options[this.element[0].selectedIndex];if(this.instance.single){if(this.element[0].selectedIndex==G&&!C)return}else q(this.instance);var X=x(this.instance,$(L));k(this.instance,X)},forceSelectItem:function(r){this.instance.$lfs_value.html(e(this.instance,r,{force_selected:!0})),this.instance.$container.addClass("value")},showList:function(){Q(this.instance)},update:function(r){ue(this.instance,r)},updatePlaceholder:function(r){this.instance.placeholder_text=r,this.instance.$input.prop("placeholder",r)},updateFilterPlaceholder:function(r){I(this.instance)&&(this.instance.filter_placeholder_text=r,this.instance.$filter_input.prop("placeholder",r))},value:function(){return this.instance._selected}});var t=d(function(r,C){if(F(r)&&C.trim()&&h(r)){var G={};G[r.sluggify.key_name]=C.trim(),G.lfs_id=null,G.lfs_slug_id=r._slug_id_counter,r._slug_id_counter+=1,r._selected.push(G);var L=TS.templates.lazy_filter_select_item({content:r.tokenTemplate(G),applied_classes:"lfs_token",slug_id:G.lfs_slug_id,data_qa:r.data_qa}).replace(/(\r\n|\n|\r)/gm,""),X=$(L);X.insertBefore(r.$input),r.sluggify.validator&&r.sluggify.validator(X),A(r,r.data),Q(r),r.$filter_input.val(""),r._previous_val="",f(r),r.onItemAdded(G),h(r)||r.onMaxItemsSelected()}},"_addUserCreatedSlugFromString"),f=d(function(r){r.single||(r.$input.prop("size",r.$filter_input.val().length+1),r.$filter_input.val().length+r._selected.length===0?V(r):(r.$input_container.removeClass("empty"),r.$input_container.removeClass("error"),p(r)))},"_adjustInput"),i=d(function(r){r.data_promise&&r.$list.on("scroll",function(){var C=$(this).scrollTop(),G=r.$list.height(),L=r.$list.find(".list_items").height(),X=L-C-G;X<=r.scroll_threshold&&!r._scroll_callback_was_called&&!r._all_done_fetching?(v(r,r._previous_val,r._page_number+1),r._scroll_callback_was_called=!0):X>r.scroll_threshold&&r._scroll_callback_was_called&&(R(r)&&r._running_promise.cancel("User scrolled back and we do not need to add more data"),r._scroll_callback_was_called=!1)})},"_bindListListeners"),l=d(function(r){r.$container.on("mouseleave",Ee.bind(null,r)),r.$container.on("click",ye.bind(null,r)),r.$container.parents("label").on("click",ke.bind(null,r)),r.$container.on("keydown",Be.bind(null,r)),r.$input_container.on("focus",Ue.bind(null,r)),r.$input.on("focus",Me.bind(null,r));var C;_.isUndefined(r.input_debounce_wait_time)?C=xe:C=_.debounce(xe,r.input_debounce_wait_time),r.$filter_input.on("input",C.bind(null,r)),r.$filter_input.on("keydown",Ie.bind(null,r)),r.$filter_input.on("blur",Ne.bind(null,r)),r.$lfs_value.on("click",Ae.bind(null,r)),r.$lfs_value.on("mousedown",We.bind(null,r)),r.$input_container.on("click",".lfs_token",De.bind(null,r)),r.$input_container.on("mousedown",".lfs_token",Ke.bind(null,r)),r.$list_container.on("mousedown",Fe.bind(null,r)),r.$list_container.on("mouseup",Ge.bind(null,r)),r.$list_container.on("mousemove",".lfs_item",Re.bind(null,r)),r.$list_container.on("mouseleave",".lfs_item.active",Ve.bind(null,r)),r.$list_container.on("click",".lfs_item",He.bind(null,r)),r.onReady()},"_bindUI"),e=d(function(r,C,G){var L=$(C);G=G||{};var X=G.force_selected||y(r,C),le=C.disabled||C.lfs_disabled;r.restrict_preselected_item_removal&&C.preselected&&(le=!0);var me;G.should_tokenize&&_.isFunction(r.tokenTemplate)?me=r.tokenTemplate(C):r.single&&_.isFunction(r.tokenTemplateSingle)?me=r.tokenTemplateSingle(C):me=r.template(C);var ge=N(L.data("lfs-item-desc"),r),ve={active:r._previous_val!==""&&!X&&!le,disabled:le,lfs_token:G.should_tokenize,selected:X,single:r.single,group_item:L.hasClass("group_item")};return _.isFunction(r.tokenClass)&&(ve[r.tokenClass(C)]=!0),TS.templates.lazy_filter_select_item({content:me,icon:L.data("lfs-item-icon"),desc:new Handlebars.SafeString(ge),applied_classes:TS.utility.getAppliedClasses(ve),lfs_id:C.lfs_id,data_qa:r.data_qa}).replace(/(\r\n|\n|\r)/gm,"")},"_buildItem"),n="position_above",o="show_status",c=d(function(r){if(!(!r._list_built&&!r._showing_status)){r.$list_container.removeClass(n);var C=r.$list.css("max-height");r.$list.css({"max-height":0});var G=r.$list[0].scrollHeight,L=parseInt(r.$list_container.css("padding-top"),10)+parseInt(r.$list_container.css("padding-bottom"),10)+parseInt(r.$list_container.css("border-top-width"),10)+parseInt(r.$list_container.css("border-bottom-width"),10)+parseInt(r.$list_container.css("margin-top"),10)+parseInt(r.$list_container.css("margin-bottom"),10);I(r)&&(L+=r.$filter_input.outerHeight()+parseInt(r.$filter_input.css("margin-bottom"),10));var X=parseInt(r.$list_container.css("max-height"),10),le=2*r.approx_item_height+L,me=Math.min(G+L,X),ge=$(window).height(),ve=r.$input_container[0].getBoundingClientRect().bottom+parseInt(r.$input_container.css("margin-bottom"),10),Te=r.adjustAvailableSpaceBelow(ge-ve);if(r.allow_list_position_above){var $e=r.$input_container[0].getBoundingClientRect().top+parseInt(r.$input_container.css("margin-top"),10),be=r.adjustAvailableSpaceAbove($e),Pe=be>=me,we=Te>=me&&Te>le;Pe&&!we&&(Te=be,r.$list_container.addClass(n))}var Ce=Math.floor(Math.min(Te,me)-L);r.$list.css({"max-height":Ce||C})}},"_sizeAndPositionItemsList"),v=d(function(r,C,G){R(r)&&r._running_promise.cancel("Scrolling happened"),!r._all_done_fetching&&(r._running_promise=r.data_promise(C,G).then(function(L){var X=L;if(X.items&&(X=X.items),X&&X.length){r._page_number+=1,r._current_data||(r._current_data=r.data.slice()),typeof L.all_items_fetched<"u"&&(r._all_done_fetching=!!L.all_items_fetched),typeof L.num_remaining<"u"&&L.num_remaining===0&&(r._all_done_fetching=!0);var le,me=parseInt(L.num_new,10)||0;le=X.slice(-me),le.length?(L._replace_all_items||L.replace_all_items?r._current_data=le:r._current_data=r._current_data.concat(le),m(r,r._current_data)):r._all_done_fetching=!0}else r._all_done_fetching=!0},function(L){TS.interop.utility.getLogger({getState:TS.redux.getState}).error(L,"LFS error"),ie(r,L,"Something failed while trying to return the next batch of data for lazyFilterSelect.")}))},"_callScrollCallback"),h=d(function(r){return r._selected.length<r.max_selected_items},"_canAddNewItem"),u=d(function(r){r.disabled||(r.disabled=!0,r.$container.addClass("disabled"),r.$input.prop("disabled",!0),r.$filter_input.prop("disabled",!0))},"_disable"),m=d(function(r,C){Z(r,C),A(r,C);var G=r._list_built&&(!r.data||r.data.length===0||r.always_visible);G&&Q(r,!0),f(r)},"_doAllTheThingsRequiredWithNewData"),S=d(function(r){r.disabled&&(r.disabled=!1,r.$container.removeClass("disabled"),r.$input.prop("disabled",!1),r.$filter_input.prop("disabled",!1))},"_enable"),b=d(function(r,C){for(var G=r.data,L=[],X=0;X<G.length;X+=1){var le=G[X];if(le.lfs_group||le.is_divider){for(var me=[],ge=0;ge<le.children.length;ge+=1){var ve=le.children[ge];r.filter(ve,C)&&me.push(ve)}me.length>0&&L.push({is_divider:!0,lfs_group:!0,label:le.label,children:me})}else r.filter(le,C)&&L.push(le)}return L},"_filterGroup"),w=d(function(r){return r.attr("data-lfs-id")||r.prop("lfs_id")||null},"_getLfsId"),x=d(function(r,C,G){var L=w(C),X;if(G)X=r._selected;else if(X=r.data_promise&&r._current_data?r._current_data:r.data,L.indexOf(".")!==-1){var le=parseInt(L.split(".")[0],10);X=X[le]?X[le].children:X[0].children}var me=X.filter(function(ge){return ge.lfs_id===L});return me.length?me[0]:null},"_getData"),U=d(function(r,C){var G=parseInt(C.attr("data-lfs-slug-id"),10),L=r._selected,X=L.filter(function(le){return le.lfs_slug_id===G});return X.length?X[0]:null},"_getUserCreatedSlugData"),ee=d(function(r,C){C=C||{};var G=!r._list_visible||r.always_visible||r.disabled;G&&!C.force||(r._list_visible=!1,r.$list_container.removeClass("visible"),r.$container.removeClass("list_visible"),r.$input_container.removeClass("active"),r._list_built&&r.$list.longListView("setHidden",!0),r._$active=null,r.onListHidden())},"_hideList"),F=d(function(r){return r.sluggify.enabled?r.sluggify.delimiter?r.sluggify.key_name?r.single?(TS.error("Sluggify only works in multi-select versions of lazyFilterSelect."),!1):!0:(TS.error("You must pass a key name to use sluggify with lazyFilterSelect."),!1):(TS.error("You must pass a delimiter regular expression to use sluggify with lazyFilterSelect."),!1):!1},"_instanceCanSluggify"),y=d(function(r,C){if(!r._selected.length)return!1;var G=r._selected.filter(function(L){return L.lfs_id===C.lfs_id});return!!G.length},"_isAlreadySelected"),T=d(function(r){return r instanceof jQuery?!!r.attr("data-lfs-slug-id"):r.lfs_slug_id!==void 0},"_itemIsUserCreatedSlug"),s=d(function(r,C,G){if(F(r)&&T(C)){var L=$(C),X=N(L.data("lfs-item-desc"),r);r._slug_id_counter=Math.max(C.lfs_slug_id,r._slug_id_counter)+1,r._selected.push(C);var le,me=TS.templates.lazy_filter_select_item({content:r.tokenTemplate(C),icon:L.data("lfs-item-icon"),desc:new Handlebars.SafeString(X),applied_classes:"lfs_token",slug_id:C.lfs_slug_id,data_qa:r.data_qa}).replace(/(\r\n|\n|\r)/gm,"");return le=$(me),le.insertBefore(r.$input),f(r),r.sluggify.validator&&r.sluggify.validator(le),r.data=G.filter(function(ge){return ge.lfs_slug_id!==C.lfs_slug_id}),r.data}},"_loadSlugAndRemoveFromData"),g=d(function(r){var C=r.children("option, optgroup"),G=C.length>0?[]:void 0;return C.each(function(){if($(this).prop("tagName")==="OPTGROUP"){var L=$(this).children("option").toArray();$(this).prop("disabled")&&(L=L.map(function(X){return X.lfs_disabled=!0,X})),G.push({is_divider:!0,lfs_group:!0,label:$(this).prop("label"),children:L})}else G.push(this)}),G},"_parseHTMLOptionData"),A=d(function(r,C){if(C||(C=r.data),!C){ie(r);return}if(C.length===0){re(r);return}if(Se(r,{keep_input_active:!0}),!r._list_built)(!r.data||r.data.length===0)&&(r.data=C),K(r);else{var G=j(C);r.$list.longListView("setItems",G,!0),r._current_data=C,_e(r)}c(r)},"_populate"),j=d(function(r){var C=[];return r.forEach(function(G){if(C.push(G),G.children&&G.children.length)for(var L=0;L<G.children.length;L+=1)C.push(G.children[L])}),C},"_preLongListViewPrep"),Z=d(function(r,C){if(C||(C=r.data),!!C){for(var G="",L=!r.single,X=0;X<C.length;){var le=C[X];if(T(le)){C=s(r,le,C);continue}if(le.children&&le.children.length&&(le.lfs_group=!0),le.lfs_group||le.is_divider){le.is_divider=!0;for(var me=X,ge=0;ge<le.children.length;ge+=1){var ve=le.children[ge];if(ve.lfs_id=ve.lfs_id||`${me}.${ge}`,(ve.selected||ve.preselected)&&r.no_default_selection===!1){if(r.single&&r._selected.length>0||y(r,ve))continue;r._selected.push(ve),G+=e(r,ve,{should_tokenize:L})}}}else if(le.lfs_id=le.lfs_id||String(X),(le.selected||le.preselected)&&r.no_default_selection===!1){if(r.single&&r._selected.length>0||y(r,le)){X+=1;continue}r._selected.push(le),G+=e(r,le,{should_tokenize:L})}X+=1}G.length>0&&(r.$container.addClass("value"),r.single?r.$lfs_value.html(G):($(G).insertBefore(r.$input),r.$input_container.removeClass("empty"),r.$input_container.removeClass("error"),p(r)))}},"_prepItems"),q=d(function(r){for(;r.$input_container.find(".lfs_token").length>0;)ne(r)},"_removeAllSelected"),ne=d(function(r){var C=r.$input_container.find(".lfs_token").last();C.length&&oe(r,C)},"_removeLastSelected"),oe=d(function(r,C){if(!r.disabled){if(T(C)){D(r,C);return}var G=x(r,C,!0);if(!(G.disabled||r.restrict_preselected_item_removal&&G.preselected)){r._selected=r._selected.filter(function(X){return X!==G});var L=r.$list.find(`[data-lfs-id="${G.lfs_id}"]`);L.removeClass("selected"),C.remove(),he(r),r.$filter_input.val().length+r._selected.length===0&&V(r),r._selected.length===0&&r.$container.removeClass("value"),r.onItemRemoved(G)}}},"_removeSelected"),D=d(function(r,C){if(F(r)){var G=U(r,C);r._selected=r._selected.filter(function(L){return L!==G}),C.remove(),he(r),r.$filter_input.val().length+r._selected.length===0&&V(r),r.onItemRemoved(G)}},"_removeUserCreatedSlug"),Y=d(function(){this.data&&this.data.length===0&&TS.warn("Data passed to lazyFilterSelect is empty."),ue(this,this.data),this.always_visible&&Q(this),this.restrict_input_container_height&&(this.$container.addClass("has_restricted_input_container_height"),TS.environment.supports_custom_scrollbar||this.$input_container.monkeyScroll())},"_run"),J=d(function(r,C,G){if(!r.disabled&&C!==r._previous_val)if(r._all_done_fetching=!1,r._previous_val=C,r._$active=null,f(r),r._page_number=1,r._list_built&&r.$list.longListView("scrollToTop",!0),r.data_promise)R(r)&&r._running_promise.cancel("User entered more text"),r._running_promise=B(r,C).then(function(X){m(r,X),Q(r,G)},function(X){TS.interop.utility.getLogger({getState:TS.redux.getState}).error(X,"LFS error"),ie(r,X,"Something failed while trying to return the filtered data for lazyFilterSelect.")});else{Q(r,G);var L=b(r,C);A(r,L),f(r)}},"_runQuery"),B=d(function(r,C){return new Promise(function(G,L){C.length<r.min_query_length?(r._all_done_fetching=!0,G([])):(_.delay(function(){R(r)&&ce(r)},650),r.data_promise(C).then(function(X){X=X||{},_.isUndefined(X.all_items_fetched)||(r._all_done_fetching=!!X.all_items_fetched),X.num_remaining===0&&(r._all_done_fetching=!0);var le=(X.items||X).slice();G(le),Se(r,{keep_input_active:!0})},function(X){L(X),Se(r)}))})},"_runDataPromiseQuery"),R=d(function(r){return r._running_promise&&r._running_promise.isPending()},"_isRunningPromisePending"),M=d(function(r,C){if(!r.disabled){if(!r._list_visible){Q(r);return}var G;r._$active?G=r._$active[C](".lfs_item:not(.disabled, .hidden)").first():G=r.$list.find(".lfs_item:not(.disabled, .hidden)").first(),G.length&&(G.scrollintoview({duration:0}),r._$active&&r._$active.removeClass("active"),G.addClass("active"),r._$active=G)}},"_select"),E=d(function(r){return!(r.hasClass("selected")||r.hasClass("disabled"))},"_selectable"),k=d(function(r,C){if(h(r)){if(r.single&&r._selected.length){var G=r.$list.find(`[data-lfs-id="${r._selected[0].lfs_id}"]`);G.removeClass("selected"),r._selected.length=0,r.$lfs_value.empty()}r._selected.push(C),he(r);var L=$(e(r,C,{should_tokenize:!r.single}));_.isFunction(r.tokenClass)&&L.addClass(r.tokenClass(C)),r.single?r.$lfs_value.html(L):(L.addClass("lfs_token"),L.insertBefore(r.$input)),r.single||(r.$input_container.removeClass("empty"),r.$input_container.removeClass("error"),p(r)),r.$container.addClass("value"),r.onItemAdded(C),h(r)||r.onMaxItemsSelected(),r.single||r.$filter_input.focus()}},"_selectDataItem"),O=d(function(r){return M(r,"nextAll")},"_selectDown"),z=d(function(r){if(!r.disabled){var C=r._$active;if(C.length&&E(C)&&h(r)){C.addClass("selected"),C.removeClass("active"),r._$active=null;var G=x(r,C);k(r,G)}}},"_selectListItem"),W=d(function(r){return M(r,"prevAll")},"_selectUp"),V=d(function(r){r.$input_container.addClass("empty"),P(r)},"_showEmptyState"),Q=d(function(r,C){r.disabled||(TS.utility.rAF(function(){r.$filter_input.focus()}),!r._list_visible&&(r._showing_status&&r.always_visible||(r._list_built||K(r),(r._list_built||r._showing_status)&&(r._list_visible=!0,r.$list_container.addClass("visible"),r.$container.addClass("list_visible"),I(r)||r.$input_container.addClass("active"),r._list_built&&r.$list.longListView("setHidden",!1)),r.single&&!C&&(r.$filter_input.val(""),r._previous_val="",r.$filter_input.focus(),H(r)&&(r.data=[]),A(r)),r.set_height&&(c(r),r.monkey_scroll&&!TS.environment.supports_custom_scrollbar&&r.$list.monkeyScroll()),r.onListShown())))},"_showList"),K=d(function(r){if(!(!r.data||r.data.length===0)){var C=j(r.data);r._list_built=!0;var G={items:C,approx_item_height:r.approx_item_height,approx_divider_height:r.approx_divider_height,preserve_dom_order:!0,calcDividerHeight:function(L){return L.outerHeight()},makeDivider:function(){return $('<div class="lfs_group"></div>')},makeElement:function(){return $(TS.templates.lazy_filter_select_item().replace(/(\r\n|\n|\r)/gm,""))},renderDivider:function(L,X,le){if(r.renderDividerFunc)return r.renderDividerFunc(L,X,le);L.html(N(X.label,r))},renderItem:function(L,X,le){if(r.render_item_func)return r.render_item_func(L,X,le);var me=$(X),ge="active selected disabled single group_item lfs_token",ve={disabled:X.disabled||X.lfs_disabled,selected:y(r,X),single:r.single,group_item:me.hasClass("group_item")};_.isFunction(r.listItemClass)&&(ve[r.listItemClass(X)]=!0);var Te=TS.utility.getAppliedClasses(ve),$e={"data-qa":`${r.data_qa}-item-${X.lfs_id}`,"data-lfs-id":X.lfs_id,title:X.title};if(L.attr($e).removeClass(ge).addClass(Te).html(r.template(X).string),me.data("lfs-item-icon")){var be=`url(${me.data("lfs-item-icon")})`,Pe=$('<span class="lfs_item_icon">').css("background-image",be);L.prepend(Pe)}if(me.data("lfs-item-desc")){var we=N(me.data("lfs-item-desc"),r),Ce=$('<span class="lfs_item_desc">').html(we);L.append(Ce)}}};r.$list.longListView(G),i(r),r.$list_items=r.$container.find(".list_items"),TS.utility.rAF(function(){r.monkey_scroll&&!TS.environment.supports_custom_scrollbar&&r.$list.monkeyScroll(),r.$list.longListView("resizeImmediately"),TS.utility.rAF(function(){r.current_items_in_view_signal.dispatch(r.$list.longListView("getCurrentItemsInView")||[])})}),r.$list.longListView("getCurrentItemsInViewSignal")&&r.$list.longListView("getCurrentItemsInViewSignal").add(function(L){r.current_items_in_view_signal.dispatch(L)})}},"_startListView"),te=d(function(r){r.stopPropagation(),r.preventDefault()},"_stopThePresses"),de=d(function(r,C){if(!(r.single||!r.allow_item_unselect)){var G=x(r,C,!0);C.removeClass("selected"),r._selected=r._selected.filter(function(L){return L!==G}),r.$input_container.find(`.lfs_item[data-lfs-id="${G.lfs_id}"]`).remove(),he(r),r.$filter_input.val().length+r._selected.length===0&&V(r),r._selected.length===0&&r.$container.removeClass("value"),r.onItemRemoved(G)}},"_unselectItem"),fe=d(function(r,C){if(!(!F(r)||!T(C))){var G=C.text().trim();C.length&&D(r,C),r.$filter_input.val(G),f(r),r.$filter_input.select()}},"_unsluggifySlug"),ue=d(function(r,C){if(r.data=C||g(r.$select),r.data&&(r._selected=[],Z(r),r.$filter_input.val().length)){var G=r.$filter_input.val();r._previous_val="",J(r,G)}},"_update"),_e=d(function(r){r.restrict_input_container_height&&TS.ui.utility.updateClosestMonkeyScroller(r.$input_container,!0),r.monkey_scroll&&!TS.environment.supports_custom_scrollbar&&(c(r),TS.utility.rAF(function(){TS.ui.utility.updateClosestMonkeyScroller(r.$list,!0)}))},"_updateMonkeyScroll"),he=d(function(r){if(!r.append){var C=r._selected.filter(function(G){return G instanceof HTMLOptionElement}).map(function(G){return $(G).val()});r.$select.val(C).trigger("change")}},"_updateVal"),N=d(function(r){return r=_.escape(r),r},"_formatTextForDisplay"),p=d(function(r){r.$input.attr("placeholder",""),I(r)&&r.$filter_input.attr("placeholder","")},"_clearPlaceholderText"),P=d(function(r){r.$input.attr("placeholder",r.placeholder_text),I(r)&&r.$filter_input.attr("placeholder",r.filter_placeholder_text)},"_resetPlaceholderText"),I=d(function(r){return r.style===TS.ui.lazy_filter_select.STYLES.filter_in_list},"_isFilterInListStyle"),H=d(function(r){return _.isFunction(r.data_promise)&&r.min_query_length},"_usingMinQueryLength"),ie=d(function(r,C,G){pe(r,r.errorTemplate(C),{internal_error_message:G,clear_active_items:!0})},"_showErrorStatus"),re=d(function(r){var C=r.noResultsTemplate(r.$filter_input.val());pe(r,C,{clear_active_items:!0})},"_showNoResultsStatus"),ce=d(function(r){var C=TS.interop.i18n.t("Loading results\u2026","lazy_filter_select")();pe(r,C,{show_loading_indicator:!0})},"_showLoadingStatus"),pe=d(function(r,C,G){G=G||{},r._showing_status=!0,G.internal_error_message&&TS.error(G.internal_error_message),I(r)||r.$input_container.addClass("active"),G.show_loading_indicator&&r.$status_loading_indicator.removeClass("hidden"),G.clear_active_items&&(r._$active=null),r.$status_content.html(C),r.$list_container.addClass(o)},"_showStatus"),Se=d(function(r,C){C=C||{},r._showing_status=!1,C.keep_input_active||r.$input_container.removeClass("active"),r.$status_loading_indicator.addClass("hidden"),r.$list_container.removeClass(o)},"_hideStatus"),Ee=d(function(r){r._prevent_blur=!1},"_onContainerMouseleave"),ye=d(function(r){r.disabled||Q(r)},"_onContainerClick"),Be=d(function(r,C){r.disabled||C.which!==13||Q(r)},"_onContainerKeydownEnter"),ke=d(function(r,C){r.disabled||(C.preventDefault(),Q(r))},"_onContainerParentsLabelClick"),Ue=d(function(r){r.$input_container.click(),r.$input.focus()},"_onInputContainerFocus"),Me=d(function(r){r._input_is_focused||(r._input_is_focused=!0,r.$input_container.click(),r.onInputFocus()),r.single||r.$input_container.addClass("active")},"_onInputFocus"),xe=d(function(r){var C=r.$filter_input.val();if(F(r)&&C.match(r.sluggify.delimiter)){var G=C.split(r.sluggify.delimiter);G.forEach(function(L){L.length&&t(r,L)})}else J(r,C,!0)},"_onFilterInputInput"),Ie=d(function(r,C){if(!r.disabled){switch(C.keyCode){case TS.utility.keymap.down:te(C),O(r);break;case TS.utility.keymap.up:te(C),W(r);break;case TS.utility.keymap.enter:Oe(r,C);break;case TS.utility.keymap.del:je(r,C);break;case TS.utility.keymap.tab:Le(r,C);break;case TS.utility.keymap.esc:ze(r,C);break;default:break}r.onKeyDown(C,C.isDefaultPrevented())}},"_onFilterInputKeydown"),Ne=d(function(r){r._prevent_blur||(ee(r),Se(r)),r._input_is_focused=!1,r.onInputBlur()},"_onFilterInputBlur"),Oe=d(function(r,C){if(r._$active&&r._$active.length&&r._list_visible){te(C);var G=r._$active,L=!r.single&&r.allow_item_unselect&&y(r,x(r,G));if(L)de(r,G);else{if(!h(r))return;z(r);var X=$(C.currentTarget);X.val()!==""&&(X.val(""),r._previous_val="",A(r)),r.single&&(ee(r),Se(r))}}},"_onFilterInputKeydownEnter"),je=d(function(r,C){if(r.$filter_input.val()===""){te(C);var G=r.$input_container.find(".lfs_token").last();F(r)&&T(G)?fe(r,G):ne(r)}},"_onFilterInputKeydownDel"),Le=d(function(r,C){r.$filter_input.val().trim()&&F(r)?(te(C),t(r,r.$filter_input.val())):r.tab_to_nav&&(te(C),C.shiftKey?W(r):O(r))},"_onFilterInputKeydownTab"),ze=d(function(r,C){te(C),ee(r),Se(r),r.$filter_input.blur()},"_onFilterInputKeydownEsc"),Ae=d(function(r,C){r.disabled||(C.stopPropagation(),Q(r),r._prevent_blur=!1)},"_onValueClick"),We=d(function(r,C){C.which===1&&(r._prevent_blur=!0)},"_onValueMousedown"),De=d(function(r,C){r.disabled||(oe(r,$(C.currentTarget)),r._prevent_blur=!1)},"_onTokenClick"),Ke=d(function(r,C){C.which===1&&(r._prevent_blur=!0)},"_onTokenMousedown"),Fe=d(function(r,C){C.which===1&&(r._prevent_blur=!0)},"_onListContainerMousedown"),Ge=d(function(r){r._prevent_blur&&r.$filter_input.focus()},"_onListContainerMouseup"),Re=d(function(r,C){if(!r.disabled&&!(C.clientX==r._mouse.lastX&&C.clientY==r._mouse.lastY)){var G=$(C.currentTarget);r._$active&&r._$active.removeClass("active"),!G.hasClass("active")&&E(G)&&(G.addClass("active"),r._$active=G),r._mouse.lastX=C.clientX,r._mouse.lastY=C.clientY}},"_onItemMousemove"),Ve=d(function(r,C){$(C.currentTarget).removeClass("active"),r._$active=null},"_onActiveItemMouseleave"),He=d(function(r,C){if(!r.disabled){C.preventDefault();var G=$(C.currentTarget);r._$active=G;var L=!r.single&&r.allow_item_unselect&&y(r,x(r,G));if(L)de(r,G);else{var X=E(G);if(!X&&!r.single||!h(r))return;if(!X&&r.single){ee(r),C.stopPropagation();return}z(r),r.$filter_input.val()!==""&&(r.$filter_input.val(""),r._previous_val="",A(r)),r.single&&(ee(r),C.stopPropagation())}r._prevent_blur=!1}},"_onItemClick")})()},J7dF:function(se,ae){(function(){TS.registerModule("permissions.members",{onStart:function(){},canCreateAndDeleteUserGroups:function(){return TS.interop.userGroups.canCreateAndDeleteUserGroups()}})})()},L48h:function(se,ae){(function(){TS.registerModule("ui.admin_edit_team_profile",{onStart:function(){$("body").on("click",'[data-action="edit_team_profile_modal"]',TS.ui.admin_edit_team_profile.start)},start:function(){ne()&&e()}});var a,t,f,i=[],l=50,e=d(function(){var N={body_template_html:TS.templates.admin_edit_team_profile_modal(),onShow:n,onCancel:o};TS.ui.fs_modal.start(N)},"_start"),n=d(function(){a=$("#edit_team_profile_container"),t=$("body"),a.on("click",'[data-action="edit_team_profile_to_custom"]',s),a.on("click",'[data-action="edit_team_profile_to_add"]',T),a.on("click",'[data-action="edit_team_profile_to_edit"]',g),a.on("click",'[data-action="edit_team_profile_to_hide"]',A),a.on("click",'[data-action="edit_team_profile_to_delete"]',j),a.on("click",'[data-action="edit_team_profile_cancel"]',y),a.on("click",'[data-action="edit_team_profile_confirm_edit"]',w),a.on("click",'[data-action="edit_team_profile_confirm_hide"]',m),a.on("click",'[data-action="edit_team_profile_confirm_delete"]',u),a.on("click",'[data-action="edit_team_profile_remove_option"]',J),a.on("click",'[data-action="edit_team_profile_add_option"]',B),a.on("focusin",'[data-action="edit_team_profile_update_preview_label"], [data-action="edit_team_profile_update_preview_hint"], .option_header_row + .option_row [data-action="edit_team_profile_update_preview_option"]',E),a.on("focusout",'[data-action="edit_team_profile_update_preview_label"], [data-action="edit_team_profile_update_preview_hint"], .option_header_row + .option_row [data-action="edit_team_profile_update_preview_option"]',k),a.on("input",'[data-action="edit_team_profile_update_preview_label"], [data-action="edit_team_profile_update_preview_hint"], .option_header_row + .option_row [data-action="edit_team_profile_update_preview_option"]',M),a.on("click",'[data-action="edit_team_profile_list_menu"]',V),a.on("input","input",he),t.on("keydown.admin_submit",c),v().then(y).catch(TS.error)},"_onShow"),o=d(function(){oe(!0),a=null,i=[],f=null,t.off("keydown.admin_submit"),t=null},"_onCancel"),c=d(function(N){if(N.which==TS.utility.keymap.enter)return $(f).find('button[type="submit"]').trigger("click"),!1},"_onKeydown"),v=d(function(){return TS.team.ensureTeamProfileFields()},"_ensureProfile"),h=d(function(N,p){if(N)return TS.interop.api.call(N,p).then(function(P){return N==="team.profile.delete"?TS.interop.members.deleteProfileFields(TS.model.team.id,JSON.parse(p.profile).fields):N==="team.profile.reorder"?TS.interop.teams.reorderTeamProfileFields(TS.model.team.id,_.get(P,"data.profile.fields")):TS.interop.members.updateProfileFields(TS.boot_data.team_id,_.get(P,"data.profile.fields")),Promise.resolve(P)},function(P){return Promise.reject(P)})},"_apiCall"),u=d(function(N){var p=$(N.target),P=p.data("id");if(P||(p=p.closest("[data-id]")),P=p.data("id"),!!P){var I=TS.team.getTeamProfileFieldById(P);I&&x("team.profile.delete",[P]).then(y,_.noop)}},"_deleteField"),m=d(function(N){b(N,!0)},"_hideField"),S=d(function(N){b(N,!1)},"_showField"),b=d(function(N,p){var P=$(N.target),I=P.data("id");if(I||(P=P.closest("[data-id]")),I=P.data("id"),!I)return;var H=TS.team.getTeamProfileFieldById(I);if(!H)return;H=$.extend({},H),H.is_hidden=p,p&&(H.ordering=H.ordering||W());function ie(){y(),_e(I)}d(ie,"resolve"),x("team.profile.set",[H]).then(ie,_.noop)},"_hideOrShowField"),w=d(function(N){var p=a.find("#edit_team_profile_edit");if(!TS.ui.validation.validate(p,{quiet:!0,fast:!0})){TS.ui.validation.validate(p),Ladda.stopAll(),$("#edit_team_profile_confirm_edit_btn").addClass("disabled");return}var P=$(N.target),I=P.data("id");I||(P=P.closest("[data-id], [data-type]")),I=P.data("id");var H=a.find('input[name="label"]'),ie=a.find('input[name="hint"]'),re=TS.team.getTeamProfileFieldById(I)||{},ce=JSON.stringify(re);re=$.extend({},re),re.type=re.type||P.data("type")||"text",re.label=H.val().trim(),re.hint=ie.val().trim(),re.ordering=re.ordering||W(),re.type==="options_list"&&(re.possible_values=a.find('input[name^="option_"]').map(function(){return $(this).val().trim()}).toArray());function pe(){y(),_e(I)}d(pe,"resolve"),JSON.stringify(re)==ce?(pe(),Ladda.stopAll()):x("team.profile.set",[re]).then(pe,_.noop)},"_editField"),x=d(function(N,p){p=p&&p.length?p:TS.model.team.profile.fields;var P={profile:JSON.stringify({fields:p})};return h(N,P).catch(function(I){if(I.data.error==="no_perms"||I.data.error==="missing_scope"){var H=TS.boot_data.page_needs_enterprise,ie=H?TS.interop.i18n.t("Sorry! An organization owner or admin is required to update this setting.","team_profile","21d269f8b1a2802d90b32308195ac5b67c9413f6")():TS.interop.i18n.t("Sorry! An owner in your workspace has restricted who can customize your members\u2019 profile.","team_profile")();TS.generic_dialog.start({body:ie,show_cancel_button:!1,esc_for_ok:!0,fullscreen:!1,onEnd:TS.ui.fs_modal.close})}else return I.data.error==="field_bad_order"?(TS.error(`Failed to create profile field: ${I.data.error}`),TS.generic_dialog.alert(TS.interop.i18n.t("Apologies, but the maximum number of profile fields you can add is {max_no_of_fields, number}. Please remove some existing fields if you\u2019d like to add different ones.","team_profile")({max_no_of_fields:l}))):(TS.error(`Failed to customize profile: ${I.data.error}`),TS.generic_dialog.alert(TS.interop.i18n.t("Sorry! Something went wrong. Please try again.","team_profile")()))}).finally(Ladda.stopAll)},"_saveProfile"),U=d(function(){return TS.interop.experiments.getGroupForUser("comprehensive_profiles")!=="on"?!1:(TS.model.team.profile.fields||[]).some(N=>N.field_name==="title"&&N.options&&N.options.is_scim)},"_shouldHideDefaultTitle"),ee=d(function(){return TS.interop.experiments.getGroupForUser("comprehensive_profiles")!=="on"||TS.interop.experiments.getGroupForUser("rimeto_profile_show_default_phone_webapp")==="on"?!1:(TS.model.team.profile.fields||[]).some(N=>N.field_name==="primaryPhone"&&N.options&&N.options.is_scim)},"_shouldHideDefaultPhone"),F=d(function(){return TS.prefs.getTeamPref("display_pronouns")},"_shouldShowPronounField"),y=d(function(){i.length=0,i.push({back:y});var N={};N.team_profile_fields=te(),N.hidden_team_profile_fields=de(),N.default_team_profile_fields=ue(),N.hide_default_title=U(),N.hide_default_phone=ee(),N.show_pronoun_field=F();var p=TS.templates.admin_edit_team_profile_list(N);a.find("#edit_team_profile_header").text(TS.interop.i18n.t("Customize profile","team_profile")()).removeClass("hidden center_and_narrow");var P;TS.model.team.profile&&TS.model.team.profile.fields.length>=50?P=`<div class="alert alert_info"><i class="ts_icon ts_icon_info_circle"></i>${TS.interop.i18n.t("You have reached the maximum number of fields that can be added to profiles.","team_profile")()}</div>`:P=TS.interop.i18n.t("Expand your members\u2019 profiles by adding additional fields below","team_profile")(),a.find("#edit_team_profile_value_note").html(P).removeClass("hidden center_and_narrow"),a.find("#edit_team_profile_list").html(p),K("#edit_team_profile_list"),z(),q(),oe(!0)},"_switchToList"),T=d(function(){i.push({back:T});var N={};N.default_team_profile_fields=ue();var p=TS.templates.admin_edit_team_profile_add(N);a.find("#edit_team_profile_header").text(TS.interop.i18n.t("Select a field type","team_profile")()).removeClass("center_and_narrow"),a.find("#edit_team_profile_value_note").addClass("hidden"),a.find("#edit_team_profile_add").html(p),K("#edit_team_profile_add"),q(),oe()},"_switchToAdd"),s=d(function(){i.push({back:s});var N=TS.templates.admin_edit_team_profile_custom();a.find("#edit_team_profile_header").text(TS.interop.i18n.t("Create a new field","team_profile")()).removeClass("center_and_narrow"),a.find("#edit_team_profile_value_note").text(TS.interop.i18n.t("Which type of field would you like to create?","team_profile")()).removeClass("hidden center_and_narrow"),a.find("#edit_team_profile_custom").html(N),K("#edit_team_profile_custom"),q(),oe(),O()},"_switchToCustom"),g=d(function(N){var p=$(N.target);if(p.hasClass("ts_icon_grabby_patty"))return!1;var P=p.data("id");P||(p=p.closest("[data-id], [data-type]")),P=p.data("id");var I={},H;if(!P)I.type=p.data("type"),I.label=p.data("label"),H=TS.interop.i18n.t("Customize profile field","team_profile")();else{if(I=TS.team.getTeamProfileFieldById(P),!I)return;H=TS.interop.i18n.t("Edit profile field","team_profile")()}N.stopPropagation(),i.push({back:g,event:N});var ie=TS.templates.admin_edit_team_profile_edit(I);a.find("#edit_team_profile_header").text(H).removeClass("center_and_narrow"),a.find("#edit_team_profile_value_note").addClass("hidden"),a.find("#edit_team_profile_edit").html(ie),K("#edit_team_profile_edit"),D(),Y(),O(),Ladda.bind("#edit_team_profile_confirm_edit_btn"),q(),oe(),he()},"_switchToEdit"),A=d(function(N){var p=$(N.target),P=p.data("id");if(P||(p=p.closest("[data-id]")),P=p.data("id"),!!P){var I=TS.team.getTeamProfileFieldById(P);if(I){N.stopPropagation(),i.push({back:A,event:N});var H=TS.templates.admin_edit_team_profile_hide({id:I.id,can_delete:!_.get(I,"options.is_scim",!1)}),ie=TS.interop.i18n.t('Hide "{field_label}"',"team_profile")({field_label:I.label});a.find("#edit_team_profile_header").text(ie).addClass("center_and_narrow");var re=TS.interop.i18n.t("All data entered for this field will no longer be visible on your members\u2019 profiles. You can un-hide it later.","team_profile")();a.find("#edit_team_profile_value_note").text(re).addClass("center_and_narrow").removeClass("hidden"),a.find("#edit_team_profile_hide").html(H),K("#edit_team_profile_hide"),Ladda.bind("#edit_team_profile_confirm_hide_btn"),Z(),oe()}}},"_switchToHide"),j=d(function(N){var p=$(N.target),P=p.data("id");if(P||(p=p.closest("[data-id]")),P=p.data("id"),!!P){var I=TS.team.getTeamProfileFieldById(P);if(I){N.stopPropagation(),i.push({back:j,event:N});var H=TS.templates.admin_edit_team_profile_delete(I),ie=TS.interop.i18n.t('Delete "{field_label}"',"team_profile")({field_label:I.label});a.find("#edit_team_profile_header").text(ie).addClass("center_and_narrow");var re=TS.interop.i18n.t("<strong>Are you sure?</strong> All data associated with this field will be permanently deleted. This <strong>cannot be undone</strong>.","team_profile")();a.find("#edit_team_profile_value_note").html(re).addClass("center_and_narrow").removeClass("hidden"),a.find("#edit_team_profile_delete").html(H),K("#edit_team_profile_delete"),Ladda.bind("#edit_team_profile_confirm_delete_btn"),Z(),oe()}}},"_switchToDelete"),Z=d(function(){a.closest(".contents").addClass("display_flex flex_direction_column").css("height","70vh"),a.css({margin:"auto 0",height:"auto","padding-top":0})},"_flexContentsAndCenter"),q=d(function(){a.closest(".contents").removeClass("display_flex flex_direction_column").css("height",""),a.css({margin:"",height:"","padding-top":""})},"_unflexContentsAndCenter"),ne=d(function(){if(!TS.model.team)return!1;var N=TS.model.user;return N?TS.prefs.getTeamPref("who_can_change_team_profile")==="admin"?N.is_admin:TS.prefs.getTeamPref("who_can_change_team_profile")==="owner"?N.is_owner:!0:!1},"_userCanEditTeamProfile"),oe=d(function(N){N?(TS.ui.fs_modal.unbindBackButton(),TS.ui.fs_modal.hideBackButton()):(TS.ui.fs_modal.bindBackButton(function(){i.pop();var p=i.pop();p.back(p.event)}),TS.ui.fs_modal.showBackButton())},"_updateBackButton"),D=d(function(){var N=a.find(".option_row");N.length>=3?N.addClass("show_remove_action"):N.removeClass("show_remove_action")},"_maybeShowOptionRemoveAction"),Y=d(function(){M({target:a.find('.option_header_row + .option_row [data-action="edit_team_profile_update_preview_option"]')})},"_maybeUpdateOptionPreviewValue"),J=d(function(N){$(N.target).closest(".row.option_row").remove(),he(),D(),Y(),R()},"_removeOption"),B=d(function(){var N=TS.templates.admin_edit_team_profile_option_row({index:a.find(".row.option_row").length});a.find("#option_rows").append(N).find(".row.option_row").last().find("input").focus(),he(),D(),R()},"_addOption"),R=d(function(){a.find(".row.option_row").length===50?a.find('[data-action="edit_team_profile_add_option"]').addClass("hidden").next().removeClass("hidden"):a.find('[data-action="edit_team_profile_add_option"]').removeClass("hidden").next().addClass("hidden")},"_maybeUpdateAddOptionAction"),M=d(function(N){var p=$(N.target),P=p.val();P&&(P=P.trim()),P!==void 0&&!P.length&&(P=p.data("default")),a.find(`.profile_field_preview [data-id="${p.data("target")}"]`).text(P)},"_updatePreviewValue"),E=d(function(N){var p=a.find(`.profile_field_preview [data-id="${$(N.target).data("target")}"]`),P=p.closest("select");P.length&&(p=P),p.addClass("highlight_yellow_bg")},"_decoratePreview"),k=d(function(N){var p=a.find(`.profile_field_preview [data-id="${$(N.target).data("target")}"]`),P=p.closest("select");P.length&&(p=P),p.removeClass("highlight_yellow_bg")},"_undecoratePreview"),O=d(function(){var N=a.find(".edit_team_profile_lazy_filter_select");if(N.length){var p="USLACKBOT";TS.boot_data.feature_deprecate_get_member_by_name||(p=TS.interop.members.getMemberByName("slackbot").id);var P={append:!0,classes:"disabled",preselected_ids:[p]};TS.ui.people_picker.make(N,P)}},"_makePeoplePicker"),z=d(function(){a.find("#edit_team_profile_list_drag_and_drop_area").sortable({items:".visible_row[data-id]",handle:".ts_icon_grabby_patty",forcePlaceholderSize:!0}).on("sortupdate",function(N){N.stopPropagation();var p=[];$(this).find(".row[data-id]").each(function(I){var H=TS.team.getTeamProfileFieldById($(this).data("id"));H&&H.ordering!=I&&(H.ordering=I,p.push({id:H.id,ordering:I}))});var P=TS.team.sortTeamProfileFieldsByOrdering(TS.model.team.profile.fields);TS.redux.teams.upsertTeam(_.assign({},TS.model.team,{profile:{fields:P}})),x("team.profile.reorder",p)})},"_enableDragAndDrop"),W=d(function(){return TS.model.team.profile.fields.length?_.max(TS.model.team.profile.fields.map(function(N){return N.ordering}))+1:0},"_makeOrdering"),V=d(function(N){N.stopPropagation();var p=$(N.target).closest("[data-id]").get(0),P={};P.is_scim=$(N.target).closest("[data-is-scim]").data("is-scim");var I=jQuery.Event("click",{target:p,currentTarget:p});TS.menu.startWithEditTeamProfileListActions(I,Q,P)},"_openListMenu"),Q=d(function(N){N.preventDefault();var p=$(N.target).closest("[data-id]");p.is('[data-action="edit_team_profile_to_show"]')?S(N):p.is('[data-action="edit_team_profile_to_hide"]')?A(N):p.is('[data-action="edit_team_profile_to_delete"]')&&j(N),TS.menu.end()},"_onListMenuClick"),K=d(function(N){var p=["#edit_team_profile_loading","#edit_team_profile_list","#edit_team_profile_add","#edit_team_profile_custom","#edit_team_profile_edit","#edit_team_profile_hide","#edit_team_profile_delete"].filter(function(P){return P!==N}).join(", ");a.find(p).addClass("hidden"),a.find(N).removeClass("hidden"),f=N},"_hideAllSectionsBut"),te=d(function(){var N=TS.team.getVisibleTeamProfileFields();return N.length?N:null},"_getVisibleTeamProfileFields"),de=d(function(){var N=TS.team.getHiddenTeamProfileFields();return N.length?N:null},"_getHiddenTeamProfileFields"),fe=d(function(){return TS.model.team.profile.fields.reduce(function(N,p){return N[p.label.toLowerCase()]=!0,N},{})},"_getLabelsMap"),ue=d(function(){var N=fe(),p=[{type:"text",label:TS.interop.i18n.t("Address","team_profile")()},{type:"date",label:TS.interop.i18n.t("Birthdate","team_profile")()},{type:"user",label:TS.interop.i18n.t("Direct Reports","team_profile")()},{type:"link",label:TS.interop.i18n.t("Facebook","team_profile")()},{type:"link",label:TS.interop.i18n.t("Flickr","team_profile")()},{type:"link",label:TS.interop.i18n.t("GitHub","team_profile")()},{type:"link",label:TS.interop.i18n.t("Instagram","team_profile")()},{type:"link",label:TS.interop.i18n.t("LinkedIn","team_profile")()},{type:"user",label:TS.interop.i18n.t("Manager","team_profile")()},{type:"link",label:TS.interop.i18n.t("Pinterest","team_profile")()},{type:"text",label:TS.interop.i18n.t("Skype","team_profile")()},{type:"link",label:TS.interop.i18n.t("SoundCloud","team_profile")()},{type:"date",label:TS.interop.i18n.t("Start Date","team_profile")()},{type:"link",label:TS.interop.i18n.t("Tumblr","team_profile")()},{type:"link",label:TS.interop.i18n.t("Twitter","team_profile")()},{type:"link",label:TS.interop.i18n.t("YouTube","team_profile")()}].filter(function(P){return!N[P.label.toLowerCase()]});return p.length?p:[]},"_getDefaultTeamProfileFields"),_e=d(function(N){var p=N?`[data-id=${N}]`:".visible_row[data-id]",P=a.find("#edit_team_profile_list").find(p).last(),I=P.outerHeight()*-2;P.highlight(1500,"",null,0),P.scrollintoview({duration:200,px_offset:I,direction:"y"})},"_highlightInList"),he=d(function(){$("#edit_team_profile_confirm_edit_btn").toggleClass("disabled",!TS.ui.validation.validate(a.find("#edit_team_profile_edit"),{quiet:!0,fast:!0}))},"_toggleSave")})()},LzIY:function(se,ae){(function(){TS.registerModule("compression",{compress:function(n,o,c,v){var h=Date.now();if(c){var u=LZString.compress(o),m=Date.now()-h;return TS.has_pri[e]&&TS.log(e,`${n} took ${m}ms to _compress immediately str.length: ${o.length}`),v({k:n,str:u})}i(n,o,function(S,b){var w=Date.now()-h;TS.has_pri[e]&&TS.log(e,`${n} took ${w}ms for the compression worker to callback (${b}ms spent within the worker) result.length: ${S.length}`),v({k:n,str:S})})},terminate:function(){a&&a.terminate(),a=null}});var a=null,t=0,f={},i=d(function(n,o,c){a||l(),t+=1;var v=`job_key${t}`;f[v]=function(h,u){c(h,u),delete f[v]},a.postMessage({request:"compress",input:o,job_key:v,k:n})},"_doCompressionJob"),l=d(function(){if(a){TS.error("_makeWorker but there is a _worker");return}var n=_.get(TS,"boot_data.vvv_paths.lz_string","/js/libs/lz-string-1.4.4.js"),o=TS.environment.is_dev;(TS.qs_args.local_assets||o)&&n.indexOf("http")!==0&&(n=`${location.protocol}//${location.host}${n}`),a=TS.utility.makeWebWorker(`function() {			self.importScripts('${n}');			self.onmessage = function(e) {				var start = Date.now();				var result;				if (e.data.request === 'compress') {					result = LZString.compress(e.data.input)				}				var elapsed = Date.now() - start;				postMessage({					request: e.data.request,					result: result,					job_key: e.data.job_key,					k: e.data.k,					elapsed: elapsed				});			}		}`,function(c){var v=f[c.data.job_key];if(!v){TS.error(`e.data.job_key:${c.data.job_key} had no record in _callbacks??`);return}v(c.data.result,c.data.elapsed)})},"_makeWorker"),e=488})()},Nyv6:function(se,ae){(function(){TS.registerModule("utility.enterprise",{splitQueryIntoTerms:function(a,t,f){var i=t,l;return a=a.trim(),a.length>=2&&(i=_.isArray(t)?_.slice(t):[],l=a.split(/\s+/),_.each(l,function(e){i.push({type:f||"fuzzy_with_email",value:e})})),i},getSSOProviderLabel:function(a,t){if(!a)return t;var f=_.get(a,"type",""),i=_.get(a,"name",""),l=f==="",e=f==="saml";return l||e?t:i||t},getProviderLabel:function(a,t){var f=t||"IDP";return a?(t=_.get(a,"saml_provider")||f,t.toLowerCase()==="saml"&&(t=f),TS.utility.enterprise.getSSOProviderLabel(_.get(a,"sso_provider"),t)):f},buildTeamUrl:function(a){return`https://${a||"my"}.${TS.boot_data.abs_root_url.replace(/(http:\/\/|https:\/\/)/,"")}`},buildOrgUrl:function(a){return`https://${a}.enterprise.${TS.boot_data.abs_root_url.replace(/(http:\/\/|https:\/\/)/,"")}`},formatChannelsData:function(a){var t=[];return a.private_channels&&(a.private_channels=_.isArray(a.private_channels)?a.private_channels:[a.private_channels],t=_.map(a.private_channels,function(f){var i=TS.interop.members.getMemberById(f.creator)||{};const l=f.members,e=Array.isArray(l)?l.length:f.members,n={creator_display:i.real_name?i.real_name:i.name,creator_id:f.creator,creator_username:i.name,date_created:f.created,member_count:f.member_count||e,purpose:f.purpose.value,topic:f.topic.value,private:!0};return _({}).assign(f,n).omit("members").value()})),a.channels&&(t=t.concat(_.map(a.channels,function(f){var i=TS.interop.members.getMemberById(f.creator)||{};const l=f.members,e=Array.isArray(l)?l.length:f.members,n={creator_display:i.real_name?i.real_name:i.name,creator_id:f.creator,creator_username:i.name,date_created:f.created,member_count:e||0,purpose:_.get(f,"purpose.value",""),topic:_.get(f,"topic.value",""),private:!1};return _({}).assign(f,n).omit("members").value()}))),t},buildAnalyticsApiOptionsFor:function(a){var t=d(function(f){return _.reduce(f,function(i,l,e){var n=TS.enterprise.model.get(["analytics",l]);return n&&(i[e]=n),i},{})},"build");switch(a){case"teams":return t({query:"teams_search_term",sort_prefix:"teams_sort_prefix",sort_dir:"teams_sort_dir",cursor_mark:"teams_api_cursor",date_range:"current_date_range",start_date:"start_date",end_date:"end_date"});case"team_overview":return t({date_range:"current_date_range",start_date:"start_date",end_date:"end_date",team_id:"team_overview_id"});case"members":return t({query:"members_search_term",sort_prefix:"members_sort_prefix",sort_dir:"members_sort_dir",cursor_mark:"members_api_cursor",date_range:"current_date_range",start_date:"start_date",end_date:"end_date"});case"channels":return t({query:"channels_search_term",sort_prefix:"channels_sort_prefix",sort_dir:"channels_sort_dir",cursor_mark:"channels_api_cursor",date_range:"current_date_range",start_date:"start_date",end_date:"end_date"});default:return t({date_range:"current_date_range",start_date:"start_date",end_date:"end_date"})}},maybeGetUpdatedAtTime:function(a){return a?TS.interop.datetime.toTimeAgo(a):null},buildApiOptionsForAnalyticsCSVExport:function(a){var t={};if(a.type&&(t.type=a.type),a.date_range&&(t.date_range=a.date_range),_.get(a.selected_columns,"length")&&(t.cols=a.selected_columns.join(",")),a.team_id&&(t.team_id=a.team_id),a.sort_prefix&&(t.sort_prefix=a.sort_prefix,a.sort_dir&&(t.sort_dir=a.sort_dir)),a.search_term){var f=TS.utility.enterprise.splitQueryIntoTerms(a.search_term,[],"fuzzy_with_email");if(f.length){var i=f.length===1?_.head(f):{type:"and",clauses:f};t.query=JSON.stringify(i)}}return t},recordAnalyticsPricingEvents:function(a,t,f){f=f||{};const i={};switch(t){case"overview_impression":i.action="impression",i.step="team_stats_overview";break;case"coachmark_impression":i.action="impression",i.step=`team_stats_overview_${_.get(f,"callout_module")}_coachmark`;break;case"coachmark_resolve":i.action="click",i.step=`team_stats_overview_${_.get(f,"callout_module")}_coachmark`,i.ui_element="learn_more_btn";break;case"coachmark_reject":i.action="dismiss",i.step=`team_stats_overview_${_.get(f,"callout_module")}_coachmark`,i.ui_element="skip_this";break;case"msg_files_pricing_btn_click":i.action="click",i.step="team_stats_overview",i.ui_element="msg_files_chart_link_btn";break;case"single_callout_upgrade_link_impression":i.action="impression",i.step="team_stats_overview",i.ui_element=`${_.get(f,"callout_module")}_upgrade_link`;break;case"multi_callout_upgrade_link_impression":i.action="impression",i.step="team_stats_overview",i.ui_element="multi_lim_upgrade_link";break;case"data_table_upsell_banner_impression":i.action="impression",i.step=`team_stats_${_.get(f,"report_name")}`;break;case"data_table_upsell_banner_click":i.action="click",i.step=`team_stats_${_.get(f,"report_name")}`,i.ui_element="see_pricing_plans_btn";break;default:}TS.interop.clog.track(a,{contexts:{ui_context:i}})},recordAnalyticsImpression:function(a,t,f,i,l){const e="ENTERPRISE_ANALYTICS",n={},o={};n.action="impression",n.ui_element=t,o.entity_key=f,o.tracking_code=i,o.anchor_page=a,l?o.target_team_id=l:o.target_team_id=TS.enterprise.model.get("org.enterprise.id")||_.get(TS.boot_data,"team_id"),TS.interop.clog.track(e,_.assign({},o,{contexts:{ui_context:n}}))},recordAnalyticsTooltipHover:function(a){const t="ENTERPRISE_ANALYTICS",f={},i={};f.action="hover",f.ui_element="NOTING_BADGE",i.entity_key=a;const l=TS.enterprise.model.get("org.enterprise.id"),e=TS.enterprise.model.get("analytics.overview_open");l&&!e?(i.anchor_page="organization_overview",i.target_team_id=l):e?(i.anchor_page="workspace_overview",i.target_team_id=TS.enterprise.model.get("analytics.team_overview_id")):(i.anchor_page="workspace_overview",i.target_team_id=_.get(TS.boot_data,"team_id")),TS.interop.clog.track(t,_.assign({},i,{contexts:{ui_context:f}}))},recordAnalyticsSearchEvent:function(a,t,f){const i="ENTERPRISE_ANALYTICS",l={},e={};l.action="impression",l.action_status=f?2:1,l.ui_element="SEARCH_BAR",e.entity_key=t,e.anchor_page=a,e.target_team_id=TS.enterprise.model.get("org.enterprise.id")||_.get(TS.boot_data,"team_id"),TS.interop.clog.track(i,_.assign({},e,{contexts:{ui_context:l}}))},convertDateRangeToThriftID:function(a){switch(a){case"28d":return"FILTER_LAST_28DAYS";case"30d":return"FILTER_LAST_30DAYS";case"all":return"FILTER_ALL_TIME";default:}},convertTimeseriesTabToClogKey:function(a){switch(a){case"active-users_weekly_active_users":return"wau_ts";case"active-users_daily_active_users":return"dau_ts";case"messages-and-files_messages_sent":return"messages_sent_ts";case"messages-and-files_files_uploaded":return"files_uploaded_ts";case"transparency_where_messages_sent":return"transparency_sent_ts";case"transparency_where_messages_read":return"transparency_read_ts";default:}},getNumberAnnotation:function(a){let t="";if(TS.interop.i18n.locale==="ja-JP")switch(a){case"channels":case"messages":t="\u4EF6";break;case"users":t="\u4EBA";break;case"files":case"apps":t="\u500B";break;default:}return t}})})()},Oszc:function(se,ae){(function(){TS.registerModule("channels.read_only",{list_updated_sig:new signals.Signal,refetching_channel_info_ids:{},stashAndFetchChannelPostingUpdates:function(a,t,f){if(!TS.channels.read_only.refetching_channel_info_ids[a]){TS.channels.read_only.refetching_channel_info_ids[a]=!0;var i={id:a},l=!0;switch(t){case 6:i.is_read_only=!0,i.is_thread_only=!1,i.is_non_threadable=!1;break;case 7:i.is_read_only=!1,i.is_thread_only=!0,i.is_non_threadable=!1;break;case 8:i.is_read_only=!1,i.is_thread_only=!1,i.is_non_threadable=!0;break;default:l=!1;break}l&&(TS.interop.channels.upsertChannel(i),TS.channels.read_only.list_updated_sig.dispatch()),TS.shared.promiseToRefetchModelOb(a,f).then(function(){delete TS.channels.read_only.refetching_channel_info_ids[a],TS.channels.read_only.list_updated_sig.dispatch()})}}})})()},Pv2O:function(se,ae){(function(){TS.registerModule("utility.teams",{getMembersForTeam:function(a){if(_.isObject(a)&&a.id){var t=_.filter(TS.model.members,{team_id:a.id});return t}}})})()},R0Lu:function(se,ae){(function(){TS.registerModule("ui.people_picker",{STYLES:{normal:"normal",small:"small"},onStart:function(){},preload:function(i){return t(i)(""),i},make:function(i,l){l=l||{},l.append||i.addClass("hidden"),l.style=_.get(TS.ui.people_picker.STYLES,l.style,TS.ui.people_picker.STYLES.normal),i.lazyFilterSelect({append:!!l.append,always_visible:!!l.always_visible,approx_item_height:l.approx_item_height||50,data_promise:t(l),placeholder_text:l.placeholder_text||TS.interop.i18n.t("Search by name","people_picker")(),classes:"people_picker",scroll_threshold:2500,single:!!l.single,style:l.style,sluggify:l.sluggify,disabled:l.disabled,template:l.template||function(e){var n=TS.templates.member_small({member:e.member});return new Handlebars.SafeString(n)},tokenTemplate:l.tokenTemplate||function(e){var n=TS.templates.member_token({member:e.member});return new Handlebars.SafeString(n)},tokenClass:function(e){return TS.templates.builders.getMemberTypeClass(e.member)},noResultsTemplate:l.noResultsTemplate||function(e){return e?TS.interop.i18n.t("No one found matching <strong>{query}</strong>","people_picker")({query:TS.interop.i18n.safeString(_.escape(e))}):TS.interop.i18n.t("No one found","people_picker")()},onItemAdded:l.onItemAdded,onItemRemoved:l.onItemRemoved})},value:function(i){return i.lazyFilterSelect("value")},clearValue:function(i){return i.lazyFilterSelect("clearValue")},recomputeHeight:function(i){return i.lazyFilterSelect("recomputeHeight")}});var a=["include_slackbot","include_self","include_bots","only_local_team","only_admins"],t=d(function(i){var l={},e={};i.preselected_ids&&i.preselected_ids.length&&_.forEach(i.preselected_ids,function(c){c&&(e[c]=!0)});var n={};i.omitted_ids&&i.omitted_ids.length&&_.forEach(i.omitted_ids,function(c){c&&(n[c]=!0)});var o=d(function(c,v){if(c.charAt(0)==="@"&&(c=c.substring(1)),c===""&&i.empty_query_result)return v>0?Promise.resolve([]):Promise.resolve(i.empty_query_result.map(function(u){return{member:u,lfs_id:String(u.id),preselected:!!e[u.id]}}));if(c===""&&i.initial_load_promise)return _.isUndefined(v)||(i.initial_load_promise=f(i.initial_load_promise,e,n)),i.initial_load_promise;l.query!==c&&(l.query=c,l.include_org=TS.boot_data.page_needs_enterprise,l.include_slackbot=!!i.include_slackbot,l.include_self=i.include_self,l.full_profile_filter=!1,l.include_bots=!!i.include_bots,l.only_local_team=!!i.only_local_team,l.only_admins=!!i.only_admins);var h=TS.interop.members.ensureMembersArePresent(_.keys(e)).then(function(){return f(l,e,n)});return c===""&&!i.initial_load_promise&&(i.initial_load_promise=h),h},"promiseToFilter");return o},"_createFilterFunction"),f=d(function(i,l,e){return Promise.resolve().then(function(){var n=[],o=_.keys(l);return o.forEach(function(c){var v=TS.interop.members.getMemberById(c);v||n.push(c)}),n.length?TS.interop.members.ensureMembersArePresent(n).catch(_.noop):Promise.resolve()}).then(function(){return TS.members.promiseToSearchMembers(i).then(function(n){var o=[];if(n.query===""){var c=_.pick(i,a);o=TS.members.getMembersWithOptions(c)}else o=n.items;return n.items=o.filter(function(v){return!e[v.id]}).map(function(v){return v.member&&typeof v.preselected<"u"?v:{member:v,lfs_id:String(v.id),preselected:!!l[v.id]}}),n})})},"_getSearchPromise")})()},SaiC:function(se,ae){(function(){TS.registerModule("members.view",{team_filter_changed_sig:new signals.Signal,filter_timer:null,onStart:function(){var D=500;c=TS.utility.debounceWithPromise(T,D),v=TS.utility.debounceWithPromise(T,D),h=TS.utility.debounceWithPromise(T,D)},switchTabs:function(D){$(`#${D}_members_tab`).trigger("click")},filterTeam:function(D,Y,J,B){var R=S(J);return _.get(B,"full_profile_filter")||_.get(R,"full_profile_filter")?TS.team.ensureTeamProfileFields().then(function(){return m(R)?U(D,Y,J,R):(s(D,Y,J,B),Promise.resolve())}):(s(D,Y,J),Promise.resolve())},clearFilter:function(D,Y){var J=S(Y),B=$(D),R=B.find("input.member_filter"),M=B.find(".icon_close"),E=B.data("list-items-id"),k=$(E),O=k.find(".member_item");a="",TS.storage.storeFilterState(a),TS.members.view.filter_timer&&(window.clearTimeout(TS.members.view.filter_timer),TS.members.view.filter_timer=null),R.val(""),M.addClass("hidden"),m(J)?(x(Y),TS.members.view.filterTeam(a,D,Y,J)):($(".restricted_header, .bot_header, .ra_invite_prompt, .restricted_info").removeClass("hidden"),k.find(".no_results").addClass("hidden"),O.addClass("active"),t[Y]&&(t[Y].detachEvents(),delete t[Y]),k.find(".member_item.clone").remove(),k.find(".filter_header").remove(),TS.members.view.team_filter_changed_sig.dispatch("",TS.members.getMembersForUser().length))}});var a="",t={},f={},i={},l={},e={members:{},restricted:{},deleted:{}},n=100,o=116,c,v,h,u=d(function(){return _.get(TS,"web.admin.view")==="list"&&TS.boot_data.page_needs_enterprise?!1:TS.boot_data.page_needs_enterprise},"_includeOrg"),m=d(function(D){if(TS.boot_data.page_needs_enterprise&&D&&D.is_long_list_view||_.get(TS,"web.admin.view")==="list")return!0},"_useSolrSearch"),S=d(function(D){var Y=i[D];if(!Y){TS.error("Missing arguments for a bound filter");return}return _.isFunction(Y)&&(Y=Y()||{}),Y.include_org=u(),Y},"_getFilterArgumentsByScrollerId"),b=d(function(D){var Y=$(D).find(".ts_icon_search");if(!Y.next().is(`${D}_spinner`)){var J=TS.templates.loading_indicator({id:`${D.substring(1)}_spinner`});Y.after(J),Y.addClass("hidden")}},"_startSpinner"),w=d(function(D){$(D).find(".ts_icon_search").removeClass("hidden"),$(`${D}_spinner`).remove()},"_stopSpinner"),x=d(function(){e.filter_p&&e.filter_p.cancel(),e.filtered_items&&(e.filtered_items={}),e.filter_last_query=null,e.filter_last_include_org=null,e.members.filter_cursor_mark="",e.members.filter_num_remaining=0,e.members.filter_num_found=0,e.members.filter_scroll_mark=0,e.restricted.filter_cursor_mark="",e.restricted.filter_num_remaining=0,e.restricted.filter_num_found=0,e.restricted.filter_scroll_mark=0,e.deleted.filter_cursor_mark="",e.deleted.filter_num_remaining=0,e.deleted.filter_num_found=0,e.deleted.filter_scroll_mark=0,TS.web&&$(window).off("scroll.filter").scrollTop(0)},"_cleanUpPromiseToFilterTeam"),U=d(function(D,Y,J,B){var R=D.trim();a=R.toLocaleLowerCase(),TS.storage.storeFilterState(a);var M=e.filter_last_query!==a||e.filter_last_include_org!==B.include_org||e.filter_last_sort!==B.sort||e.filter_last_sort_dir!==B.sort_dir;M&&(x(J),e.filter_last_query=a,e.filter_last_include_org=B.include_org,B.sort&&(e.filter_last_sort=B.sort),B.sort_dir&&(e.filter_last_sort_dir=B.sort_dir)),b(Y);var E=d(function(){return Promise.resolve().then(function(){return ee(e,M,a,B)}).then(function(k){return w(Y),F(k,e,M,a,R,Y,J,B)}).finally(function(){TS.utility.rAF(function(){})})},"promiseToFilter");return M?e.filter_p=E():e.filter_p=e.filter_p.then(E),e.filter_p},"_promiseToFilterTeam"),ee=d(function(D,Y,J,B){var R=Y||TS.model.ui_state.tab_name==="active_members"&&D.members.filter_num_remaining,M=Y||TS.model.ui_state.tab_name==="restricted_members"&&D.restricted.filter_num_remaining,E=Y||TS.model.ui_state.tab_name==="disabled_members"&&D.members.filter_num_remaining;if(!R&&!M&&!E)return Promise.resolve(D.filtered_items);var k=_.assign({},B,{restricted:!1});D.members.filter_p=R?c(D.members,J,k):Promise.resolve([]);var O=_.assign({},B,{restricted:!0});D.restricted.filter_p=M?v(D.restricted,J,O):Promise.resolve([]);var z=_.assign({},B,{include_deleted:2,include_restricted_and_full_members:!0});return D.deleted.filter_p=E?h(D.deleted,J,z):Promise.resolve([]),Promise.join(D.members.filter_p,D.restricted.filter_p,D.deleted.filter_p,function(W,V,Q){var K=(B.sort?q:TS.members.legacyAllocateTeamListMembers)(W.concat(V,Q));return K.members=_.uniqBy(K.members,function(te){return te.id}),K.disabled_members=_.uniqBy(K.disabled_members,function(te){return te.id}),K.restricted_members=_.uniqBy(K.restricted_members,function(te){return te.id}),K.ultra_restricted_members=_.uniqBy(K.ultra_restricted_members,function(te){return te.id}),Y?D.filtered_items=K:(D.filtered_items.members.push.apply(D.filtered_items.members,K.members),D.filtered_items.disabled_members.push.apply(D.filtered_items.disabled_members,K.disabled_members),D.filtered_items.deleted_bots.push.apply(D.filtered_items.deleted_bots,K.deleted_bots),D.filtered_items.bots.push.apply(D.filtered_items.bots,K.bots),D.filtered_items.restricted_members.push.apply(D.filtered_items.restricted_members,K.restricted_members),D.filtered_items.ultra_restricted_members.push.apply(D.filtered_items.ultra_restricted_members,K.ultra_restricted_members)),oe([...D.filtered_items.restricted_members,...D.filtered_items.ultra_restricted_members]).then(()=>Promise.resolve(D.filtered_items))})},"_promiseToSearchAndCombineResults"),F=d(function(D,Y,J,B,R,M,E,k){if(D){var O=!1;TS.model.ui_state.tab_name==="disabled_members"&&(e.deleted.filter_num_found||0)===0&&(O=!0),TS.model.ui_state.tab_name==="restricted_members"&&(e.restricted.filter_num_found||0)===0&&(O=!0);var z=TS.model.user_groups.filter(function(_e){return!_e.date_delete});TS.model.ui_state.tab_name==="user_groups"&&z.length===0&&(O=!0),O&&(TS.model.ui_state.tab_name="active_members",TS.storage.storeUIState(TS.model.ui_state),$("#active_members_tab").trigger("click"));var W=$("#active_members_list");W.length&&(W.longListView("setItems",l.active_members_list_items),J&&W.longListView("scrollToTop"));var V=$("#restricted_members_list");V.length&&(V.longListView("setItems",l.restricted_members_list_items),J&&V.longListView("scrollToTop"));var Q=$("#deleted_members_list");Q.length&&(Q.longListView("setItems",l.deleted_members_list_items),J&&Q.longListView("scrollToTop"));var K=D.members.concat(D.bots),te=D.restricted_members.concat(D.ultra_restricted_members),de=D.disabled_members.concat(D.deleted_bots),fe=[{name:"active",label:TS.interop.i18n.t("full members","members_view")(),matches:K},{name:"restricted",label:TS.interop.i18n.t("multi-channel guests","members_view")(),matches:te},{name:"disabled",label:TS.interop.i18n.t("deactivated accounts","members_view")(),matches:de}];if(fe.forEach(function(_e){var he=$(`#${_e.name}_no_results`);function N(){var p={query:R,tab:_e,active_matches:K,show_active_matches:_e.name!=="active"&&K.length>0,restricted_matches:te,show_restricted_matches:_e.name!=="restricted"&&te.length>0,disabled_matches:de,show_disabled_matches:_e.name!=="disabled"&&de.length>0},P=TS.templates.team_list_no_results(p);he.removeClass("hidden").html(P),he.find(".clear_members_filter").one("click",function(){TS.members.view.clearFilter(M,E)})}d(N,"noMatchesCase"),_e.matches.length>0||!B?he.addClass("hidden").empty():N()}),J){E==="#team_list_scroller"&&TS.web&&$(window).off("scroll.filter").on("scroll.filter",_.throttle(function(){var _e=0,he=0,N=0,p=null;TS.model.ui_state.tab_name==="active_members"&&(_e=_.parseInt($("#active_members_list > .list_items").css("height")),he=_.reject(l.active_members_list_items,{is_divider:!0}).length,N=Y.members.filter_num_remaining,p=Y.members.filter_p),TS.model.ui_state.tab_name==="restricted_members"&&(_e=_.parseInt($("#restricted_members_list > .list_items").css("height")),he=_.reject(l.restricted_members_list_items,{is_divider:!0}).length,N=Y.restricted.filter_num_remaining,p=Y.restricted.filter_p),TS.model.ui_state.tab_name==="disabled_members"&&(_e=_.parseInt($("#disabled_members_list > .list_items").css("height")),he=_.reject(l.deleted_members_list_items,{is_divider:!0}).length,N=Y.deleted.filter_num_remaining,p=e.deleted.filter_p);var P=.9*Math.min(he,n);_e=_.isNaN(_e)?0:_e,_e-=P*o,_e&&N&&$(this).scrollTop()>_e&&p&&p.isResolved()&&U(B,M,E,k)},50,{leading:!0}));var ue=(Y.members.filter_num_found||0)+(Y.restricted.filter_num_found||0)+(Y.deleted.filter_num_found||0);TS.members.view.team_filter_changed_sig.dispatch(R,ue)}}},"_displayPromiseToSearchResults"),y=d(function(D,Y,J){var B=[];if(Y&&(B=Y.split(/\s*,\s*|\s+/).map(function(O){return O.charAt("0")==="@"?O.substring(1):O}).filter(function(O){return!!O}).map(function(O){if(O.length===1||!J.full_profile_filter){var z=TS.utility.search.makeClause("real_name",O),W=TS.utility.search.makeClause("display_name",O),V=TS.utility.search.makeConjunction("OR",[z,W]);return V}return TS.utility.search.makeClause("fuzzy_with_email",O)})),B.push(TS.utility.search.makeClause("is","user")),J.restricted){var R=TS.utility.search.makeClause("level","restricted"),M=TS.utility.search.makeClause("level","ultra_restricted");B.push(TS.utility.search.makeConjunction("OR",[R,M]))}var E=B.length>1?TS.utility.search.makeConjunction("AND",B):B[0],k={query:E,count:n,include_bots:J.include_bots,exclude_slackbot:J.exclude_slackbot,include_deleted:J.include_deleted};return J.sort&&(k.sort=J.sort),J.sort_dir&&(k.sort_dir=J.sort_dir),J.include_org&&(k.all_of_org=J.include_org),D.filter_cursor_mark&&(k.cursor_mark=D.filter_cursor_mark),J.endpoint&&(k.endpoint=J.endpoint),TS.web&&(k.solr=!0),k},"_buildPromiseToSearchArguments"),T=d(function(D,Y,J){var B=y(D,Y,J);return B.raw_query=Y,TS.utility.search.promiseToSearch(B).then(function(R){if(D.filter_num_remaining||(D.filter_num_remaining=R.data.num_found,D.filter_num_found=R.data.num_found),D.filter_num_remaining-=R.data.items.length,D.filter_cursor_mark=R.data.next_cursor_mark,!R.data.items.length)return Promise.resolve([]);var M=R.data.items.map(function(E){var k=TS.interop.members.getMemberById(E.id);return(!k||!_.isEqual(k,E))&&(k=TS.members.legacyUpsertMember(E).member),k});return!J.restricted&&!J.include_restricted_and_full_members&&(M=M.filter(function(E){return!E.is_restricted})),M.length?Promise.resolve(M):D.filter_num_remaining?T(D,Y,J):Promise.resolve([])})},"_promiseToSearch"),s=d(function(D,Y,J,B){var R=$(Y),M=D.trim();a=M.toLocaleLowerCase();var E=R.data("list-items-id"),k=$(E),O=k.find(".member_item:not(.clone)"),z=O.filter(".active"),W=k.find(".member_item.clone"),V=k.find(".filter_header"),Q=!TS.web&&Y==="#team_filter",K={},te,de,fe;TS.storage.storeFilterState(a);var ue=!1,_e;!_e&&!TS.web&&Y==="#team_filter"&&(_e=$("#team_list_members")),_e&&_e.length&&_e.addClass("hidden"),ue&&(te=O.parent(),de=document.activeElement?$(document.activeElement):null,O.detach()),t[J]&&(t[J].detachEvents(),delete t[J]),W.remove(),V.remove(),z.removeClass("active"),k.find(".no_results").addClass("hidden"),ue&&(te.append(O),de&&de.focus());var he,N,p=[],P=[],I=[];N=TS.members.getMembersForUser(),$(".restricted_header, .bot_header, .ra_invite_prompt, .restricted_info").toggleClass("hidden",!!a),$.each(O,function(ce,pe){var Se;pe=$(pe),Se=pe.data("member-id"),K[Se]=pe});var H=ne(N,a,B.full_profile_filter),ie=Object.keys(H);if(ie.length>0){if(Z(H,ie,K,I,P,p,Q?J:""),J){var re=$(J);re.trigger("resize"),TS.ui.utility.updateClosestMonkeyScroller(re)}}else Y==="#file_member_filter"&&(k.find(".query").text(M),k.find(".no_results").removeClass("hidden"));Y==="#team_filter"&&(he=[{name:"active",label:TS.interop.i18n.t("full members","members_view")(),matches:p},{name:"restricted",label:TS.interop.i18n.t("multi-channel guests","members_view")(),matches:P},{name:"disabled",label:TS.interop.i18n.t("deactivated accounts","members_view")(),matches:I}],he.forEach(function(ce){var pe=$(`#${ce.name}_no_results`);function Se(){var Ee={query:M,tab:ce,active_matches:p,show_active_matches:ce.name!=="active"&&p.length>0,restricted_matches:P,show_restricted_matches:ce.name!=="restricted"&&P.length>0,disabled_matches:I,show_disabled_matches:TS.web&&ce.name!=="disabled"&&I.length>0},ye=TS.templates.team_list_no_results(Ee);pe.removeClass("hidden").html(ye),pe.find(".clear_members_filter").on("click",function(){TS.members.view.clearFilter(Y,J)})}if(d(Se,"noMatchesCase"),ce.matches.length>0){pe.addClass("hidden").empty();return}Se()})),fe=p.concat(P,I),_e&&_e.length&&_e.removeClass("hidden"),TS.ui.utility.updateClosestMonkeyScroller($(J)),TS.members.view.team_filter_changed_sig.dispatch(M,fe.length)},"_filterTeam"),g=d(function(D){return f[D]||D},"_getHeaderLabelForMatchKey"),A=d(function(D,Y){var J=document.createElement("div"),B=document.createElement("strong");return J.classList.add("filter_header"),B.appendChild(document.createTextNode(D)),Y.length&&B.appendChild(document.createTextNode(": ")),J.appendChild(B),Y.forEach(function(R,M){J.appendChild(R),M<Y.length-1&&J.appendChild(document.createTextNode(", "))}),J},"_getFilterHeader"),j=d(function(D,Y){var J=document.createElement("span"),B=document.createElement("strong"),R=D.split(Y);return B.appendChild(document.createTextNode(Y)),J.appendChild(document.createTextNode(R.shift())),J.appendChild(B),J.appendChild(document.createTextNode(R.join(Y))),J},"_getHighlightedValue"),Z=d(function(D,Y,J,B,R,M,E){var k=$(E),O=document.createDocumentFragment(),z=document.createDocumentFragment(),W=document.createDocumentFragment(),V,Q,K;if(Y.sort(function(de,fe){return TS.interop.i18n.sorter(f[de],f[fe])}).forEach(function(de){var fe=document.createDocumentFragment(),ue=document.createDocumentFragment(),_e=document.createDocumentFragment(),he=[],N=[],p=[],P={},I={},H={};D[de].forEach(function(ie){var re=ie.member,ce,pe=!1;re&&re.id&&(ce=J[re.id],ce&&(de==="name"&&!pe?ce.addClass("active"):re.deleted?(V||(V=ce.parent()),ie.value&&!P[ie.value]&&(P[ie.value]=he.push(j(ie.value,ie.match))),fe.appendChild(ce.clone().addClass("active clone").get(0))):re.is_restricted?(Q||(Q=ce.parent()),ie.value&&!I[ie.value]&&(I[ie.value]=N.push(j(ie.value,ie.match))),ue.appendChild(ce.clone().addClass("active clone").get(0))):(K||(K=ce.parent()),ie.value&&!H[ie.value]&&(H[ie.value]=p.push(j(ie.value,ie.match))),_e.appendChild(ce.clone().addClass("active clone").get(0)))),re.deleted?B.push(re):re.is_restricted?R.push(re):M.push(re))}),fe.childNodes&&fe.childNodes.length&&(O.appendChild(A(g(de),he)),O.appendChild(fe)),ue.childNodes&&ue.childNodes.length&&(z.appendChild(A(g(de),N)),z.appendChild(ue)),_e.childNodes&&_e.childNodes.length&&(W.appendChild(A(g(de),p)),W.appendChild(_e)),fe=null,ue=null,_e=null,he=null,N=null,p=null,P=null,I=null,H=null}),V&&V.append(O),Q&&Q.append(z),K&&K.append(W),k.length){var te=k.find(".member_item.clone");t[E]=te.find(".lazy").lazyload({container:k,ignore_when_hidden_element:k,all_images_same_size:!0}),te.one("remove",function(){t[E]&&(t[E].detachEvents(),delete t[E])})}O=null,z=null,W=null,V=null,Q=null,K=null},"_displayMatches"),q=d(function(D){return _.reduce(D,function(Y,J){return J.deleted?J.is_bot?Y.deleted_bots.push(J):Y.disabled_members.push(J):J.is_ultra_restricted?Y.ultra_restricted_members.push(J):J.is_restricted?Y.restricted_members.push(J):J.is_bot||TS.interop.rules.members.isSlackbot(J)?Y.bots.push(J):Y.members.push(J),Y},{members:[],disabled_members:[],deleted_bots:[],bots:[],restricted_members:[],ultra_restricted_members:[]})},"_legacyAllocateTeamListMembers"),ne=d(function(D,Y,J){var B=new RegExp(`^${TS.utility.regexpEscape(Y)}`,"i"),R=new RegExp(`(-|_|\\+|\\s|\\.|@)${TS.utility.regexpEscape(Y)}`,"i"),M={},E=J&&Y?TS.team.getVisibleTeamProfileFields():[];return f={title:"What I Do",name:"Name"},D.forEach(function(k){var O;O=k._real_name_lc&&(k._real_name_lc.match(B)||k._real_name_lc.match(R))||k.email&&(k.email.match(B)||k.email.match(R))||k.profile&&k.profile.email&&(k.profile.email.match(B)||k.profile.email.match(R))||k.profile&&k.profile.real_name_normalized&&(k.profile.real_name_normalized.match(B)||k.profile.real_name_normalized.match(R))||k.profile&&k.profile.real_name&&(k.profile.real_name.match(B)||k.profile.real_name.match(R))||k.profile&&k.profile.display_name_normalized&&(k.profile.display_name_normalized.match(B)||k.profile.display_name_normalized.match(R))||k.profile&&k.profile.preferred_name&&(k.profile.preferred_name.match(B)||k.profile.preferred_name.match(R)),O&&(M.name||(M.name=[]),M.name.push({member:k})),J&&Y&&(O=k.profile&&k.profile.title&&(k.profile.title.match(B)||k.profile.title.match(R)),O&&(M.title||(M.title=[]),M.title.push({member:k}))),E.length&&k.profile&&k.profile.fields&&E.forEach(function(z){var W=k.profile.fields[z.id];if(W){if(O=null,z.type==="user"){if(W.value){var V="";W.value.split(/\s*,\s*/).some(function(Q){return V=TS.interop.rules.members.getPrefCompliantMemberNameById(Q,!1),V.match(B)||V.match(R)}),O&&(M[z.id]||(M[z.id]=[]),M[z.id].push({member:k,value:V,match:O[0]}))}}else O=W.value&&(W.value.match(B)||W.value.match(R)),O?(M[z.id]||(M[z.id]=[]),M[z.id].push({member:k,value:W.value,match:O[0]})):(O=W.alt&&(W.alt.match(B)||W.alt.match(R)),O&&(M[z.id]||(M[z.id]=[]),M[z.id].push({member:k,value:W.alt,match:O[0]})));O&&!f[z.id]&&(f[z.id]=z.label)}})}),M},"_findMatchesInMemberList"),oe=d(function(){return Promise.resolve()},"_maybeFetchGuestChannels")})()},T0l3:function(se,ae){(function(){TS.registerModule("automount",{onStart:function(){var a=TS.redux.getStoreInstance();setTimeout(()=>{TS.interop.automount.mountAllWithStore(a)},0)}})})()},UP61:function(se,ae){(function(){TS.registerModule("ui.validation",{completed_sig:new signals.Signal,onStart:function(){v(),$("body").on("input.validation paste.validation change.validation","[data-validation]",TS.utility.debounce(function(p){$(p.target).is(".ql-editor")||$(p.target).is(".ql-clipboard")?S($(p.target).closest(".ql-container"),{},p):S($(p.target),{},p)},500)),$("body").on("input.channel-name-validation paste.channel-name-validation change.channel-name-validation",'[data-validation*="channel_name"]',function(p){const P=$(p.target);if(!P.is('input[type="text"]'))return;const I={query:he(P),count:1};TS.interop.channels.fetchAndUpsertChannelsWithQuery({query:I})}),$("body").on("submit.validation","form[data-validation-form]",function(p){var P=$(p.target),I=TS.ui.validation.validate(P);I||p.preventDefault(),TS.ui.validation.completed_sig.dispatch(P,{event:p,passed:I})})},validate:function(p,P){P=P||{};var I=document;if(p){if(p.is("[data-validation]"))return p.length===1?S(p,P):p.toArray().every(function(re){return S($(re),P)});I=p.get(0)}var H=Array.prototype.slice.call(I.querySelectorAll("[data-validation]"));if(P&&P.fast)return H.every(function(re){return S($(re),P)});if(P&&P.verbose){var ie={};return H.forEach(function(re){ie[re.name]=S($(re),P)}),ie}return H.reduce(function(re,ce){return S($(ce),P)&&re},!0)},register:function(p,P){if(m[p]){TS.warn(`${p} cannot be registered because that key is already in use.`);return}if(typeof P!="function"){TS.warn("Only functions can be registered as validators.");return}m[p]=P},showCustomValidation:function(p,P,I,H){W(p,I.error_message||P,I.class,I,H)},getErrorMessage:function(p,P){switch(p){case"invalid_name_required":return l.required;case"invalid_name_punctuation":return l.punctuation;case"invalid_name_maxlength":return l.maxlength;case"invalid_name_specials":return l.specials;case"name_taken":return l.name_taken({name:P.name});case"restricted_action":return c.restricted_action;case"name_invalid_name_required":return o.required;case"invalid_starts_with_at":return o.at_sign;case"name_invalid_name_maxlength":case"too_long":return o.maxlength;case"invalid_reserved_word":return o.reserved;case"name_invalid_name_specials":return o.specials;case"invalid_emoji_not_allowed":return N(P.name||"");case"display_name_not_allowed":return o.sso_display_name;case"invalid_email":return h.invalid;case"url_in_message":return u.url_in_message;case"invalid_target_domain":return e.invalid_target_domain;case"invalid_target_domain_sameorg":return e.invalid_target_domain_sameorg;case"invalid_target_domain_self":return e.invalid_target_domain_self;default:return TS.interop.i18n.t("For some weird reason, that didn\u2019t work. Please try again to continue.","ui_validation")()}},maybeConvertNameErrorCode:function(p){return p==="invalid_name_specials"?"name_invalid_name_specials":p==="invalid_name_maxlength"?"name_invalid_name_maxlength":p==="invalid_name_required"?"name_invalid_name_required":p},showError:function(p,P,I,H){W(p,I.error_message||P,"validation_error",I,H)},showWarning:function(p,P,I,H){W(p,I.warning_message||P,"validation_warning",I,H)},showSuccess:function(p,P,I,H){W(p,I.success_message||P,"validation_success",I,H)},test:function(){return{validations:m}}});var a=80,t=80,f=21,i=TS.interop.i18n.t("Channel names can\u2019t be longer than {maxLength} characters.","ui_validation")({maxLength:t}),l={name_taken:TS.interop.i18n.t("{name} is already taken by a channel, username, or user group.","ui_validation"),lowercase:TS.interop.i18n.t("Channel names must be all lowercase. Try again?","ui_validation")(),maxlength:i,required:TS.interop.i18n.t("Don\u2019t forget to name your channel.","ui_validation")(),specials:TS.interop.i18n.t("Channel names can\u2019t contain spaces, periods, or most punctuation. Try again?","ui_validation")(),punctuation:TS.interop.i18n.t("Names can\u2019t consist solely of punctuation. Please elaborate!","ui_validation")()},e={invalid_target_domain:TS.interop.i18n.t("{targetDomain}.slack.com\xA0doesn\u2019t appear to be in use.","shared"),invalid_target_domain_sameorg:TS.interop.i18n.t("{targetDomain} is a part of your organization.","shared"),invalid_target_domain_self:TS.interop.i18n.t("You\u2019ll need to enter the Slack URL of the other organization.","shared")()},n={firstalphanumeric:TS.interop.i18n.t("Usernames must start with a letter or number. Sorry about that!","ui_validation")(),lowercase:TS.interop.i18n.t("Sorry, usernames must be lowercase!","ui_validation")(),maxlength:TS.interop.i18n.t("Sorry, that\u2019s a bit too long! Usernames must be fewer than {max_length_plus_one} characters.","ui_validation","10f62c929475d76c2b47d666c9703843310ef356")({max_length_plus_one:f+1}),required:TS.interop.i18n.t("Please fill in a username.","ui_validation")(),specials:TS.interop.i18n.t("Usernames can\u2019t contain special characters. Sorry about that!","ui_validation")()},o={required:TS.interop.i18n.t("Unfortunately, you can\u2019t leave this blank.","ui_validation")(),at_sign:TS.interop.i18n.t("Names can\u2019t start with the @ sign \u2014\xA0that\u2019s how your coworkers will mention you in conversation.","ui_validation","dbbcef363a405836bfc582044f84fec0a0a1cc64")(),maxlength:TS.interop.i18n.t("Unfortunately, names can\u2019t be longer than {maxlength} characters.","ui_validation")({maxlength:a}),reserved:TS.interop.i18n.t("That name\u2019s already being used by Slack.","ui_validation")(),specials:TS.interop.i18n.t("Mostly, names can\u2019t contain punctuation. (Apostrophes, spaces, and periods are fine.)","ui_validation")(),emoji:TS.interop.i18n.t("For all manner of complex reasons, names simply cannot contain emoji. Try again?","ui_validation")(),sso_display_name:TS.interop.i18n.t("Display names are automatically set by your organization.","ui_validation")()},c={},v=d(function(){c={restricted_action:TS.interop.i18n.t("Sorry! An admin in your workspace has restricted who can create private channels.","ui_validation")()}},"_initMpimErrorMessages"),h={invalid:TS.interop.i18n.t("This doesn\u2019t seem like an email address. Sorry!","ui_validation")()},u={url_in_message:TS.interop.i18n.t("Unfortunately, custom messages can\u2019t contain URLs.","ui_validation")()},m={dateandformat:q,firstalphanumeric:D,hasnourl:y,isurl:ee,isouathredirecturl:F,lowercase:ne,maxcsv:j,maxlength:s,mincsv:A,minlength:T,nospace:oe,required:w,reservedwords:x,keywords:U,username:Y,channel_name:B,team_name:R,is_email:M,membername:J,is_time:k},S=d(function(p,P,I){P=P||{},p.is("[data-validation-for]")&&(P.custom_for=p.attr("data-validation-for")),P.success_message=TS.interop.i18n.t("Nice, thanks!","ui_validation")(),p.is("[data-validation-success]")&&(P.success_message=p.attr("data-validation-success")),p.is("[data-validation-warning]")&&(P.warning_message=p.attr("data-validation-warning")),p.is("[data-validation-error]")&&(P.error_message=p.attr("data-validation-error")),p.is("[data-validation-trim-value]")&&(P.trim_value=!0),fe(p)&&de(p,P);var H=b(p).every(function(ie){if(ie.indexOf("=")===-1)return m[ie.trim()](p,P);var re=ie.split("=");return m[re[0]](p,P,re[1])});return TS.ui.validation.completed_sig.dispatch(p,{event:I,passed:H}),z(p,H,P)&&TS.ui.validation.showSuccess(p,P.success_message,P,3e3),p.attr("aria-invalid",!H),H},"_validate"),b=d(function(p){return p.is("[data-validation]")?_.compact(p.attr("data-validation").replace(/\s*(,|=)\s*/g,"$1").split(/\s+/)):[]},"_getValidators");function w(p,P){if(p.is('input[type="radio"]')){if($(document.querySelectorAll(`[name="${p.prop("name")}"][data-validation]`)).filter(":checked").length)return!0;TS.ui.validation.showWarning(p,TS.interop.i18n.t("Please select an option","ui_validation")(),P)}else if(p.is('input[type="checkbox"]')){if($(document.querySelectorAll(`[name="${p.prop("name")}"][data-validation]`)).filter(":checked").length)return!0;TS.ui.validation.showWarning(p,TS.interop.i18n.t("Please select at least one option","ui_validation")(),P)}else if(p.is("select")){var I=_.get(p.data(),"TSLazyFilterSelect",!1);if(I&&!_.isEmpty(I.value())||!I&&!_.isEmpty(p.val()))return!0;TS.ui.validation.showWarning(p,TS.interop.i18n.t("Please select an option","ui_validation")(),P)}else if(fe(p)){if(ue(p).trim())return!0;TS.ui.validation.showWarning(p,TS.interop.i18n.t("This field can\u2019t be empty","ui_validation")(),P)}else TS.error("Error: cannot validate")}d(w,"_validateRequired");function x(p,P,I){if(p.is('input[type="radio"]')||p.is('input[type="checkbox"]')||p.is("select"))return!0;if(fe(p)){var H=ue(p).trim().toLowerCase(),ie=I.split(",");if(ie.indexOf(H)===-1)return!0;TS.ui.validation.showWarning(p,TS.interop.i18n.t('"{word}" is a reserved word. Try something else!',"ui_validation")({word:TS.interop.i18n.safeString(_.escape(H))}),P)}else TS.error("WTF: cannot validate")}d(x,"_validateReservedWords");function U(p,P){return x(p,P,TS.model.RESERVED_KEYWORDS.join(","))}d(U,"_validateKeywords");function ee(p,P,I){var H=ue(p);P&&P.trim_value&&(H=H.trim());var ie=TS.interop.i18n.t("This doesn\u2019t seem like a proper link. Sorry!","ui_validation")(),re,ce=!1,pe=!1;if(!H||p.is('input[type="radio"]')||p.is('input[type="checkbox"]')||p.is("select"))return!0;if(!fe(p)){TS.error("Error: cannot validate");return}if(I){re=I.split(","),re.indexOf("http")!=-1&&re.indexOf("https")==-1&&re.push("https");for(var Se=0;Se<re.length;Se+=1)H.indexOf(`${re[Se]}://`)===0&&(ce=!0);!ce&&re.indexOf("https")!=-1&&(ie=TS.interop.i18n.t("Please use https (for security).","ui_validation")())}else ce=!0,H.indexOf("://")==-1&&(H=`http://${H}`);if(pe=TS.interop.url.simpleIsUrl(H),pe&&ce)return!0;TS.ui.validation.showWarning(p,ie,P)}d(ee,"_validateIsUrl");function F(p,P,I){if(ee(p,P,I)){var H=ue(p);if(H.indexOf("#")==-1)return!0;const ie=TS.interop.i18n.t("Oauth redirect URLs should not contain a fragment component (#)","ui_validation")();TS.ui.validation.showWarning(p,ie,P)}}d(F,"_validateIsOauthRedirectUrl");function y(p,P){if(p.is('input[type="radio"]')||p.is('input[type="checkbox"]')||p.is("select"))return!0;if(fe(p)){var I=ue(p);if(!I||!TS.interop.url.findUrlsInString(I).length)return!0;TS.ui.validation.showWarning(p,u.url_in_message,P)}else TS.error("Error: cannot validate")}d(y,"_validateHasNoUrl");function T(p,P,I,H){return g(p,"minlength",P,I,H)}d(T,"_validateMinLength");function s(p,P,I,H){return g(p,"maxlength",P,I,H)}d(s,"_validateMaxLength");function g(p,P,I,H,ie){if(p.is('input[type="radio"]')||p.is('input[type="checkbox"]')||p.is("select"))return!0;if(fe(p)){var re=ue(p);if(H=+H,re===void 0||isNaN(H)){TS.error("Error: no length to validate");return}if(P==="minlength"){if(TS.interop.utility.getStringLength(re)>=H)return!0;TS.ui.validation.showError(p,TS.interop.i18n.t("This field can\u2019t be less than {minlength, plural, =1{# character}other{# characters}}","ui_validation")({minlength:H}),I)}else if(P==="maxlength"){if(ie||K(p,re.length,H,I),TS.interop.utility.getStringLength(re)<=H)return!0;TS.ui.validation.showError(p,TS.interop.i18n.t("This field can\u2019t be more than {maxlength, plural, =1{# character}other{# characters}}","ui_validation")({maxlength:H}),I)}}else TS.error("Error: cannot validate")}d(g,"_validateLength");function A(p,P,I){return Z(p,"mincsv",P,I)}d(A,"_validateMinCSV");function j(p,P,I){return Z(p,"maxcsv",P,I)}d(j,"_validateMaxCSV");function Z(p,P,I,H){if(p.is('input[type="radio"]')||p.is('input[type="checkbox"]')||p.is("select"))return!0;if(fe(p)){var ie=ue(p).trim();if(H=+H,ie===void 0||isNaN(H)){TS.error("Error: no length to validate");return}if(P==="mincsv"){if(ie.split(/\s*,\s*/).length>=H)return!0;TS.ui.validation.showError(p,TS.interop.i18n.t("This field can\u2019t have less than {minlength, plural, =1{# value}other{# values}}","ui_validation")({minlength:H}),I)}else if(P==="maxcsv"){if(ie.split(/\s*,\s*/).length<=H)return!0;TS.ui.validation.showError(p,TS.interop.i18n.t("This field can\u2019t have more than {maxlength, plural, =1{# value}other{# values}}","ui_validation")({maxlength:H}),I)}}else TS.error("Error: cannot validate")}d(Z,"_validateCSV");function q(p,P,I){if(p.is('input[type="radio"]')||p.is('input[type="checkbox"]')||p.is("select"))return!0;if(fe(p)){var H=ue(p).trim();if(!H)return!0;var ie,re,ce,pe;switch(I){case"Y-m-d":ie="YYYY-MM-DD",re=H.match(/^[0-9]{4}-[0-9]{2}-[0-9]{2}$/),ce=re&&re.length===1&&re[0]===H,ce&&(pe=O(`${H}T00:00:00.000Z`));break;case"m-d":ie="MM-DD",re=H.match(/^[0-9]{2}-[0-9]{2}$/),ce=re&&re.length===1&&re[0]===H,ce&&(pe=O(`0000-${H}T00:00:00.000Z`));break;default:TS.error("Error: cannot validate");return}if(ce&&pe)return!0;ce?pe||TS.ui.validation.showWarning(p,TS.interop.i18n.t("{value} doesn\u2019t appear to be a valid date. Sorry!","ui_validation")({value:TS.interop.i18n.safeString(_.escape(H))}),P):TS.ui.validation.showWarning(p,TS.interop.i18n.t("This needs to be in the format {pattern}. Sorry!","ui_validation")({pattern:ie}),P)}else TS.error("Error: cannot validate")}d(q,"_validateDateAndFormat");function ne(p,P){var I=fe(p)?ue(p):p.val(),H=I===I.toLocaleLowerCase();if(H)return!0;TS.ui.validation.showWarning(p,TS.interop.i18n.t("This field must be lowercase only","ui_validation")(),P)}d(ne,"_validateLowercase");function oe(p,P){var I=fe(p)?ue(p):p.val(),H=/\s/.test(I);if(!H)return!0;TS.ui.validation.showWarning(p,TS.interop.i18n.t("This field can\u2019t contain spaces","ui_validation")(),P)}d(oe,"_validateNospace");function D(p,P){var I=fe(p)?ue(p):p.val(),H=/^[^\W_]/.test(I);if(H)return!0;TS.ui.validation.showWarning(p,TS.interop.i18n.t("This first character must be a letter or number","ui_validation")(),P)}d(D,"_validateFirstAlphanumeric");function Y(p,P){var I=$.extend({},P,{quiet:!0});if(!w(p,I))TS.ui.validation.showWarning(p,n.required,P);else if(!s(p,I,f,!0))TS.ui.validation.showWarning(p,n.maxlength,P);else if(!oe(p,I))TS.ui.validation.showWarning(p,n.specials,P);else if(!E(p,I,/^[\w._-]+$/))TS.ui.validation.showWarning(p,n.specials,P);else if(!D(p,I))TS.ui.validation.showWarning(p,n.firstalphanumeric,P);else if(!ne(p,I))TS.ui.validation.showWarning(p,n.lowercase,P);else return!!x(p,P,TS.interop.constants.RESERVED_USERNAMES.join(","))}d(Y,"_validateUsername");function J(p,P,I){var H=$.extend({},P,{quiet:!0});if(p.is('input[type="radio"]')||p.is('input[type="checkbox"]')||p.is("select"))return!0;if(!fe(p)){TS.error("Error: cannot validate");return}var ie=_.trim(ue(p)),re=TS.interop.i18n.deburr(ie.toLowerCase()),ce=_e(I);if(_.includes(ce,"required")&&!w(p,H))return TS.ui.validation.showWarning(p,o.required,P),!1;if(!s(p,H,a,!0))return TS.ui.validation.showWarning(p,o.maxlength,P),!1;var pe=TS.interop.constants.RESERVED_USERNAMES.concat(TS.model.RESERVED_KEYWORDS).map(function(Se){return TS.interop.i18n.deburr(Se)});return pe.indexOf(re)!==-1?(TS.ui.validation.showWarning(p,o.reserved,P),!1):ie.charAt(0)==="@"?(TS.ui.validation.showWarning(p,o.at_sign,P),!1):E(p,H,/^[-_.'\u2018\u2019",(){}[\]/;]+$/)?(TS.ui.validation.showWarning(p,l.punctuation,P),!1):E(p,H,/[`~!@#$%^&*+=\\:"<>?|]/)?(TS.ui.validation.showWarning(p,o.specials,P),!1):TS.emoji.hasUnifiedEmoji(ie)?(TS.ui.validation.showWarning(p,N(ie),P),!1):!0}d(J,"_validateRealOrDisplayName");function B(p,P,I){if(p.is('input[type="radio"]')||p.is('input[type="checkbox"]')||p.is("select"))return!0;if(!fe(p)){TS.error("Error: cannot validate");return}var H=ue(p),ie=_e(I),re=_.includes(ie,"fix");re&&(H=he(p));var ce=TS.validation.channel_name_with_errors(H);return ce!==!0?(P.should_truncate=!1,TS.ui.validation.showWarning(p,ce.error_message,P),!1):!0}d(B,"_validateChannelName");function R(p,P){P=P||{};var I=ue(p).trim(),H=TS.validation.team_name(I);return H!==!0?(P.should_truncate=!1,H.error_key==="empty"?TS.ui.validation.showCustomValidation(p,H.error_message,P):TS.ui.validation.showError(p,H.error_message,P),!1):!0}d(R,"_validateTeamName");function M(p,P){if(p.is('input[type="radio"]')||p.is('input[type="checkbox"]')||p.is("select"))return!0;if(fe(p)){var I=ue(p);if(!I)return!0;var H=I.match(TS.utility.email_regex);if(H&&H.length===1&&H[0]===I)return!0;TS.ui.validation.showWarning(p,h.invalid,P)}else TS.error("Error: cannot validate")}d(M,"_validateIsEmail");function E(p,P,I){var H=fe(p)?ue(p):p.val();if(!I.test(H))TS.ui.validation.showWarning(p,TS.interop.i18n.t("This field contains invalid characters","ui_validation")(),P);else return!0}d(E,"_validatePattern");function k(p){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(p.is('input[type="radio"]')||p.is('input[type="checkbox"]')||p.is("select"))return!0;if(fe(p)){var I=ue(p);if(!I||/((1[0-2]|0?[1-9]):([0-5][0-9]) ?([ap][m]))/i.test(I))return!0;TS.ui.validation.showWarning(p,"Try the format 10:30am",P)}}d(k,"_validateTime");var O=d(function(p){if(!isNaN(Date.parse(p))){var P=new Date(p);return!P.toISOString().indexOf(p)}},"_isValidISODate"),z=d(function(p,P,I){var H=$(document.querySelector(`label[for="${I.custom_for||p.attr("name")}"]`));if(H.length)return!(I&&I.quiet)&&P&&H.data("validation-ephemeral")===!1},"_shouldShowSuccess"),W=d(function(p,P,I,H,ie){if(H=H||{},_.isUndefined(H.should_truncate)&&(H.should_truncate=!0),!(H&&H.quiet)){var re=$(document.querySelector(`label[for="${H.custom_for||p.attr("name")}"]`));if(re.length){var ce=re.data("validation-timeout");clearTimeout(ce);var pe=re.find(".validation_message");if(pe.length||(pe=$("<span />").addClass("validation_message").toggleClass("overflow_ellipsis",H.should_truncate),p.is("select")&&re.find("select").length?pe.insertBefore(re.find("select")):pe.appendTo(re)),Q(p,re,I),!P){pe.remove();return}pe.get(0).title=P,pe.fadeIn(100),re.data("validation-ephemeral",!!ie),ie&&re.data("validation-timeout",setTimeout(function(){re.removeData("validation-ephemeral").removeData("validation-timeout"),pe.fadeOut(100,function(){Q(p,re),pe.remove()})},ie))}}},"_showMessage"),V=["validation_error","validation_warning","validation_success"],Q=d(function(p,P,I){P.hasClass(I)||(p.removeClass(V.join(" ")),p.addClass(I),P.removeClass(V.join(" ")),P.addClass(I))},"_toggleValidationLevel"),K=d(function(p,P,I,H){I-P<=6?te(p,P,I,H):de(p,H)},"_countdown"),te=d(function(p,P,I,H){var ie=document.querySelector(`label[for="${H.custom_for||p.attr("name")}"]`);if(ie){var re=[P,I].join("/");$(ie).attr("data-countdown",re).addClass("countdown");var ce=window.getComputedStyle(ie,":after"),pe=parseFloat(ce.width)||9*re.length;p.hasClass("no_validation_padding")||(p.data("countdown-padding-right")||p.data("countdown-padding-right",parseFloat(p.css("padding-right"))),p.css("padding-right",pe+parseFloat(ce.right)+p.data("countdown-padding-right")))}},"_setCountdown"),de=d(function(p,P){var I=document.querySelector(`label[for="${P.custom_for||p.attr("name")}"]`);I&&($(I).removeClass("countdown"),p.removeData("countdown-padding-right"),p.css("padding-right",""))},"_clearCountdown"),fe=d(function(p){return TS.interop&&TS.interop.utility?p.is("input")||p.is("textarea")||TS.interop.utility.isContentEditableElement(p):p.is("input")||p.is("textarea")},"_isElementTextInput"),ue=d(function(p){return TS.utility&&TS.utility.contenteditable?TS.utility.contenteditable.value(p):p.val()},"_getTextInputValue"),_e=d(function(p){return _.isString(p)?_(p).split(",").map(_.trim).compact().value():[]},"_parseParams"),he=d(function(p){var P=ue(p),I=P.toLowerCase().replace(/^#+/,"");if(I=I.replace(/^\s+/,""),I=I.replace(/\s+$/,""),I=I.replace(/\s/g,"-"),I&&P!==I){var H=TS.utility.contenteditable.cursorPosition(p).start;I.length<P.length&&(H-=P.length-I.length),p.val(I),TS.utility.contenteditable.cursorPosition(p,H)}return I},"_fixChannelName"),N=d(function(p){var P=//u,I=[TS.interop.i18n.t("For all manner of complex reasons, names simply cannot contain emoji. Try again?","ui_validation")(),TS.interop.i18n.t("Using emoji for names makes some sense, but sadly, not enough. Try again?","ui_validation","29a0641ffb224418f796bb16c7f79013ec377a4c")(),TS.interop.i18n.t("For technical reasons, emoji are not allowed in names. Try again?","ui_validation")(),TS.interop.i18n.t("Of course you want a name with an emoji. Sadly, it is not to be. Try letters?","ui_validation")()];return p.match(P)?TS.interop.i18n.t("For reasons of party-pooping, names cannot contain emoji. Try again?","ui_validation")():_.sample(I)},"_getInvalidNameEmojiErrorMessage")})()},VACg:function(se,ae){(function(){TS.registerModule("redux.members",{onStart:function(){TS.boot_data.no_login||(t=TS.utility.enableFeatureForUser(1),i(),Object.defineProperty(TS.model,"members",{get:function(){return TS.redux.members.getAllMembers()},set:function(){return TS.boot_data.feature_tinyspeck&&TS.warn("TS.redux.members: Set TS.model.members"),!1}}),Object.defineProperty(TS.model,"user",{get:function(){return TS.interop.members.getCurrentMember()}}))},getPotentiallyUnknownMemberById:function(l){if(l&&l[0]==="@"&&(l=l.substring(1)),!TS.interop.utility.looksLikeMemberId(l)){if(t&&TS.console.logStackTraceToBackEnd("non-ID passed into getPotentiallyUnknownMemberById","member_name_as_id_lookup",1),TS.boot_data.feature_deprecate_get_member_by_name)return null;const n=TS.interop.members.getMemberByName(l);if(n)return n}const e=TS.interop.members.getPotentiallyUnknownMemberById(l);return e?e.isUnknown?(TS.members.legacySetMemberUnknown(l),_.omit({...e,is_unknown:!0},"isUnknown")):e.isNonExistent?_.omit({...e,is_non_existent:!0},"isNonExistent"):e:null},getMemberByEmail:function(l){var e=TS.interop.members.getMemberByEmail(l);return!e||!e.profile?null:e},getAllMembers:function(){var l=TS.interop.members.getAllMembers();return _.values(l)},hasMemberWithId:function(l){return TS.interop.members.hasMemberWithId(l)},test:function(){var l={_addSignalListeners:i};return Object.defineProperty(l,"_bulk_upsert_payload",{get:function(){return a},set:function(e){a=e}}),l}});var a=[],t,f=d(function(){a.length&&(TS.interop.members.markObjectsAsFresh(a.map(l=>l.id)),TS.interop.members.dangerouslyBulkAddMembers(a),a=[])},"_bulkUpsertMembers"),i=d(function(){TS.members.batch_upserted_sig.add(f)},"_addSignalListeners")})()},VTIS:function(se,ae){(function(){TS.registerModule("ui.a11y",{unread_message_strings:{},$aria_live_div:null,zoom_level_changed_sig:new signals.Signal,onStart:function(){i(),c(),h(),TS.channels.switched_sig.add(TS.ui.a11y.annouceCurrentChannelOrImOrGroup),TS.ims.switched_sig.add(TS.ui.a11y.annouceCurrentChannelOrImOrGroup),TS.groups.switched_sig.add(TS.ui.a11y.annouceCurrentChannelOrImOrGroup),TS.mpims.switched_sig.add(TS.ui.a11y.annouceCurrentChannelOrImOrGroup),$(document).on("focus","input[placeholder],textarea[placeholder]",function(b){f($(b.target))}),$(document).on("blur","input[placeholder],textarea[placeholder]",function(b){f($(b.target))})},focusAndAddTabindex:function(b){b&&(b.attr("tabindex")&&b.data("previous-tabindex",b.attr("tabindex")),b.attr("tabindex","0"),b.focus())},ariaLiveAnnounce:function(b,w){TS.ui.a11y.$aria_live_div.empty(),TS.ui.a11y.$aria_live_div.attr("aria-live",w?"assertive":"polite"),TS.ui.a11y.$aria_live_div.text(b)},assembleActiveModelName:function(){var b=TS.shared.legacyGetActiveModelOb(),w;if(!b)return"";if(b.is_channel)w=TS.interop.i18n.t("Channel #{model_name}","a11y")({model_name:b.name});else if(b.is_im)w=TS.interop.i18n.t("Direct message with {model_name}","a11y")({model_name:TS.interop.rules.members.getPrefCompliantMemberNameById(b.user)});else if(b.is_mpim)w=TS.interop.i18n.t("Direct message with {model_name}","a11y")({model_name:TS.mpims.legacyGetDisplayName(b)});else if(b.is_group)w=TS.interop.i18n.t("Private Channel {model_name}","a11y")({model_name:b.name});else return"";return w},annouceCurrentChannelOrImOrGroup:function(){var b=TS.ui.a11y.assembleActiveModelName(),w=b,x=TS.shared.legacyGetActiveModelOb();x&&(TS.ui.a11y.unread_message_strings[x.name]&&(w+=`, ${TS.ui.a11y.unread_message_strings[x.name]}`,delete TS.ui.a11y.unread_message_strings[x.name]),TS.ui.a11y.ariaLiveAnnounce(w,!0))},getContrastColor:function(b){var w=!1;if(b=b.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(y,T,s,g){return T+T+s+s+g+g}),b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b),b){var x=parseInt(b[1],16),U=parseInt(b[2],16),ee=parseInt(b[3],16),F=(x*299+U*587+ee*114)/1e3;w=F>=128?"#000000":"#FFFFFF"}return w},test:function(){return{createAriaLiveElement:i,destroyAriaLiveElement:l,getMessageInputElement:e,getMessageDivElement:n}}});var a={70:"-3",80:"-2",90:"-1",normal:"0",110:"1",125:"2",150:"3"},t=Object.keys(a).reduce(function(b,w){return b[a[w]]=w,b},{}),f=d(function(b){var w=b.attr("placeholder"),x=b.attr("aria-label")||"",U=!!x.length,ee=!!b.val().trim().length;if(ee&&!U&&w.length){b.attr("aria-label",w);return}!ee&&U&&x==w&&b.removeAttr("aria-label")},"_labelWithPlaceholder"),i=d(function(){return TS.ui.a11y.$aria_live_div=$('<div id="aria_live_announcer" role="status"></div>'),$("body").append(TS.ui.a11y.$aria_live_div),TS.ui.a11y.$aria_live_div},"_createAriaLiveElement"),l=d(function(){TS.ui.a11y.$aria_live_div.remove(),delete TS.ui.a11y.$aria_live_div},"_destroyAriaLiveElement"),e=d(function(){return $()},"_getMessageInputElement"),n=d(function(){return $()},"_getMessageDivElement"),o,c=d(function(){TS.model.is_electron&&(o=TS.interop.desktop.getZoom(),$(window).on("resize",v))},"_bindResizeListener"),v=d(function(){var b=TS.interop.desktop.getZoom();o!=b&&(o=b,TS.ui.a11y.zoom_level_changed_sig.dispatch({zoom_level:b}))},"_onResize"),h=d(function(){TS.model.is_electron&&($("body").append('<div class="zoom_level_indicator hidden"></div>'),TS.ui.a11y.zoom_level_changed_sig.add(S))},"_createZoomLevelIndicatorUI"),u=d(function(b){var w=t[b]||"100",x=w==="normal"?"100":w,U=TS.interop.i18n.t("zoom: <strong>{zoom_percentage}%</strong>","a11y")({zoom_percentage:x});$(".zoom_level_indicator").html(U)},"_setZoomLevel"),m,S=d(function(b){if(!$("body").hasClass("loading")){var w=$(".prefs_modal.active");if(!(w.length&&w.find(".a11y_pref_zoom").length)){m&&(clearTimeout(m),m=null),u(b.zoom_level);var x=$(".zoom_level_indicator");x.insertAfter(document.body.lastElementChild),x.removeClass("hidden").show(0);var U=x.outerWidth()/2,ee=`calc(50vw - ${U}px)`;x.css("left",ee),m=setTimeout(function(){x.fadeOut(100)},1e3)}}},"_showZoomLevel")})()},W17R:function(se,ae){(function(){TS.registerModule("shared",{onStart:function(){},test:function(){var e={};return Object.defineProperty(e,"_queried_usernames",{get:function(){return t},set:function(n){t=n}}),e},legacySetOldestUnreadTsForId:function(e,n){e&&(a[e]=n)},legacyGetActiveModelOb:function(){var e;return TS.boot_data.channel_id?e=TS.interop.channels.getPublicChannelById(TS.boot_data.channel_id):TS.boot_data.im_id?e=TS.interop.channels.getImById(TS.boot_data.im_id):TS.boot_data.mpim_id?e=TS.interop.channels.getMpimById(TS.boot_data.mpim_id):TS.boot_data.group_id?e=TS.interop.channels.getGroupById(TS.boot_data.group_id):(TS.warn("error getActiveModelOb found no ob"),TS.warn(`TS.boot_data.channel_id: ${TS.boot_data.channel_id}`),TS.warn(`TS.boot_data.im_id: ${TS.boot_data.im_id}`),TS.warn(`TS.boot_data.group_id: ${TS.boot_data.group_id}`)),e},promiseToRefetchModelOb:function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"TS.shared.promiseToRefetchModelOb";if(!e||typeof e!="string")return Promise.resolve();const o=[e];return TS.interop.channels.fetchAndUpsertChannelsFromFlannel({ids:o}).then(c=>{let{channels:v}=c;return _.isEmpty(v)?TS.interop.channels.fetchAndUpsertChannelsFromAPI({ids:o,reason:n}):{channels:v}}).then(c=>{let{channels:v}=c;return v&&v[0]})},ensureModelObsArePresent:function(e,n){return!e||!e.length?Promise.resolve():TS.interop.channels.fetchAndUpsertChannelsById({ids:e,reason:n}).then(o=>{let{missing:c}=o;return _.isEmpty(c)||c.forEach(v=>TS.interop.channels.upsertChannel({id:v,isNonExistent:!0})),Promise.resolve()})},legacyEnsureModelObsInDataArePresent:function(e,n){const o=TS.interop.utility.extractAllModelObIds(e);return n==="search.messages"&&TS.boot_data.page_needs_enterprise&&i(e,o),TS.shared.ensureModelObsArePresent(o,n)},legacyBatchUpsertObjects:function(e){TS.has_pri[l]&&TS.log(l,`Flannel: upserting batch of ${e.length} objects`);var n=[],o=[],c=[];_.forEach(e,function(S){TS.interop.utility.looksLikeMemberId(_.get(S,"id"))?TS.redux.members.hasMemberWithId(S.id)?n.push(S):o.push(S):f(S)&&c.push(S)});var v=!!o.length,h=[];function u(S){TS.has_pri[l]&&TS.log(l,`Flannel: upserting and signaling user ${S.id} from query results`);var b=TS.members.legacyUpsertAndSignal(S).member;h.push(b)}d(u,"upsertAndSignalMember");function m(S){TS.has_pri[l]&&TS.log(l,`Flannel: upserting user ${S.id} from query results`);var b=TS.members.legacyUpsertMember(S).member;h.push(b)}return d(m,"upsertMember"),n.forEach(u),v&&(TS.members.legacyStartBatchUpsert(),o.forEach(m),TS.members.legacyFinishBatchUpsert()),c.length&&(TS.redux.bots.bulkUpsertBots(c),c.forEach(S=>{TS.has_pri[l]&&TS.log(l,`Flannel: upserting bot ${S.id} from query results`);var b=TS.interop.bots.getBotById(S.id);h.push(b)})),h}});var a={},t={},f=d(function(e){var n=_.get(e,"id[0]");return n==="B"},"_isBot");function i(e,n){var o=TS.model.team.id;_.remove(n,function(c){var v=_.find(e.messages.matches,function(m){return m.channel.id==c},this),h=_.get(v,"channel"),u=TS.interop.rules.channels.isOrgShared(h)||TS.interop.rules.channels.isExternallySharedChannel(h);if(v&&_.get(v,"team")!=o&&_.startsWith(c,"C")&&!u)return c})}d(i,"_excludeNonLocalModelObs");var l=1989})()},XUc0:function(se,ae){(function(){TS.registerModule("api",{})})()},YZHV:function(se,ae){(function(){TS.registerModule("channels",{switched_sig:new signals.Signal,joined_sig:new signals.Signal,left_sig:new signals.Signal,message_changed_sig:new signals.Signal,deleted_sig:new signals.Signal,onStart:function(){TS.channels.deleted_sig.add(a=>{TS.channels.temp_list_of_removed_channels[a]=!0}),TS.channels.joined_sig.add(a=>{delete TS.channels.temp_list_of_removed_channels[a.id]})},temp_list_of_removed_channels:{},legacyOnJoin:function(a,t,f){if(!a){t.error==="name_taken"||t.error==="is_archived"||(t.error==="restricted_action"?TS.generic_dialog.alert(TS.interop.i18n.t("<p>You don\u2019t have permission to create new channels.</p><p>Talk to your Workspace Owner.</p>","channels")()):(TS.error("failed to join channel"),TS.generic_dialog.alert(TS.interop.i18n.t("Oops, something went wrong.","client")())));return}var i,l;if(t.channel&&(l=TS.interop.channels.upsertChannel(t.channel),i=t.channel.id),!i){TS.error("no channel_id?!!");return}if(TS.model.requested_channel_joins[i]&&delete TS.model.requested_channel_joins[i],!l){TS.error("no channel?!!");return}f.request_in_background||!TS.interop.channels.getNeedsCreatedMessageState(l.name)&&!l.never_needs_joined_msg&&(l.needs_joined_message=!0)},legacyAlertSetTopicError:function(a){var t=_.get(a,"data.error"),f=TS.interop.i18n.t("Oooops!","channels")(),i=TS.interop.rules.channels.getChannelTopicError(t);TS.generic_dialog.alert(i,f)}})})()},"Ysd/":function(se,ae){(function(){TS.registerModule("redux.files",{onStart:function(){Object.defineProperty(TS.model,"files",{get:function(){return TS.redux.files.getAllFiles()},set:function(){return TS.boot_data.feature_tinyspeck&&TS.warn("TS.redux.files: Set TS.model.files"),!1}})},getFileById:function(l){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;var n=t(l,e);return!n||n.id!==l?null:n},getAllFiles:function(){var l=a();return l===f||(i=_.values(l),f=l),i}});var a=TS.redux.bindSelectorToStore("TS.interop.redux.models.files.getAllFiles"),t=TS.redux.bindSelectorToStore("TS.interop.redux.models.files.getFileById"),f,i})()},Zt5a:function(se,ae){(function(){TS.registerModule("pins",{pins_fetched_sig:new signals.Signal,pinned_status_changed_sig:new signals.Signal,pinned_message_deleted_sig:new signals.Signal,onStart:function(){TS.files.team_file_comment_deleted_sig.add(l),TS.files.team_file_deleted_sig.add(e),TS.channels.left_sig.add(n)},onFetchPins:function(o,c){var v=o.data.items;TS.pins.upsertPinnedItems(v),c.pinned_items=v,c.pinned_items_count=v.length,c.has_pins=!!c.pinned_items_count,(!c.is_channel||c.is_member)&&(a[c.id]=!0),TS.pins.pins_fetched_sig.dispatch(c,v)},havePinsBeenFetched:function(o){return!!a[o.id]},upsertPinnedItems:function(o){_.isEmpty(o)||o.forEach(function(c){if(c.type==="message"&&c.message&&TS.interop.messages.shouldRenderFileThread(c.message)){const h=c.message;h.files&&h.files.forEach(function(u){TS.files.upsertFile(u,"upsertPinnedItems")})}if(c.type==="file"||c.type==="file_comment"){const h=c.file&&c.file.id;TS.files.upsertFile(c.file,"upsertPinnedItems"),f(h,c)}if(c.type==="file_comment"){var v=TS.files.getFileCommentById(c.file,c.comment.id);v||(v=TS.files.addCommentToFile(c.comment,c.file)),c.comment=v}})},legacyRemoveMsg:function(o,c){c.pinned_items&&(i(!1,{message:{ts:o}},"message",c),TS.pins.pinned_message_deleted_sig.dispatch(c))},updateCount:function(o,c){if(o){var v=o.pinned_items_count;o.pinned_items_count=TS.pins.havePinsBeenFetched(o)?_.get(o,"pinned_items.length"):c,v!==o.pinned_items_count&&(o.has_pins=!!o.pinned_items_count,TS.pins.pinned_status_changed_sig.dispatch(o))}},test:function(){return{fileDeleted:e,fileCommentDeleted:l,have_pins_been_fetched:a}}});var a={},t={},f=d(function(o,c){!c||!o||!TS.files.getFileById(o)||Object.defineProperty(c,"file",{enumerable:!0,configurable:!0,get:function(){return TS.files.getFileById(o)},set:function(){return!1}})},"_addFileToItem"),i=d(function(o,c,v,h,u){var m=!1;h.pinned_items||(h.pinned_items=[]);var S=-1;if(h.pinned_items.some(function(w,x){var U=!1;return v==="message"&&w.type==="message"?w.message.ts===c.message.ts&&(U=!0):v==="file"&&w.type==="file"?w.file.id===c.file.id&&(U=!0):v==="file_comment"&&w.type==="file_comment"&&w.comment.id===c.comment.id&&(U=!0),U&&(S=x),U}),TS.pins.havePinsBeenFetched(h))!o&&S!==-1?(h.pinned_items.splice(S,1),h.pinned_items_count=h.pinned_items.length,m=!0):o&&S===-1&&(h.pinned_items.unshift(c),h.pinned_items_count=h.pinned_items.length,m=!0);else{h.pinned_items_count=h.pinned_items_count||0;var b=_.parseInt(u,10);_.isNaN(b)?o?h.pinned_items_count+=1:o||(h.pinned_items_count=Math.max(h.pinned_items_count-1,0)):h.pinned_items_count=b,m=!0}return h.has_pins=!!h.pinned_items_count,m},"_updateModelPinnedItems"),l=d(function(o,c,v){!v||!v.pinned_to||v.pinned_to.forEach(function(h){var u=TS.redux.channels.getEntityById(h);if(u){var m=i(!1,{comment:v},"file_comment",u);m&&TS.pins.pinned_status_changed_sig.dispatch(u)}})},"_fileCommentDeleted"),e=d(function(o){o&&(o.pinned_to&&o.pinned_to.forEach(function(c){var v=TS.redux.channels.getEntityById(c);if(v){var h=i(!1,{file:o},"file",v);h&&TS.pins.pinned_status_changed_sig.dispatch(v)}}),o.comments&&o.comments.forEach(function(c){l(o,c.id,c)}))},"_fileDeleted"),n=d(function(o){var c=o||TS.shared.legacyGetActiveModelOb();c&&c.id&&(delete a[c.id],delete t[c.id])},"_handleLeftChannelOrGroup")})()},aLMH:function(se,ae){(function(){TS.registerModule("utility",{onStart:function(){TS.utility.makeRefererSafeLink=_.memoize(TS.utility.makeRefererSafeLink),TS.prefs&&TS.prefs.team_hide_referers_changed_sig&&TS.prefs.team_hide_referers_changed_sig.add(TS.utility.resetRefererSafeLinkCache),t=TS.interop.i18n.t("me","utility")(),f=TS.interop.i18n.t("you","utility")(),v=TS.utility.normalizeDevHost(`https://${document.location.hostname}/files`),h=TS.utility.normalizeDevHost(`https://${document.location.hostname}/team`)},keymap:{alt:18,ctrl:17,cmd_ff:224,cmd_other:91,cmd_right:93,esc:27,shift:16,tab:9,del:8,delete:46,enter:13,left:37,up:38,right:39,down:40,pageup:33,pagedown:34,end:35,home:36,space:32,semicolon:59,equals_sign:187,minus_sign:189,comma:188,period:190,left_square_bracket:219,right_square_bracket:221,V:86,a:65,e:69,b:66,k:75,i:73,z:90,y:89,insert:45,slash:191,f6:117,num_lock:144,insert_extended:96,caps_lock:20},email_regex:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,regexpEscape:function(u,m){return m=Math.min(m||5e5,5e5),u.length>m&&(u=u.slice(0,m)),_.escapeRegExp(u)},makeComparableVersion:function(u){var m=u.split("-")[0];return _.reduce(m.split("."),function(S,b){return S*1e3+parseInt(b,10)},0)},compareSemanticVersions:function(u,m){var S=TS.utility.makeComparableVersion(u),b=TS.utility.makeComparableVersion(m);return S===b?0:S>b?1:-1},doesRectContainRect:function(u,m,S,b){return S=S||0,m.top<u.top-S||m.bottom>u.bottom+S?!1:b?!0:!(m.left<u.left-S||m.right>u.right+S)},shouldLinksHaveTargets:function(){return!1},parseJSONOrElse:function(u,m){if(u==="")return m;try{return JSON.parse(u)}catch{return m}},removeUrlParam:function(u,m){var S=m.split("?")[0],b=m.indexOf("?")!==-1?m.split("?")[1]:"",w=[],x;if(b!==""){w=b.split("&");for(var U=w.length-1;U>=0;U-=1)x=w[U].split("=")[0],x===u&&w.splice(U,1);S=w.length?`${S}?${w.join("&")}`:S}return S},getPathFromSlackUrl:function(u){var m=u.match(o),S=m&&m[2];if(S){var b=u.split(S),w=b[1].split("?")[0];return(S+w).split("/")}},makeSafeForDomId:function(u){return String(u).replace(/\./g,"_")},getAppliedClasses:function(u){return _.reduce(u,function(m,S,b){return S&&m.push(b),m},[]).join(" ")},numberWithK:function(u){return u>999?(u=Math.round(u/1e3*10)/10,`${TS.interop.i18n.number(u)||""}K`):TS.interop.i18n.number(u)||""},openInNewTab:function(u,m){let{dontEncodeHash:S=!1}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(u.indexOf("/")===0&&TS.boot_data.team_url){var b=TS.boot_data.team_url;b=b.substr(0,b.length-1),u=b+u}var w=u,x="",U=w.indexOf("?"),ee=TS.interop.utility.urlNeedsRefererHiding(u);if(U!==-1){ee&&(u=_.escape(u.substring(0,U)));var F=w.substring(U+1,w.length);if(w=w.substring(0,U),F.length){var y=TS.interop.url.queryStringParse(F),T=TS.interop.url.parseUrl(u),s=!1;T&&T.hostname=="accounts.google.com"&&T.pathname=="/o/oauth2/auth"&&(s=!0),_.forEach(y,function(g,A){ee?(u=TS.interop.url.setUrlQueryStringValue(u,A,g||"",s),S&&(u=u.replace("%23","#"))):x+=`<input type="hidden" name="${_.escape(A)}" value="${_.escape(g||"")}">`})}}ee&&(x=`<input type="hidden" name="url" value="${_.escape(u)}">`,w=`https://${TS.boot_data.redir_domain}/link`),$(`<form>${x}</form>`).attr({method:"GET",action:w,target:m}).appendTo("body").submit().remove()},isScalar:function(u){return/boolean|number|string/.test(typeof u)},sanitizeHTML:function(u,m,S,b){var w=d(function(F){var y=F.tagName.toLowerCase();return m.indexOf(y)<0?null:(Array.prototype.slice.apply(F.attributes).forEach(function(T){S.indexOf(T.name)<0&&F.attributes.removeNamedItem(T.name)}),Array.prototype.slice.apply(F.children).forEach(function(T){var s=w(T);s||F.removeChild(T)}),F)},"_sanitizeNode");a=a||new DOMParser;var x=a.parseFromString(u,"text/html")||a.parseFromString(u,"text/xml"),U=x.body;if(U.children.length!=1)return"";var ee=w(U.children[0]);return U=null,x=null,ee?b?ee:ee.outerHTML:""},getChildTextNodes:function(u){var m=[];if(!u)return m;if(u instanceof Text)return m.push(u),m;for(var S=document.createTreeWalker(u,NodeFilter.SHOW_TEXT,null,!1),b=S.nextNode();b;)m.push(b),b=S.nextNode();return m},linkify:function(u,m,S,b){return u&&(u=u.replace(TS.interop.url.URL_REGEXP,function(w){var x;if(w.toLowerCase().indexOf("www.")===0){if(!S)return w;x=`http://${w}`}else x=w;return b?`<${x}|${w}>`:`<a ${TS.utility.makeRefererSafeLink(x)} target="${m||""}">${w}</a>`}),u)},getActiveElementProp:function(u){return document.activeElement?u==="NODENAME"?document.activeElement.nodeName?document.activeElement.nodeName.toUpperCase():"":document.activeElement[u]:""},isTabCompleteShowing:function(){return!!$("#chat_input_tab_ui").length},referer_safe_url_map:{},makeRefererSafeLink:function(u){if(typeof u!="string"){TS.error(`Expected url to be a string, got: ${typeof u}`);return}u=u.replace(/\ue000/g,"").replace(/\ue001/g,""),n(u);var m=u.replace(/&amp;/g,"&");m.match(/javascript(:|&colon;)/gi)&&(m="#");var S=!0,b=TS.utility.sanitizeHTML(`<a href="${m}"></a>`,["a"],["href"],S)||null;b&&(m=b.href),m=_.escape(m).replace(/&amp;/g,"&").replace(/(%27|&#39;)/g,"'"),u&&u.lastIndexOf("/")!==u.length-1&&m&&m.lastIndexOf("/")===m.length-1&&(m=m.slice(0,-1)),m=m||"#";var w=`href="${m}"`,x="onclick",U=TS.interop.utility.getRefererPolicy();if((!TS.model||!TS.model.is_our_app)&&U&&U.rewrite_on_right_click&&(x="onmousedown"),!TS.interop.utility.urlNeedsRefererHiding(u))return w;if(TS.utility.externalURLsNeedRedirecting()){var ee=encodeURIComponent(m),F=`https://${TS.boot_data.redir_domain}/link?url=${ee}${U&&U.redirect_type?`&v=${U.redirect_type}`:""}`,y=`url-${Math.random()}-${performance.now()}`;TS.utility.referer_safe_url_map[y]=m,w+=` data-referer-safe="1" ${x}="this.href=&quot;${F}&quot;" onmouseover="this.href=TS.utility.referer_safe_url_map[&quot;${y}&quot;]" data-referer-original-href="${m}" rel="noreferrer"`}else w+=' rel="noreferrer"';return w},resetRefererSafeLinkCache:function(){TS.utility.makeRefererSafeLink&&TS.utility.makeRefererSafeLink.cache&&TS.utility.makeRefererSafeLink.cache.clear()},makeSureAllExternalLinksAreRefererSafe:function(u){var m=Date.now(),S=[];TS.utility.externalURLsNeedRedirecting()?(u.find("a[href]:not([data-referer-safe])").each(function(){var b=$(this),w=b.attr("href");if(TS.interop.utility.urlNeedsRefererHiding(w)){S.push(this.outerHTML),b.removeAttr("href");var x=this.outerHTML.replace("<a",function(){return`<a ${TS.utility.makeRefererSafeLink(w)} `});b.replaceWith(x),S[S.length-1]+=`
->
${x}`}}),TS.model&&TS.model.team&&TS.has_pri[c]&&TS.boot_data.feature_tinyspeck&&(S.length?(TS.log(c,`#${u.attr("id")} had ${S.length} LINKS WITH EXT HREFS BUT NOT data-referer-safe! to fix it took ${Date.now()-m}ms`),TS.dir(c,S)):TS.log(c,`#${u.attr("id")} had ${S.length} LINKS WITH EXT HREFS BUT NOT data-referer-safe! to check it took ${Date.now()-m}ms`))):(u.find("a[href]:not([rel])").each(function(){var b=$(this),w=b.attr("href");w.indexOf("mailto")===0||w.indexOf("skype")===0||(w&&w!=="#"?TS.interop.utility.urlNeedsRefererHiding(w)&&(S.push(this.outerHTML),b.attr("rel","noreferrer"),S[S.length-1]+=`
->
${this.outerHTML}`):b.removeAttr("href"))}),TS.model&&TS.model.team&&TS.has_pri[c]&&TS.boot_data.feature_tinyspeck&&(S.length?(TS.log(c,`#${u.attr("id")} had ${S.length} LINKS WITH EXT HREFS BUT WITHOUT rel="noreferrer"! to add rel it took ${Date.now()-m}ms`),TS.dir(c,S)):TS.log(c,`#${u.attr("id")} had ${S.length} LINKS WITH EXT HREFS BUT WITHOUT rel="noreferrer"! to check it took ${Date.now()-m}ms`)))},makeSureAllLinksHaveTargets:function(u){var m=Date.now(),S=[];u.find("a[href]:not([target])").each(function(){var b=$(this),w=b.attr("href");w.indexOf("mailto")===0||w.indexOf("skype")===0||(w&&w!=="#"?(S.push(this.outerHTML),b.attr("target",w),S[S.length-1]+=`
->
${this.outerHTML}`):b.removeAttr("href"))}),TS.model&&TS.model.team&&TS.has_pri[c]&&TS.boot_data.feature_tinyspeck&&(S.length?(TS.log(c,`#${u.attr("id")} had ${S.length} LINKS WITH HREFS BUT WITHOUT TARGETS! to add targets it took ${Date.now()-m}ms`),TS.dir(c,S)):TS.log(c,`#${u.attr("id")} had ${S.length} LINKS WITH HREFS BUT WITHOUT TARGETS! to check it took ${Date.now()-m}ms`)),TS.utility.makeSureAllExternalLinksAreRefererSafe(u)},sortTable:function(u,m,S,b,w){S=S==="desc"?"desc":"asc",w=w==="desc"?"desc":"asc";function x(y){return function(T,s){var g=U(T,y),A=U(s,y);return $.isNumeric(g)&&$.isNumeric(A)?g==A&&b?(g=U(T,b),A=U(s,b),$.isNumeric(g)&&$.isNumeric(A)?w!=S?A-g:g-A:w!=S?TS.interop.i18n.sorter(A,g):TS.interop.i18n.sorter(g,A)):g-A:TS.interop.i18n.sorter(g,A)}}d(x,"sortFunc");function U(y,T){return $(y).children("td").eq(T).attr("data-sort-val")}d(U,"getCellValue");var ee=u.find("tr:gt(0)").toArray().sort(x(m));S==="desc"&&(ee=ee.reverse());for(var F=0;F<ee.length;F+=1)u.append(ee[F])},getPercSmartly:function(u,m){if(!u||!m)return"0%";var S=u/m*100;return S!=100&&Math.round(S)==100?"99%":S<.7?"<1%":`${Math.round(S)}%`},hex2rgb:function(u){var m=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(u);return m?{r:parseInt(m[1],16),g:parseInt(m[2],16),b:parseInt(m[3],16)}:void 0},setImmediate:function(u){i(u)},debounce:function(u,m){var S;return function(){var b=this,w=arguments;clearTimeout(S),S=setTimeout(function(){u.apply(b,w)},m)}},debounceWithPromise:function(u,m){var S;return function(){var b=this,w=arguments;return S&&S.cancel(),S=new Promise(function(x){setTimeout(x,m)}).then(function(){return u.apply(b,w)}),S}},throttleFunc:function(u,m,S){var b={},w=d(function x(){var U=Array.prototype.slice.apply(arguments),ee=_.some(U,_.isObject);ee&&TS.error("You're passing non-scalar arguments to a function throttled with TS.utility.throttleFunc; it will likely not work as you want");var F=`f-${U.join("-")}`;if(b[F]&&b[F].context!==this)throw new Error(`Cannot use this function with different \`this\` contexts across different calls ${this} ${b[F].context}`);b[F]=b[F]||{requested:Date.now(),timeout:0,context:this},b[F].timeout||x.always_wait?b[F].requested=Date.now():u.apply(b[F].context,U),!b[F].timeout&&(b[F].timeout=setTimeout(d(function y(){var T=Date.now()-b[F].requested;T>=m?(u.apply(b[F].context,U),delete b[F]):b[F].timeout=setTimeout(y,m-T)},"timerFunc"),m))},"funcReplacement");return w.always_wait=!!S,w},throttle:function(){var u,m;u={delay:200,timer_group:"generic"},m={timers:{},queues:{}};function S(w){var x,U;if(m.timers[w]){if(m.queues[w])for(x=0,U=m.queues[w].length;x<U;x+=1)m.queues[w][x]&&m.queues[w][x]();m.queues[w]=null,m.timers[w]=null}}d(S,"processQueue");function b(w,x,U){if(!w)return!1;x=x||u.timer_group,m.timers[x]||(U=U||u.delay,m.timers[x]=window.setTimeout(function(){S(x)},U)),m.queues[x]||(m.queues[x]=[]),m.queues[x].indexOf?m.queues[x].indexOf(w)===-1&&m.queues[x].push(w):m.queues[x].push(w)}return d(b,"method"),{method:b}}(),getImgProxyURL:function(u,m,S){return TS.utility.getImgProxyURLWithOptions(u,{width:m,height:S})},getImgProxyURLWithOptions:function(u){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return u&&TS.interop.utility.getImgProxyUrl({url:u,height:m.height,width:m.width,rotate:m.rotate,renderSvg:m.render_svg,stopAnimations:m.stop_animations,emoji:m.emoji,convertIco:m.convert_ico})},rAF:function(){var u=["ms","moz","webkit","o"],m=window.requestAnimationFrame,S;for(S=0;S<u.length&&!m;S+=1)m=window[`${u[S]}RequestAnimationFrame`];if(!m){var b=0;return function(w){var x=Date.now(),U=Math.max(0,16-(x-b)),ee=window.setTimeout(function(){w(x+U)},U);return b=x+U,ee}}return function(w){return m.call(window,w)}}(),getLocationHashString:function(u){u=u||document;var m=u.location.hash;return m&&m.length?m.substr(1):m},externalURLsNeedRedirecting:function(){return!!(TS.model.team&&TS.prefs.getTeamPref("hide_referers")&&!TS.model.is_our_app)},isArrowKey:function(u){var m=TS.utility.keymap;return u==m.down||u==m.up||u==m.right||u==m.left},normalizeDevHost:function(u){return u.replace(/\.dev[0-9]*.slack.com/i,".dev.slack.com").replace(/\.staging.slack.com/i,".slack.com").replace(/\.staging-master.slack.com/i,".slack.com").replace(/\.staging-release.slack.com/i,".slack.com")},areSimpleObjectsEqual:d(function u(m,S){if(m===S)return!0;if(m===void 0&&S||S===void 0&&m||typeof m!=typeof S||m===null&&S||S===null&&m||m.length!==S.length)return!1;var b;for(b in S){if(typeof m[b]>"u"&&typeof S[b]<"u")return!1;if(S[b])switch(typeof S[b]){case"object":if(!u(m[b],S[b]))return!1;break;case"function":if(String(S[b])!=String(m[b]))return!1;break;default:if(S[b]!==m[b])return!1}else if(m[b])return!1}for(b in m)if(typeof S[b]>"u"&&typeof m[b]<"u")return!1;return!0},"recurse"),deepDiffObjects:function(u,m){if(_.isEmpty(u))return{};if(_.isEmpty(m))return u;var S={};return _.each(u,function(b,w){var x=m[w];if(x!==b)if(typeof b!=typeof x)S[w]=b;else if(_.isArray(b))S[w]=_.difference(b,x);else if(_.isPlainObject(b)){var U=TS.utility.deepDiffObjects(b,x);_.isEmpty(U)||(S[w]=U)}else S[w]=b}),S},makeWebWorker:function(u,m){var S=URL.createObjectURL(new Blob(["(",u,")()"],{type:"application/javascript"})),b=new Worker(S);return URL.revokeObjectURL(S),b.onmessage=m,b},truncateToNearestWordBoundary:function(u,m){if(u.string&&(u=u.string),u.length<=m)return u;var S="\u2026",b=u.substring(0,m),w=b.lastIndexOf(" ");return w>0&&w>m-15?b.substring(0,w)+S:b.substring(0,b.length-1)+S},getCachedScript:function(u,m){return m=$.extend(m||{},{dataType:"script",cache:!0,url:u}),jQuery.ajax(m)},disableElement:function(u,m){u=$(u),u.attr("disabled",m),u.attr("aria-disabled",m)},enableFeatureForUser:function(u){return u<0||u>100?(TS.warn("TS.utility.enableFeatureForUser() expects a number between 0 and 100"),!1):_.random(0,100)<u},roundToThree:function(u){return+`${Math.round(`${u}e+3`)}e-3`},queryIsMaybeSelf:function(u){return u=_.toLower(u),u==="me"||u==="you"||u===t||u===f},exampleEmailAddress:function(u){return u==="you"?TS.interop.i18n.t("you@{example_com}","utility")({example_com:"example.com"}):TS.interop.i18n.t("name@{example_com}","utility")({example_com:"example.com"})},test:function(){var u={};return Object.defineProperty(u,"_files_url",{get:function(){return v},set:function(m){v=m}}),Object.defineProperty(u,"_team_url",{get:function(){return h},set:function(m){h=m}}),u}});var a,t,f,i=window.setImmediate;if(!i)if(window.MutationObserver){var l=document.createElement("div"),e=[];new MutationObserver(function(){var u=e.slice();e.length=0,u.forEach(function(m){m()})}).observe(l,{attributes:!0}),i=d(function(u){e.length||l.setAttribute("yes","no"),e.push(u)},"_set_immediate_fn")}else i=d(function(u){setTimeout(u,0)},"_set_immediate_fn");var n=d(function(u){var m=TS.utility.getPathFromSlackUrl(u);if(m&&m.length>1){var S={messages:!0,archives:!0}[m[0]],b=decodeURIComponent(m[1]);S&&b&&TS.interop.utility.looksLikeChannelId(b)&&!TS.interop.channels.hasChannelWithId(b)&&TS.redux.channels.getEntityById(b)}},"_fetchUnknownChannelSlackUrl"),o=/([^.:/]+)(?:\.[^.]+)?\.slack\.com\/((?:messages|archives|unreads|threads|team|page)\/)/,c=365,v=null,h=null})()},"bdn/":function(se,ae){(function(){TS.registerModule("sorter",{onStart:function(){},search:function(y,T,s){return u(y,T,s)},test:function(){var y={sortFuzzy:w,frecencyBonusPoints:U,getFilteredMatchesForFrecency:m,scoreMember:c,_scoreUserGroup:v,getSubQueryMatchers:o,_scoreEmoji:n,_makeFuzzySearcher:i,_getMetaFieldForId:f,search:u,getNameForComparison:b};return Object.defineProperty(y,"_meta_fields",{get:function(){return a},set:function(T){a=T}}),y}});var i=d(function(y,T){T=T||{};var s=T.fuzzy_limit!=null?T.fuzzy_limit:10;y=TS.interop.i18n.deburr(y.toLocaleLowerCase());var g=y,A=y.charAt(0)==="@",j=y.charAt(0)==="#",Z=y.charAt(0)===":";(A||j||Z)&&(y=y.substring(1));var q={fuzzy_limit:s},ne={fuzzy_limit:s,search_forward_only:!0},oe=TS.fuzzy.makeFuzzyMatcher(y,q),D=TS.fuzzy.makeFuzzyMatcher(g,q),Y=TS.fuzzy.makeFuzzyMatcher(y,ne),J=o(y,ne);return{query:y,full_query:g,only_channels:j,only_members:A,only_emoji:Z,matchesChannel:function(B){if(TS.interop.rules.channels.isUnknownOrNonExistent(B)||A||Z)return!1;if((T.allow_empty_query||j)&&!y)return t(B.id,"jumper_score",0),!0;var R=oe.score(B.name_normalized||B.name);if(t(B.id,"jumper_score",R),R>s&&T.search_previous_channel_names&&B.previous_names&&B.previous_names.length){var M=_.map(B.previous_names,function(z){return{score:oe.score(z),name:z}});t(B.id,"jumper_previous_name_scores",M);var E=_.some(M,function(z){return z.score<=s}),k=E&&R>s;if(k){var O=_.minBy(M,"score");B._jumper_previous_name_match=O&&O.name}else B._jumper_previous_name_match=null;return R<=s||E}return B._jumper_previous_name_match&&(B._jumper_previous_name_match=null),R<=s},matchesGroup:function(B){if(j||A||Z)return!1;if(T.allow_empty_query&&!y)return t(B.id,"jumper_score",0),!0;var R=oe.score(B.name_normalized||B.name);return t(B.id,"jumper_score",R),R<=s},matchesMember:function(B){if(B.is_non_existent||B.isNonExistent||B.is_unknown||B.isUnknown||j||Z)return!1;if((T.allow_empty_query||A)&&!y)return t(B.id,"jumper_score",0),!0;var R=c(B,Y,y);return t(B.id,"jumper_score",R),R<=s},matchesMpim:function(B){if(j||A||Z)return!1;if(T.allow_empty_query&&!y)return t(B.id,"jumper_score",0),!0;var R=TS.mpims.legacyGetMembersInDisplayOrder(B);R=_.chain(R).reject(k=>!k||k.is_non_existent||k.isNonExistent||k.is_unknown||k.isUnknown).value();var M=J.map(function(k){var O=R.map(function(z){return c(z,k)});return _.min(O)}),E=_.sum(M);return t(B.id,"jumper_score",E),E<=s},matchesTeam:function(B){if(TS.interop.rules.teams.isUnknownOrNonExistent(B))return!1;var R=B.team_name||B.name||"",M=D.score(R.toLocaleLowerCase());return t(B.id,"jumper_score",M),M<=s},matchesUserGroup:function(B){if(j||Z)return!1;if((T.allow_empty_query||A)&&!y)return t(B.id,"jumper_score",0),!0;var R=v(B,oe);return t(B.id,"jumper_score",R),R<=s},matchesEmoji:function(B){if(j||A)return!1;if(T.allow_empty_query&&!y)return t(B.id,"emoji_score",0),!0;var R=TS.interop.i18n.deburr(B.display_name||B.name),M,E;return M=n(R,y),B.display_name&&B.display_name!==B.name&&(E=n(B.name,y),E!==1/0&&E<M&&(M=E,R=B.name)),M!==1/0?(t(B.id,"emoji_score",M),!0):!1},matchesBroadcastKeyword:function(B){if(j||Z)return!1;if((T.allow_empty_query||A)&&!y)return t(B.id,"jumper_score",0),!0;var R=h(B,oe);return t(B.id,"jumper_score",R),R<=s},matchesView:function(B){if(j||Z)return!1;var R=oe.score(B.name.toLocaleLowerCase());return R===1/0&&B.alt_names&&(R=_.reduce(B.alt_names,function(M,E){return Math.min(M,oe.score(E.toLocaleLowerCase()))},R)),t(B.id,"jumper_score",R),R<=s}}},"_makeFuzzySearcher"),l=/\s+/g,e=/[-]+/g,n=d(function(y,T){var s=2,g=6;if(T.length<3?(s=0,g=0):T.length===3?(s=1,g=1):(T.length===4&&(s=1),g=5),y==="ok_hand"&&T==="ok")return 0;var A=TS.interop.searcher.emojiSkiplist;if(A[T]&&A[T].indexOf(y)!==-1)return 1/0;var j=1/0,Z=y.indexOf(T);if(Z===-1&&(Z=y.indexOf(T[0])),Z!==-1){T=T.replace(l,"").replace(e,"_"),y=y.replace(e,"_");for(var q=T.split(""),ne=0,oe=0,D=0,Y=!0,J=Z;J<y.length;J++){if(y[J]===q[0]){if(Y=!0,q.shift(),D>oe&&(oe=D),D=0,q.length===0)break}else Y&&(ne+=1),Y=!1,D+=1;if(ne>s||D>g)return j}if(q.length>0)return j;j=1-T.length/y.length,ne>0&&(j+=ne)}return j},"_scoreEmoji"),o=d(function(y,T){var s=y.split(/[,| ]/).filter(function(g){return!!g});return s.map(function(g){return g=g.charAt("0")==="@"?g.substring(1):g,TS.fuzzy.makeFuzzyMatcher(g,T)})},"_getSubQueryMatchers"),c=d(function(y,T,s){var g;if(TS.utility.queryIsMaybeSelf(s)&&y.is_self)return 0;var A=1/0,j=1/0,Z=1/0,q=1/0;return A=T.score(y._real_name_lc),y._real_name_lc!==y._real_name_normalized_lc&&(j=T.score(y._real_name_normalized_lc)),y._display_name_lc&&(Z=T.score(y._display_name_lc),y._display_name_lc!==y._display_name_normalized_lc&&(q=T.score(y._display_name_normalized_lc))),g=Math.min(A,j,Z,q),g},"_scoreMember"),v=d(function(y,T){var s=1/0,g=1/0;s=T.score(y.name),g=T.score(y.handle);var A=Math.min(s,g);return A},"_scoreUserGroup"),h=d(function(y,T){var s=1/0,g=1/0;if(s=T.score(y.name),y.ms_name!==y.name&&(g=T.score(y.ms_name)),!y.alias)return Math.min(s,g);var A=1/0;A=T.score(y.alias);var j=Math.min(s,g,A);return j},"_scoreBroadcastKeyword"),u=d(function(y,T,s){var g=i(y,s||{}),A=[],j=[],Z=[],q=[],ne=[],oe=[],D=[],Y=[],J=[],B=[],R=[],M=[],E=[];if(T.members=T.members||[],T.channels=T.channels||[],T.groups=T.groups||[],T.mpims=T.mpims||[],T.teams=T.teams||[],T.usergroups=T.usergroups||[],T.emoji=T.emoji||[],T.broadcast_keywords=T.broadcast_keywords||[],T.views=T.views||[],T.enterprise_channels=T.enterprise_channels||[],T.enterprise_groups=T.enterprise_groups||[],T.app_actions=T.app_actions||[],TS.telemeter.mark("ts-sorter-matching-mark"),!g.only_channels&&!g.only_emoji&&!g.only_app_actions&&(j=T.members.filter(function(K){return K.is_non_existent||K.isNonExistent||K.is_unknown||K.isUnknown?!1:(_.isString(TS.interop.rules.members.getMemberProfileFieldDisplayName(K))||TS.interop.utility.getLogger({getState:TS.redux.getState}).error(`${K.id}: memberProfileFieldDisplayName is not a string.`),_.isString(TS.interop.rules.members.getMemberRealName(K))||TS.interop.utility.getLogger({getState:TS.redux.getState}).error(`${K.id}: memberRealName is not a string`),s.prefer_exact_match&&g.query&&(TS.interop.rules.members.getMemberProfileFieldDisplayName(K)&&_.isString(TS.interop.rules.members.getMemberProfileFieldDisplayName(K))&&TS.interop.rules.members.getMemberProfileFieldDisplayName(K).toLocaleLowerCase()===g.query||TS.interop.rules.members.getMemberRealName(K)&&_.isString(TS.interop.rules.members.getMemberRealName(K))&&TS.interop.rules.members.getMemberRealName(K).toLocaleLowerCase()===g.query)?(t(K.id,"jumper_exact_match",!0),A.push(K),!1):(t(K.id,"jumper_exact_match",!1),g.matchesMember(K)))}),B=T.usergroups.filter(function(K){return s.prefer_exact_match&&K.handle===g.query||K.name_lc===g.query?(A.push(K),!1):g.matchesUserGroup(K)}),R=T.broadcast_keywords.filter(function(K){return s.prefer_exact_match&&K.name===g.query?(A.push(K),!1):g.matchesBroadcastKeyword(K)})),!g.only_members&&!g.only_emoji&&!g.only_app_actions){const K=d(function(te){if(!TS.interop.rules.channels.isUnknownOrNonExistent(te)){if(s.prefer_exact_match&&te.name===g.query){t(te.id,"jumper_exact_match",!0),A.push(te);return}t(te.id,"jumper_exact_match",!1);var de=g.matchesChannel(te);de&&(te.is_member?Z.push(te):TS.interop.rules.channels.isArchived(te)?ne.push(te):q.push(te))}},"processChannel");T.channels.forEach(K),T.enterprise_channels.forEach(K)}if(!g.only_channels&&!g.only_members&&!g.only_emoji&&!g.only_app_actions){const K=d(function(te){if(s.prefer_exact_match&&te.name===g.query){t(te.id,"jumper_exact_match",!0),A.push(te);return}t(te.id,"jumper_exact_match",!1);var de=g.matchesGroup(te);de&&(TS.interop.rules.channels.isArchived(te)?D.push(te):oe.push(te))},"processGroup");T.groups.forEach(K),T.enterprise_groups.forEach(K),Y=T.mpims.filter(function(te){return g.matchesMpim(te)})}J=T.teams.filter(function(K){if(TS.interop.rules.teams.isUnknownOrNonExistent(K)||!_.isObject(K))return!1;var te=K.team_name||K.name||"";if(s.prefer_exact_match&&te.toLocaleLowerCase()===g.full_query)return t(K.id,"jumper_exact_match",!0),A.push(K),!1;t(K.id,"jumper_exact_match",!1);var de=g.matchesTeam(K);return de}),!g.only_channels&&!g.only_emoji&&!g.only_members&&(E=T.app_actions.filter(function(K){if(!_.isObject(K))return!1;var te=K.name;return s.prefer_exact_match&&te.toLocaleLowerCase()===g.full_query?(t(K.id,"jumper_exact_match",!0),A.push(K),!1):(t(K.id,"jumper_exact_match",!1),!1)})),TS.telemeter.measureAndClear("ts-sorter-matching-mark","ts-sorter-matching"),TS.telemeter.mark("ts-sorter-sorting-mark");var k,O,z;k=j.concat(Z,oe,Y,B,R,M,E),s.flat||k.sort(_.partial(w,!0)),O=q.concat(J),s.flat||O.sort(_.partial(w,!0)),z=D.concat(ne),s.flat||z.sort(_.partial(w,!0));var W=k.concat(O,z);s.flat&&W.sort(_.partial(w,!0));var V=W;if(s.prefer_exact_match&&A.length>0&&(A.sort(_.partial(x,!0)),V.unshift(...A)),s.frecency&&(s.normalize=!0,TS.telemeter.mark("ts-sorter-frecency-sort-mark"),V=TS.ui.frecency.query(V,y,U,s)),s.limit&&(V=_.take(V,s.limit)),s.frecency&&(V=m(V),TS.telemeter.measureAndClear("ts-sorter-frecency-sort-mark","ts-sorter-frecency-sort")),s.print){var Q=`
`;_.forEach(V,function(K){var te=s.frecency?K.model_ob:K;s.frecency&&(Q+=`[${K.score}] `),f(te.id,"jumper_score")!=null&&(Q+=`[${f(te.id,"jumper_score")}] `),te.is_mpim?Q+=TS.mpims.legacyGetDisplayName(te):te.is_channel?Q+=`#${te.name}`:te.is_group?Q+=te.name:te.team_name?Q+=te.team_name:te.is_usergroup?Q+=`@${te.name}`:te.presence?Q+=`@${te.name}`:Q+=K.model_ob?K.model_ob.name:K.name,Q+=`
`}),TS.info(Q)}return TS.telemeter.measureAndClear("ts-sorter-sorting-mark","ts-sorter-sorting"),V},"_search"),m=d(function(y){var T=[];return TS.boot_data.page_needs_enterprise&&(y=_.uniqBy(y,function(s){return s.id})),_.forEach(y,function(s){var g;if(TS.interop.utility.looksLikeMemberId(s.id)){var A=TS.interop.members.getMemberById(s.id);A&&T.push({model_ob:A,score:s.score});return}var j=s.id.indexOf("BK")===0,Z=s.id.indexOf("V")===0;j?g=TS.model.getBroadcastKeywordById(s.id):Z?g=TS.model.getViewById(s.id):g=S(s.id),g&&T.push({model_ob:g,score:s.score})}),T},"_getFilteredMatchesForFrecency"),S=d(function(y){if(y[0]!=="E")return y[0]==="S"?TS.interop.userGroups.getUserGroupById(y):y[0]==="T"?TS.redux.teams.getTeamById(y):TS.redux.channels.getEntityById(y)},"_getModelObById"),b=d(function(y){var T;return y.is_mpim?T=_.toLower(TS.mpims.legacyGetDisplayName(y)):y.is_usergroup?T=y.handle||y.name:TS.interop.rules.members.isMember(y)?T=TS.interop.rules.members.getPrefCompliantMemberName(y):y._name_lc?T=y._name_lc:y.team_name?T=y.team_name.toLocaleLowerCase():T=y.name,T},"_getNameForComparison"),w=d(function(y,T,s){if(T.is_mpim&&!s.is_mpim)return 1;if(s.is_mpim&&!T.is_mpim)return-1;if(!T.is_mpim&&!s.is_mpim){var g=f(T.id,"jumper_score")-f(s.id,"jumper_score");if(g!==0)return g}if(T.is_mpim&&s.is_mpim){var A=f(T.id,"jumper_score")-f(s.id,"jumper_score");if(A!==0)return A;var j=TS.mpims.getMemberCount(T)-TS.mpims.getMemberCount(s);if(j!==0)return j}return x(y,T,s)},"_sortFuzzy"),x=d(function(y,T,s){var g=b(T),A=b(s);return y?TS.interop.i18n.sorter(g,A):g>A?1:A>g?-1:0},"_sortAlphabetically"),U=d(function(y,T){if(y.is_mpim){if(T.prefer_mpims_with_active_members){var s=TS.mpims.legacyGetMembersInDisplayOrder(y);return _.some(s,A=>A.deleted||A.is_suspended)?TS.ui.frecency.bonus_points.mpim_with_deactivated_member:0}return 0}var g=0;if(f(y.id,"jumper_exact_match")?(g+=TS.ui.frecency.bonus_points.exact_match,f(y.id,"emoji_exact_match")&&(g+=TS.ui.frecency.bonus_points.exact_match)):f(y.id,"emoji_score")?g+=ee(y,"emoji_score",TS.ui.frecency.bonus_points.emoji_match):TS.interop.rules.channels.isArchived(y)||TS.interop.rules.members.isDeleted(y)||TS.interop.rules.members.isSuspended(y)||(g+=ee(y,"jumper_score",TS.ui.frecency.bonus_points.fuzzy_match)),f(y.id,"jumper_previous_name_scores")&&(g+=TS.ui.frecency.bonus_points.matches_previous_name),T.prefer_channel_members&&y.presence&&T.model_ob&&F(y.id,T.model_ob)&&(g+=TS.ui.frecency.bonus_points.member_of_this_channel),y.is_starred&&(g+=TS.ui.frecency.bonus_points.starred_channel),TS.interop.rules.members.isMember(y)){const A=TS.redux.channels.getImByMemberId(y.id);A&&A.is_starred&&(g+=TS.ui.frecency.bonus_points.starred_channel)}return y.is_emoji&&(y.name==="thumbsup"||y.name==="point_up")&&(g+=1),T.self_first&&y.is_self&&(g=1/0),(y.is_channel||y.is_group)&&(TS.interop.rules.channels.isArchived(y)&&(g+=TS.ui.frecency.bonus_points.archived_channel_or_group),y.is_channel&&T.prefer_channels_user_belongs_to&&!TS.interop.rules.channels.isArchived(y)&&!F(TS.model.user.id,S(y.id))&&(g+=TS.ui.frecency.bonus_points.not_in_channel),TS.interop.rules.channels.isFromAnotherTeam(y)&&(g+=TS.ui.frecency.bonus_points.foreign_channel_or_group)),TS.interop.rules.members.isMember(y)&&(TS.interop.rules.members.isDeleted(y)||TS.interop.rules.members.isSuspended(y))&&(g+=TS.ui.frecency.bonus_points.deactivated_member),(y.is_usergroup||y.is_broadcast_keyword)&&(g+=TS.ui.frecency.bonus_points.usergroup_or_keyword),g},"_frecencyBonusPointsNormalized"),ee=d(function(y,T,s){var g=f(y.id,T);if(!_.isFinite(g))return 0;var A=.5**g;return Math.round(s*A)},"_calculateNormalizedFuzzyBonusPoints"),F=d(function(y,T){if(T.is_channel&&y===TS.model.user.id)return T.is_member;var s=TS.interop.membership.getCachedChannelMembershipInfoForUser(T.id,y);return s.is_known&&s.is_member},"_isUserIdKnownToBeMemberOfChannel")})();var a={},t=d(function(i,l,e){!i||!l||(a[i]||(a[i]={}),a[i][l]=e)},"_setMetaFieldForId"),f=d(function(i,l){if(!(!i||!l)&&!(!i||!a[i]))return a[i][l]},"_getMetaFieldForId")},fK9Z:function(se,ae){(function(){TS.registerModule("membership",{onStart:function(){var t=1/0;TS.members.changed_deleted_sig.add(a,this,t)}});var a=d(function(){TS.interop.memberCounts.markAllMemberCountsAsStale()},"_invalidateAllMemberCounts")})()},gYX6:function(se,ae){(function(){TS.registerModule("redux.channels",{onStart:function(){a=!0,f=TS.interop.rules.channels.isIm||t,Object.defineProperty(TS.model,"channels",{get:function(){return v("channels")}}),Object.defineProperty(TS.model,"groups",{get:function(){return v("groups")}}),Object.defineProperty(TS.model,"mpims",{get:function(){return v("mpims")}}),Object.defineProperty(TS.model,"ims",{get:function(){return v("ims")}})},dangerouslyGetPublicChannels:function(){let{includeFromAnotherTeam:h=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return TS.interop.channels.getPublicChannels({includeFromAnotherTeam:h})},dangerouslyGetPrivateChannels:function(){let{includeFromAnotherTeam:h=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return TS.interop.channels.getPrivateChannels({includeFromAnotherTeam:h})},dangerouslyGetMpims:function(){return TS.interop.channels.getMpims()},bulkAddEntities:function(h){TS.interop.channels.bulkAddChannels({channels:h})},updateMutedChannels:function(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];var u=_.reduce(h,function(m,S){return m[S]=!0,m},{});TS.redux.dispatch(TS.interop.redux.actions.setMutedChannels(u))},getEntityById:function(h,u){return TS.interop.channels.getEntityById(h,u)},getPublicChannelByName:function(h){var u=l(h);if(TS.interop.rules.channels.isPublicChannel(u))return u},getPublicOrPrivateChannelByName:function(h){var u=l(h);if(TS.interop.rules.channels.isPublicChannel(u)||TS.interop.rules.channels.isPrivateChannel(u))return u},getImByMemberId:function(h){var u=e(h),m=TS.redux.channels.getEntityById(u);return f(m)?m:null},test:function(){var h={};return h}});let a=!1;function t(){TS.interop.utility.getLogger({getState:TS.redux.getState}).error(`missing-isIm: onStartDidRun=${a}, i(${_.has(window,"TS.interop")}), i.r(${_.has(window,"TS.interop.rules")}), i.r.c(${_.has(window,"TS.interop.rules.channels")}), i.r.c.i(${_.has(window,"TS.interop.rules.channels.isIm")})`);const h=Date.now()-(window.localStorage.isImBugLastEncountered||0);throw localStorage.isImBugLastEncountered=Date.now(),h>6e4&&TS.reload(null,"isIM bug detected"),new Error("TS.interop.rules.channels.isIm not present on page, not sure how to proceed")}d(t,"_isImErrorHandler");var f=t,i=TS.interop.channels.getAllChannels,l=TS.interop.channels.getChannelByName,e=TS.interop.channels.getImIdByMemberId,n,o={},c={channels:void 0,groups:void 0,mpims:void 0,ims:void 0},v=d(function(h){var u=i(),m;switch(h){case"channels":m=d(function(S){return S.is_channel&&!S.fromAnotherTeam},"filter");break;case"groups":m=d(function(S){return S.is_group&&!S.is_mpim&&!S.fromAnotherTeam},"filter");break;case"ims":m=f;break;case"mpims":m=d(function(S){return S.is_group&&S.is_mpim},"filter");break;default:}return u===n&&o[h]||(u!==n&&(n=u,o={}),o[h]=_.filter(u,m),o[h]=_.map(o[h],TS.redux.channels.interop.maybeWrapEntity),c[h]||(c[h]=_.defer(function(){delete o[h],delete c[h],n=null}))),o[h]},"_buildModelArrayKey")})()},gj8S:function(se,ae){(function(){TS.registerModule("ui.admin_user_groups",{user_groups_fetched:new signals.Signal,onStart:function(){$("body").on("click",'[data-action="admin_user_groups_modal"]',function(){n()}),$("body").on("click",'[data-action="admin_user_groups_modal_new"]',function(){TS.ui.admin_user_groups.add()})},start:function(){n()},add:function(){n(),l=!0,F()},editInfo:function(E){n(),l=!0,F(E)},editMembers:function(E){n(),l=!0,j(E,!1)},disable:function(E){n(),l=!0,U(E,"disable_user_group")},enable:function(E){n(),l=!0,U(E,"enable_user_group")},interopFunctions:function(E){let{action:k,userGroup:O}=E;switch(k){case"add":F();break;case"enable":U(O,"enable_user_group");break;case"disable":U(O,"disable_user_group");break;case"editInfo":F(O);break;case"editMembers":j(O,!1);break;default:}},test:function(){var E={_isFullLocalMember:Y};return Object.defineProperty(E,"_isFullLocalMember",{get:function(){return Y},set:function(k){Y=k}}),E}});var a,t,f,i=[],l=!1,e=!1,n=d(function(){var E=TS.templates.user_group_modal({show_info_pane:!TS.prefs.getPref("hide_user_group_info_pane"),show_user_groups_add:TS.permissions.members.canCreateAndDeleteUserGroups()}),k={body_template_html:E,onShow:o,onCancel:c};k.full_height_contents=!0,k.modal_contents_container_class="overflow_hidden",R="",TS.interop.userGroups.setSearchQuery(R),TS.ui.fs_modal.start(k)},"_start"),o=d(function(){a=$("#all_user_groups"),t=$("#user_groups_form_div"),f=$("#user_groups_toggle_div"),w(),$("#user_groups_create_btn").on("click",()=>{F()})},"_onShow"),c=d(function(){a=null,t=null,f=null,l=!1,M=null,$(window).off("resize",b),TS.ui.admin_user_groups.user_groups_fetched.dispatch(i),J(TS.model.user_groups),B()},"_onCancel"),v=d(function(E){E&&E.preventDefault(),l?TS.ui.fs_modal.close():w(),J(TS.model.user_groups)},"_onReset"),h=d(function(){l?TS.ui.fs_modal.close():w(),TS.ui.admin_user_groups.user_groups_fetched.dispatch(i),J(TS.model.user_groups)},"_onUpdateComplete"),u=d(function(){l||(TS.ui.fs_modal.bindBackButton(w),TS.ui.fs_modal.showBackButton())},"_bindBackButton"),m=d(function(E){if(!i||!E)return!1;for(var k=0,O=i.length;k<O;k+=1)if(i[k].auto_type===E)return i[k];return!1},"_findAutoUserGroup"),S=d(function(E){let k=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!E){var O=$("#user_group_name_input").val()||"",z=$("#user_group_handle_input").val()||"";if(k.group_name=O,k.group_handle=z,k.error&&(k.error==="forbidden_handle"||k.error==="forbidden_name")){var W=O+z;if(W){var V=m("owner"),Q=m("admin"),K=!!W.match(/admins/i),te=!!W.match(/owners/i);k.suggest_auto_group=!0,k.can_create_auto_owners=te&&TS.model.user.is_admin&&!V,k.can_enable_auto_owners=te&&V&&V.date_delete,k.can_create_auto_admins=K&&TS.model.user.is_admin&&!Q,k.can_enable_auto_admins=K&&Q&&Q.date_delete}}return $("#user_group_alerts").html(TS.templates.user_group_alerts(k)),!0}return!1},"_alertIfNotOk"),b=d(function(){var E=$("#user_groups_header");if(E.length){var k=$("#user_groups_list_scroller");if(k.length){var O=E[0].offsetHeight,z=$(window).height(),W=250,V=z*.15,Q=Math.max(W,z-O-V);k.css("height",Q)}}},"_onResizeList"),w=d(function(){var E=$("#user_groups_list_div");E&&!e&&(TS.interop.mountUserGroupsList(TS.boot_data.team_id,E[0],{isLegacy:!0,isUserGroupBrowser:!0,includeDeactivated:!0,onClearSearch:()=>D()}),E.addClass("ug_modern_list"),e=!0),a.removeClass("hidden"),t.addClass("hidden"),f.addClass("hidden"),x(),TS.ui.fs_modal.hideBackButton()},"_switchListView"),x=d(function(){$(window).on("resize",b),b(),$("#user_group_modal_search").on("keydown keyup change",oe),M=$("#user_groups_header .user_groups_search .icon_close"),M.off("click").on("click",D),a.off("click");var E=d(function(O,z){if(O){l=!1;let W=null;z.subteam&&z.subteam.id&&(W=z.subteam.id),z.usergroup&&z.usergroup.id&&(W=z.usergroup.id),w(W)}},"autoMethodHandler"),k={owners:{create:function(){TS.interop.api.call("subteams.createAuto",{type:"owner"}).then(function(O){let{data:z,args:W,request_id:V}=O;var Q=!0;return E&&E(Q,z,W,V),{data:z,args:W,request_id:V}}).catch(function(O){let{data:z,args:W,request_id:V}=O;var Q=!1;return E&&E(Q,z,W,V),{data:z,args:W,request_id:V}})},enable:function(){var O=m("owner");O&&TS.redux.dispatch(TS.interop.userGroups.enableUserGroup({usergroup:O.id})).then(z=>{E(!0,z)})}},admins:{create:function(){TS.interop.api.call("subteams.createAuto",{type:"admin"}).then(function(O){let{data:z,args:W,request_id:V}=O;var Q=!0;return E&&E(Q,z,W,V),{data:z,args:W,request_id:V}}).catch(function(O){let{data:z,args:W,request_id:V}=O;var Q=!1;return E&&E(Q,z,W,V),{data:z,args:W,request_id:V}})},enable:function(){var O=m("admin");O&&TS.redux.dispatch(TS.interop.userGroups.enableUserGroup({usergroup:O.id})).then(z=>{E(!0,z)})}}};t.off("click").on("click","a.user_group_auto_action",function(O){var z=$(O.target),W=z.data("auto-type"),V=z.data("auto-action");if(k[W]&&k[W][V])return k[W][V](),O.preventDefault(),!1})},"_bindListUI"),U=d(function(E,k){if(!E){TS.warn("Cannot switch toggle view to undefined User Group");return}B(),f.html(TS.templates.user_group_toggle({action:k,user_group:E})),f.find('[data-action="cancel"]').on("click",v),f.find(".user_group_toggle_btn").on("click",function(){var O=$(this).data("action");_.includes(["enableUserGroup","disableUserGroup"],O)&&TS.redux.dispatch(TS.interop.userGroups[O]({usergroup:E.id})).then(()=>{O==="enableUserGroup"&&ee(E),h()}).catch(function(z){const{data:W}=z;return S(!1,W)})}),a.addClass("hidden"),f.removeClass("hidden"),u()},"_switchToggleView"),ee=d(function(E){TS.interop.userGroups.upsertUserGroup(E),TS.interop.userGroups.searchLocalUserGroups()},"_upsertUserGroup"),F=d(function(E){B(),t.html(TS.templates.user_group_settings_form(E)),$("#user_group_default_channels").lazyFilterSelect(g(E)),A(E),a.addClass("hidden"),t.removeClass("hidden"),u()},"_switchSettingsFormView"),y=d(function(E,k){if(!E||!k)return!1;const O=E&&E.id,z=k.prefs.channels.concat(k.prefs.groups);return _.includes(z,O)},"isPreselected"),T=d(function(E,k){const O=_.get(k,"prefs.channels",[]),z=O.length?TS.shared.ensureModelObsArePresent(O):Promise.resolve(),W={prefer_exact_match:!1,frecency:!1,allow_empty_query:!0,prefer_channels_user_belongs_to:!1,flat:!0},V={channels:{include_archived:!1},groups:{include_archived:!1},sort:E?W:!1};return z.then(function(){return TS.searcher.search(E,V)}).then(function(Q){return E?Q:TS.sorter.search(E,Q,W)})},"getLFSChannels"),s=d(function(E){return function(k){return T(k,E).then(function(O){return{replace_all_items:!0,all_items_fetched:!0,items:_.map(O,W=>{const V=W.id,Q=y(W,E);return{model_ob:W,lfs_id:V,preselected:Q}})}})}},"_getLFSChannelsProvider"),g=d(function(E){return{data_promise:s(E),template:function(k){const O=k.model_ob;let z="";return z+=TS.interop.rules.channels.isPublicChannel(O)?"#":'<ts-icon class="ts_icon_lock ts_icon_inherit"></ts-icon>',z+=_.escape(O.name),TS.interop.rules.channels.isOrgShared(O)?z+=' <ts-icon class="ts_icon_shared_channel ts_icon_inherit"></ts-icon>':TS.interop.utility.isModelObjectExternal(O)&&(z+=TS.templates.shared_channels_icon({model_ob:O,tooltip:!0,connectedTeamIds:TS.interop.rules.channels.getConnectedTeamIds(TS.redux.getState(),O),inherit:!0})),new Handlebars.SafeString(z)},placeholder_text:""}},"_getLFSChannelsOptions"),A=d(function(E){var k,O,z;E?(k=TS.interop.userGroups.updateUserGroup,O=!1,z=E.id):(k=TS.interop.userGroups.createUserGroup,O=!0);var W=$("#user_group_handle_input");W.on("input",function(){$(this).closest(".handle_input").toggleClass("empty",!this.value.length)}),t.find(".user_group_settings_form").on("submit",function(te){te.preventDefault();var de=$('input[name="name"]').val(),fe=$('input[name="handle"]').val(),ue=$('input[name="description"]').val(),_e=$("#user_group_default_channels").lazyFilterSelect("value");_e=_.map(_e,"model_ob.id");var he={name:de,handle:fe,description:ue,channels:_e};z&&(he.usergroup=z),TS.redux.dispatch(k(he)).then(function(N){const p=N.usergroup;ee(p),O?j(p,O):h(),TS.user_groups.updated_info_sig.dispatch(p.id)}).catch(function(N){const{data:p}=N;return S(!1,p)})}),t.find(".user_group_settings_form").on("reset",v);var V=$("#save_user_group"),Q=$("#user_group_name_input");function K(){var te=Q.val(),de=W.val();!_.isEmpty(te)&&!_.isEmpty(de)?V.removeAttr("disabled"):V.attr("disabled",!0)}d(K,"inputChange"),V.length&&Q.length&&W.length&&(Q.on("change",K),Q.on("keyup",K),W.on("change",K),W.on("keyup",K),K())},"_bindSettingsFormUI"),j=d(function(E,k){var O=!!E.is_external||!!E.auto_type,z=d(function(){t.html(TS.templates.user_group_members_form({is_new:k,is_locked:O,user_group:E}))},"renderForm"),W=d(function(){var Q=$("#member_count"),K=E.user_count||0,te=d(function(){var fe=$(k?"#create_group":"#save_group");fe.length&&(K<1?fe.prop("disabled",!0):fe.prop("disabled",!1))},"updateForm"),de={approx_item_height:36,template:function(fe){var ue=TS.templates.user_group_invite_member_small(fe);return new Handlebars.SafeString(ue)},onItemAdded:function(){K+=1,Q.html(K),te()},onItemRemoved:function(){K-=1,Q.html(K),te()},filter:function(fe,ue){var _e=fe.member;ue.charAt(0)==="@"&&(ue=ue.substr(1));var he=new RegExp(`^${TS.utility.regexpEscape(ue)}`,"i"),N=new RegExp(`(-|_|\\+|\\s|\\.|@)${TS.utility.regexpEscape(ue)}`,"i");return TS.utility.members.checkMemberMatch(_e,he)||TS.utility.members.checkMemberMatch(_e,N)},disabled:!!E.is_external||!!E.auto_type,data_promise:Z(E)};$("#user_group_members_select").lazyFilterSelect(de),ne(E),a.addClass("hidden"),t.removeClass("hidden"),B(),te()},"renderUI");if(k)z(),TS.ui.fs_modal.hideBackButton(),W();else{var V=d(function(){z(),u(),W()},"work");if(TS.user_groups.legacyNeedsToFetchMembership(E))TS.interop.userGroups.getUserGroupMembers(E.id,function(Q){if(Q&&Q.users){E=Q;const K=_.get(E,"users",[]);return TS.interop.members.ensureMembersArePresent(K).then(V)}});else{const Q=_.get(E,"users",[]);return TS.interop.members.ensureMembersArePresent(Q).then(V)}}},"_switchMembersFormView"),Z=d(function(E){var k=!0;return function(O,z){O.charAt(0)==="@"&&(O=O.substring(1));var W=!1;if(k&&(k=!1,_.get(E,"users.length")&&(W=!0)),W){var V=E.users.map(de=>TS.interop.members.getMemberById(de));V.sort(TS.interop.members.memberSorterByName);var Q=V.map(function(de){return de?{member:de,lfs_id:String(de.id),preselected:!0}:{}});return Promise.resolve(Q)}if(z>0)return Promise.resolve([]);var K={query:O,include_org:!1,include_slackbot:!1,include_self:!0,full_profile_filter:!1,include_bots:!0,include_profile_only_users:!0},te=q(K);return te}},"_buildMembersSelectDataPromise"),q=d(function(E){return Promise.resolve().then(function(){return TS.members.promiseToSearchMembers(E).then(function(k){var O=[];return k.query===""?O=TS.utility.teams.getMembersForTeam(TS.model.team):O=k.items,k.items=O.filter(Y).map(function(z){return{member:z,lfs_id:String(z.id)}}),k})})},"_getSearchPromise"),ne=d(function(E){t.find(".user_group_members_form").on("submit",function(k){k.preventDefault();var O=$("#user_group_members_select").lazyFilterSelect("value");O=O.map(function(z){return z.member.id}),TS.redux.dispatch(TS.interop.userGroups.updateMembersOfUserGroup({usergroup:E.id,users:O})).then(z=>{h(),TS.user_groups.updated_info_sig.dispatch(z.usergroup.id)}).catch(z=>{const{data:W}=z;S(!1,W)})}),t.find(".user_group_members_form").on("reset",function(k){k.preventDefault(),v(k)})},"_bindMembersFormUI"),oe=d(function(E){var k=$(E.target),O=k.val();O!==R&&(R=O,M.toggleClass("hidden",O===""),TS.interop.userGroups.setSearchQuery(R))},"_updateSearch"),D=d(function(){var E=$("#user_group_modal_search");R="",E.val(""),setTimeout(function(){E.focus()},0),M.addClass("hidden"),TS.interop.userGroups.setSearchQuery(R)},"_clearSearch"),Y=d(function(E){return E?!!((TS.interop.rules.members.isMemberOnTeam(E,TS.model.team.id)||E.is_profile_only_user)&&!E.deleted&&!E.is_ultra_restricted&&!E.is_restricted&&!(E.is_bot||TS.interop.rules.members.isSlackbot(E))):!1},"_isFullLocalMember"),J=d(function(E){var k=$("#user_groups_tab .count");k.html(E.length)},"_updateTabUserGroupsCount"),B=d(function(){e=!1;var E=$("#user_groups_list_div");TS.interop.unmountUserGroupsList(E[0])},"_cleanupListView"),R,M})()},gm7A:function(se,ae){(function(){TS.registerModule("ims",{switched_sig:new signals.Signal,message_changed_sig:new signals.Signal,onStart:function(){TS.prefs.display_real_names_override_changed_sig.add(f),TS.prefs.team_display_real_names_changed_sig.add(f),TS.members.changed_profile_sig.add(t)},getDisplayNameOfUserForIm:function(l){return a(l)}});var a=d(function(l){if(l._display_name)return l._display_name;const e=TS.interop.members.getMemberById(l.user);if(!e)return l.name;const n=TS.interop.rules.members.getPrefCompliantMemberName(e);return n===l.user||n===e.id?l.name:(l._display_name=n,l._display_name)},"_getDisplayNameCached"),t=d(function(l){var e=_.find(TS.model.ims,{user:l.id});e&&i(e)},"_memberRealNameChanged"),f=d(function(){TS.model.ims.forEach(i)},"_realNamePrefChanged"),i=d(function(l){l._display_name=void 0},"_clearDisplayNameCache")})()},j9dp:function(se,ae){(function(){TS.registerModule("templates.builders",{makeChannelPrefix:function(t){return!t||t.is_mpim||t.is_im?"":t.is_group||t.is_private?'<ts-icon class="ts_icon_lock"></ts-icon>':t.is_channel?"#":""},makeModelObNameForDisplay:function(t,f){if(!t)return"ERROR: MISSING CHANNEL";f=f||{};var i=_.trim(TS.templates.builders.maybeMakeSharedIcon(t,f.show_tooltip,f.tooltip_position,f.inherit_font_size)),l=TS.templates.builders.makeChannelPrefix(t),e;t.is_im?e=TS.interop.rules.members.getPrefCompliantMemberNameById(t.user):t.is_mpim?e=TS.mpims.legacyGetDisplayName(t):e=t.name,e=_.escape(e);var n="";return!f.allow_wrap&&f.overflow_ellipsis?n+='<span class="no_wrap overflow_hidden">':f.allow_wrap?f.allow_wrap&&(n+='<span class="break_word">'):n+='<span class="no_wrap">',f.overflow_ellipsis&&(n+='<span class="overflow_ellipsis">'),n+=f.omit_prefix?"":l,n+=e,f.overflow_ellipsis&&(n+="</span>"),n+=`</span>${i}`,n},makeChannelLink:function(t,f){if(!t)return"ERROR: MISSING CHANNEL";f=f||{};var i=t.id,l=TS.utility.shouldLinksHaveTargets()?`target="/archives/${i}"`:"",e=TS.templates.builders.makeModelObNameForDisplay(t,f);return f.overflow_ellipsis?`<a href="/archives/${i}" ${l} class="channel_link display_flex flex_wrap_none" data-channel-id="${t.id}">${e}</a>`:`<a href="/archives/${i}" ${l} class="channel_link" data-channel-id="${t.id}">${e}</a>`},maybeMakeSharedIcon:function(t,f,i,l){var e="";if(TS.interop.rules.channels.isOrgShared(t)&&!t.is_mpim&&!t.is_im)e=TS.templates.shared_channel_icon();else if(TS.interop.rules.channels.isExternallySharedChannel(t)&&!t.is_mpim&&!t.is_im){let n=TS.interop.rules.channels.getConnectedTeamIds(TS.redux.getState(),t);n.length===0&&(n=void 0),e=TS.templates.shared_channels_icon({model_ob:t,tooltip:_.isUndefined(f)||f,tooltip_position:i,connectedTeamIds:n,inherit:l})}return new Handlebars.SafeString(e)},makeGroupLink:function(t,f){if(!t)return"ERROR: MISSING GROUP";f=f||{};var i=TS.utility.shouldLinksHaveTargets()?`target="/archives/${t.id}"`:"",l=TS.templates.builders.makeModelObNameForDisplay(t,f);return f.overflow_ellipsis?`<a href="/archives/${t.id}" ${i} class="group_link display_flex flex_wrap_none" data-group-id="${t.id}">${l}</a>`:`<a href="/archives/${t.id}" ${i} class="group_link" data-group-id="${t.id}">${l}</a>`},makeMemberPreviewLink:function(t,f){if(!t)return"";f!==!0&&(f=!1);var i=TS.templates.builders.makeMemberColorClass(t),l,e;return t.is_service?(e=TS.utility.shouldLinksHaveTargets()?`target="/services/${t.id}"`:"",i+=" app_preview_link",l=`<a href="/services/${t.id}" ${e} data-bot-id="${t.id}" class="message_sender service_link ${i}">`):(e=TS.utility.shouldLinksHaveTargets()?`target="/team/${t.id}"`:"",i+=t.is_bot?" app_preview_link":" member member_preview_link",i+=` ${TS.templates.builders.makeMemberTypeBadgeClass(t)}`,l=`<a href="/team/${t.id}" ${e} class="message_sender ${i}" data-member-id="${t.id}">`),f&&t.id==TS.model.user.id?l+=TS.interop.i18n.t("You","templates_builders")():l+=TS.interop.rules.members.getPrefCompliantMemberName(t,!0),l+=TS.templates.builders.makeMemberTypeBadgeCompact(t,!1),l+="</a>",(t.is_bot||t.is_service)&&(l+=`<span class="c-app_label">${TS.interop.i18n.t("APP","templates_builders")()}</span>`),t.is_unknown&&(l=TS.templates.unknown_member({id:t.id})),l},legacyShowDraftIcon:function(t){if(!_.isObject(t))return!1;if(TS.interop.utility.looksLikeMemberId(t.id)){var f=TS.redux.channels.getImByMemberId(t.id);if(!f)return!1}var i=f||t,l=i.last_msg_input,e=i.id,n=TS.shared.legacyGetActiveModelOb();if(n){var o=n.id;o&&o==e&&(l=null)}return i.is_channel&&(TS.interop.rules.channels.isArchived(i)||!i.is_member)&&(l=null),i.is_group&&!i.is_mpim&&TS.interop.rules.channels.isArchived(i)&&(l=null),TS.interop.rules.user.canPostInChannel(i)||(l=null),!!_.trim(l)},makeProfileImage:function(t,f){if(_.isString(t)){var i=TS.interop.members.getMemberById(t);i?t=i:t=TS.interop.bots.getBotById(t)}if(!t)return!1;var l=f.hash.is_lazy||!1,e=t.profile||t.icons||{},n=f.hash.title||!1,o;e.emoji?o="64":o="48";var c=f.hash.size||o,v=Object.keys(TS.constants.avatar_size_map).reduce(function(b,w){return w===c&&m(e,w)?w:b},o),h={entity:t,size:c,css_classes:S(t,c),image:u(t,m(e,v)),is_lazy:l,is_targettable:TS.utility.shouldLinksHaveTargets(),title:n};function u(b,w){var x=[];return x.push(`url('${w}')`),x.join(",")}d(u,"_formatImageURI");function m(b,w){var x=`image_${w}`;return b.hasOwnProperty(x)?TS.environment.is_retina&&b[TS.constants.avatar_size_map[w].retina]||b[TS.constants.avatar_size_map[w].standard]:!1}d(m,"_getImage");function S(b,w){var x=[];return x.push(`thumb_${w}`),b.is_bot?(x.push("is_bot"),x.push("app_preview_link")):x.push("member_preview_link"),x.join(" ")}return d(S,"_getClasses"),new Handlebars.SafeString(TS.templates.member_profile_image(h))},makeMemberPreviewLinkImage:function(t,f,i,l,e,n,o){var c;if(typeof t=="object"?c=t:c=TS.redux.members.getPotentiallyUnknownMemberById(t),!c||!c.profile)return"";i=i===!0,l=l===!0||TS.utility.members.isMemberEKMRevoked(c),e=e===!0,n=n===!0,o=typeof o=="string"?o:!1,t==="USLACKBOT"&&o&&(c=TS.utility.slackbot.getWithFeels(o));var v=TS.templates.builders.getImageStyleForMemberPreviewImage(c,f,i),h={omit_link:l,omit_badge:e,lazy:i,member:c,size:f,include_restricted_overlay:!n||!0,bg_img_style:v};return TS.templates.member_preview_link_image(h)},getImageStyleForMemberPreviewImage:function(t,f,i){var l,e,n;switch(e="background-image: ",n=[],f){case 20:TS.environment.is_retina?l=t.profile.image_48:l=t.profile.image_24;break;case 24:TS.environment.is_retina?l=t.profile.image_48:l=t.profile.image_24;break;case 32:TS.environment.is_retina?l=t.profile.image_72:l=t.profile.image_32;break;case 36:TS.environment.is_retina?l=t.profile.image_72:l=t.profile.image_48;break;case 48:TS.environment.is_retina?l=t.profile.image_72:l=t.profile.image_48;break;case 72:TS.environment.is_retina?l=t.profile.image_192:l=t.profile.image_72;break;case 192:TS.environment.is_retina?l=t.profile.image_512||t.profile.image_192:l=t.profile.image_192;break;case 512:TS.environment.is_retina?l=t.profile.image_1024||t.profile.image_512||t.profile.image_192:l=t.profile.image_512||t.profile.image_192;break;default:TS.environment.is_retina?l=t.profile.image_72:l=t.profile.image_48;break}if(n.push(`url('${l}')`),f===512){var o=TS.environment.is_retina?t.profile.image_72:t.profile.image_48;n.push(`url('${o}')`)}return i?e=n.length?n.join(", "):"":e=n.length?e+n.join(", "):"",e},makePendingUserImage:function(t,f){if(!t||!f)return"";var i=48;f===36&&(i=72);var l=`/img/new_channel_modal/airplane_${i.toString()}.png`,e=`url('${vvv(l)}')`,n={restricted:t.invite_prefs&&t.invite_prefs.type==="restricted",img_url:e,size:f};return TS.templates.pending_user_image(n)},newWindowName:function(){return TS.boot_data.app==="web"||TS.boot_data.app==="calls"?"_self":`new_${a.toString()}`},getBotName:function(t){var f=t.username;if(!f){var i=TS.redux.bots.getBotByMsg(t);i&&i.name&&(f=i.name)}return f},makeLinksFromModelObs:function(t,f){f=f||{},t=TS.utility.parseJSONOrElse(t,t),t=_.isArray(t)?t:[t];var i=0;t=_.chain(t).map(o=>_.isString(o)?TS.redux.channels.getEntityById(o):o).filter(o=>(o||(i+=1),o&&!o.is_im&&!o.is_mpim)).value();var l=TS.sorter.search("",{groups:t},{allow_empty_query:!0}),e=l.sort().map(function(o){var c=f.new_lines?'<span class="block">':"";return c+=o.is_channel?TS.templates.builders.makeChannelLink(o,{overflow_ellipsis:f.overflow_ellipsis,inherit_font_size:f.inherit_font_size}):TS.templates.builders.makeGroupLink(o,{overflow_ellipsis:f.overflow_ellipsis,inherit_font_size:f.inherit_font_size}),c+=f.new_lines?"</span>":"",c});if(i){var n=TS.interop.i18n.t("{private_channel_or_group_count, plural, =1{# private channel}other{# private channels}}","templates_builders")({private_channel_or_group_count:i});e.push(`<span class="no_wrap${f.new_lines?" block":""}">${n}</span>`)}return f.new_lines?e.join(""):TS.interop.i18n.listify(e,{noEscape:!0}).join("")},strBuilder:function(t,f){return t.replace(/\${([a-z_]+)}/g,function(i,l){return l.indexOf("_html")>-1?f[l]:_.escape(f[l])})},atLabel:function(t){t==="group"&&(t="channel");var f=(_.keyBy(TS.interop.broadcast_keywords.getAllBroadcastKeywords(),"ms_name")[t]||{}).name||"channel";return`@${f}`},makeMemberTypeBadgeClass:function(t){return!TS.boot_data.page_needs_enterprise||!t.is_restricted?"":"has_member_type_badge"},makeMemberColorClass:function(t){var f="color_";return t?f+=`${t.id} color_${t.color}`:f+="unknown",f},makeMemberTypeBadgeCompact:function(t,f){if(!TS.boot_data.page_needs_enterprise)return"";typeof f!="boolean"&&(f=!1);var i={icon_class:"",with_tooltip:f,tooltip:{member_type:"",type_description:""}},l=TS.boot_data.page_needs_enterprise?TS.interop.i18n.t("organization directory","templates_builders")():TS.interop.i18n.t("workspace directory","templates_builders")();return t.isExternal?"":t.is_ultra_restricted?(i.icon_class="ts_icon_single_channel_guest",i.tooltip.member_type=TS.interop.i18n.t("Single-Channel Guests","templates_builders")(),i.tooltip.type_description=TS.interop.i18n.t("see a partial {directory_name} and can only access messages and files from the channel they belong to.","templates_builders")({directory_name:l}),TS.templates.member_type_icon(i)):t.is_restricted?(i.icon_class="ts_icon_restricted_user",i.tooltip.member_type=TS.interop.i18n.t("Multi-Channel Guests","templates_builders")(),i.tooltip.type_description=TS.interop.i18n.t("see only a partial {directory_name} and can only access messages and files from selected channels.","templates_builders")({directory_name:l}),TS.templates.member_type_icon(i)):""},getMemberTypeClass:function(t){return t.is_restricted?" ra":""},loadingHTML:function(){return TS.templates.infinite_spinner({color:"white",size:"medium"})},proxyImgUrlsForEmails:function(t){t.find("img").each(function(){var f=$(this).attr("src"),i=$(this).attr("width"),l=$(this).attr("height"),e;i&&l?e=TS.utility.getImgProxyURL(f,i,l):e=TS.utility.getImgProxyURL(f),$(this).attr("src",e)})},test:function(){var t={};return t}});var a=Date.now()})()},laYx:function(se,ae){(function(){TS.registerModule("tips",{onStart:function(){a.delegate(".ts_tip_lazy, .ts_tip_float","mouseenter",o),a.delegate(".ts_tip_float","mouseleave",c),a.on("click",".ts_tip",function(){u($(this))})},hideAll:function(){$(".ts_tip").addClass("ts_tip_hide")},unhideAll:function(){$(".ts_tip").removeClass("ts_tip_hide")},updateTipTitle:function(w,x){var U=m(w);U.length?U.html(x):w.attr("title",x),f&&f[0]==w[0]&&(x?(l.html(x),h()):v())},manuallyToggleTipTitle:function(w){u(w)}});var a=$("BODY"),t=null,f=null,i=null,l=null,e=10,n=0,o=d(function(w){f=$(w.currentTarget);var x=f.hasClass("ts_tip_multiline");if(f.addClass("ts_tip_hidden"),f.children(".ts_tip_tip").length==0&&b(f,x),f.removeAttr("title"),f.removeClass("ts_tip_lazy"),$("#ts_tip_float_floater").remove(),f.hasClass("ts_tip_float")){var U=f.attr("class").split(/\s+/).filter(function(F){return F==="ts_tip_float"||F==="ts_tip_lazy"?!1:F.indexOf("ts_tip")===0}),ee=TS.templates.builders.strBuilder('<div id="ts_tip_float_floater" style="width:${w}px; height:${h}px;" class="${classes}">${tip_html}</div>',{w:f.outerWidth(),h:f.outerHeight(),classes:U.join(" "),tip_html:f.find(".ts_tip_tip").clone()[0].outerHTML});i=$(ee),a.append(i),n=setTimeout(function(){i.removeClass("ts_tip_hidden"),h()},e),t=f.closest(":scrollable(vertical)"),t.on("scroll.ts_tip_removal",v),f.on("destroyed.ts_tip_removal",v),f.hasClass("ts_tip_hide_on_click")&&f.on("click.ts_tip_removal",v),x?l=i.find(".ts_tip_multiline_inner"):(l=i.find(".ts_tip_tip_inner"),l.length||(l=i.find(".ts_tip_tip")))}else setTimeout(function(){f.removeClass("ts_tip_hidden")},e)},"_onMouseEnter"),c=d(function(){v()},"_onMouseLeave"),v=d(function(){clearTimeout(n),i&&i.addClass("ts_tip_hidden"),f&&f.length&&(f.off("click.ts_tip_removal"),f.off("destroyed.ts_tip_removal")),t&&t.off("scroll.ts_tip_removal"),t=null,f=null,i=null,l=null},"_hideFloater"),h=d(function(){var w=f.offset(),x=2,U=window.innerWidth-x,ee=window.innerHeight-x,F=i.hasClass("ts_tip_multiline"),y=d(function(){return F?i.find(".ts_tip_multiline_inner").dimensions_rect():i.find(".ts_tip_tip").dimensions_rect()},"getRect"),T=d(function(g){i.removeClass("			ts_tip_right 			ts_tip_rightish 			ts_tip_left 			ts_tip_leftish 			ts_tip_multiline_top_leftish 			ts_tip_multiline_top_left 			ts_tip_multiline_top_right 			ts_tip_multiline_top_rightish 		").addClass(g)},"setHorizontalPositionClass");i.css("left",w.left).css("top",w.top);var s=y();s.bottom>ee?i.removeClass("ts_tip_bottom").addClass("ts_tip_top"):s.top<x&&i.removeClass("ts_tip_top").addClass("ts_tip_bottom"),F?(s.right>U?T("ts_tip_multiline_top_rightish"):s.left<x&&T("ts_tip_multiline_top_leftish"),s=y(),s.right>U?T("ts_tip_multiline_top_right"):s.left<x&&T("ts_tip_multiline_top_left")):(s.right>U?T("ts_tip_rightish"):s.left<x&&T("ts_tip_leftish"),s=y(),s.right>U?T("ts_tip_right"):s.left<x&&T("ts_tip_left"))},"_positionFloater"),u=d(function(w){var x=m(w),U="tip-toggle-auto",ee;if(w.data(U)?ee=w:x.data(U)&&(ee=x),!!(ee&&ee.length)){var F=x.html(),y=ee.data(U);if(!y)return TS.warn("No toggle state text defined on tipped element. Please add text to data-tip-toggle-text or data-tip-toggle-auto attribute");TS.tips.updateTipTitle(w,y),ee.data(U,F)}},"_toggleTipTitle"),m=d(function(w){var x=w.find(".ts_tip_multiline_inner");return x.length||(x=w.find(".ts_tip_tip_inner")),x.length||(x=w.find(".ts_tip_tip")),x},"_getTipEl"),S=d(function(w){if(!w.text().trim().length&&!w.attr("aria-label"))return _.uniqueId("ts_tip_tip_")},"_possiblyMakeLabelId"),b=d(function(w,x){var U="";if(w.data("tip-member"))U=TS.templates["c-unified_member"]({member:TS.interop.members.getMemberById(w.data("tip-member")),size:"small",avatar:!0,no_tip:!0,dark:!0,omit_status:!0,forced_primary:"real_name"});else{var ee=_.escape(w.prop("title")),F=S(w),y=F?` id="${F}"`:"";U=x?`<span class="ts_tip_multiline_inner">${ee}</span>`:ee}var T=["<span",y,' class="ts_tip_tip"',">",U,"</span>"];w.append(T.join("")),w.attr("aria-labelledby",F)},"_buildDom")})()},m7EJ:function(se,ae){(function(){TS.registerModule("utility.contenteditable",{unload:function(e){if(e=a(e),!!e&&f(e)){var n=i(e);n&&(n.unload(),l(e))}},isActiveElement:function(e){if(e=a(e),!e)return!1;if(t(e))return document.activeElement===e;if(f(e)){var n=i(e);return n.hasFocus()?!0:document.activeElement&&document.activeElement.className.indexOf("ql-clipboard")!=-1&&document.activeElement.parentNode===e}return!1},focus:function(e){if(e=a(e),!!e){if(t(e))e.focus();else if(f(e)){var n=i(e);n.focus()}}},hasFocus:function(e){if(e=a(e),!!e){if(t(e))return $(e).is(":focus");if(f(e)){var n=i(e);return n.hasFocus()}}},value:function(e,n){if(e=a(e),!e)return"";if(t(e))return _.isString(n)&&(e.value=n),e.value;if(f(e)){var o=i(e);if(_.isString(n)){var c=TS.interop.texty.convertContentsStringToContents(n,{highlightWords:TS.interop.prefs.getHighlightWords(),shouldRenderEmojiAsText:TS.interop.rules.emoji.shouldRenderEmojiAsText(),emojiNames:TS.emoji.legacyGetEmojiNames(),locale:TS.interop.i18n.locale});o.setContents(c)}else _.isObject(n)&&o.setContents(n);return TS.interop.texty.convertContentsToString(o.getContents())}return""},getDisplayTextForRange:function(e,n,o){if(e=a(e),!e)return"";if(t(e)){var c=TS.utility.contenteditable.value(e);return c.substr(n,o)}if(f(e)){var v=i(e);return TS.interop.texty.convertContentsToStringForDisplay({contents:v.getContentsForRange(n,o).ops})}return""},cursorPosition:function(e,n,o){_.isString(e)&&(e=$(e));var c,v={start:0,end:0,length:0};if(e=a(e),!e)return v;if(_.isNumber(n))o||(o=0),v.start=n,v.end=n+o,v.length=o,t(e)?TS.selection.selectCharacters(e,v.start,v.end):f(e)&&(c=i(e),c.setSelection(v.start,v.length));else{if(!TS.utility.contenteditable.isActiveElement(e)){var h=$(e).data("utility-contenteditable-cursor-position");if(_.isObject(h))return h}if(t(e))e.focus(),v.start=e.selectionStart,v.end=e.selectionEnd,v.length=Math.abs(e.selectionEnd-e.selectionStart);else if(f(e)){c=i(e);var u=c.getSelection();u&&(v.start=u.index,v.length=u.length,v.end=v.start+v.length)}}return v},test:function(){var e={_normalizeInput:a,_isFormElement:t};return e}});var a=d(function(e){return!e||(e instanceof jQuery&&e[0]&&(e=e[0]),e.nodeType!==Node.ELEMENT_NODE)?!1:e.tagName.toLowerCase()==="textarea"||e.tagName.toLowerCase()==="input"?e:$(e).hasClass("ql-editor")?e.parentNode:e.hasAttribute("contenteditable")||e.tagName==="DIV"?e:!1},"_normalizeInput"),t=d(function(e){return!e||!e.tagName?!1:e.tagName.toLowerCase()==="textarea"||e.tagName.toLowerCase()==="input"},"_isFormElement"),f=d(function(e){if(!e)return!1;var n=i(e);return!!n},"_isTextyElement"),i=d(function(e){return $(e).data("__ts_quill")},"_getTextyInstance"),l=d(function(e){$(e).removeData("__ts_quill")},"_removeTextyInstance")})()},mGpN:function(se,ae){(function(){TS.registerModule("templates",{onStart:function(){f(),TS.members&&TS.members.user_color_changed_sig.add(TS.templates.memberUserColorChanged,TS.templates),TS.prefs&&TS.prefs.sidebar_behavior_changed_sig.add(TS.templates.sidebarBehaviorPrefChanged,TS.templates),TS.environment.retina_changed_sig.add(a)},makeMemberPresenceDomClass:function(l){return`member_presence_${l}`},makeMemberPresenceStateClass:function(l){var e=TS.redux.presence.getPresenceByMemberId(l.id);return e},makeMemberPresenceIcon:function(l){if(l.deleted)return"";var e=TS.templates.makeMemberPresenceDomClass(l.id),n="ts_icon_presence",o=TS.redux.presence.getPresenceByMemberId(l.id),c=o==="active"?TS.interop.i18n.t("active","templates_helpers")():TS.interop.i18n.t("away","templates_helpers")();l.is_ultra_restricted?(e+=" ura",n="ts_icon_presence_ura"):l.is_restricted?(e+=" ra",n="ts_icon_presence_ra"):TS.interop.rules.members.isExternal(l)?(e+=" external",n="ts_icon_presence_external"):l.is_slackbot&&(n="ts_icon_heart");var v=`<i aria-hidden="true" class="ts_icon ${n} presence_icon"></i>`,h=TS.templates.makeMemberPresenceStateClass(l),u=`<span data-member-presence="${l.id}" class="presence ${h} ${e}" title="${c}">${v}</span>`;return u},memberUserColorChanged:function(l){var e=`color_${l.id}`;if(l.color==l.member_color){var n=`color_rule_${e}`,o=$(`#${n}`);o.remove();return}TS.templates.makeUserColorRule(l)},makeUserColorRule:function(l){var e=`color_${l.id}`,n=`#${_.escape(l.member_color)}`,o;o=`            .${e}:not(.nuc) {                color:${n};            }        `;var c=`color_rule_${e}`,v=$(`#${c}`);v.length?v.text(o):$(`<style type="text/css" id="${c}">${o}</style>`).appendTo("body")},sidebarBehaviorPrefChanged:function(){TS.templates.makeSidebarBehaviorRule()},makeSidebarBehaviorRule:function(){var l,e="sidebar_behavior",n=$(`#${e}`);TS.prefs.getPref("sidebar_behavior")==="hide_read_channels"?l="				.channels_list_holder ul li:not(.unread):not(.active):not(.show_in_list_even_though_no_unreads) {					display: none;			}":TS.prefs.getPref("sidebar_behavior")==="hide_read_channels_unless_starred"&&(l="				.channels_list_holder div:not(#starred_div)>ul li:not(.unread):not(.active):not(.is_starred):not(.show_in_list_even_though_no_unreads) {					display: none;			}"),l?n.length?n.text(l):$(`<style type="text/css" id="${e}">${l}</style>`).appendTo("head"):$(`#${e}`).remove()}});var a=d(function(){var l,e,n,o;$(".member_image").each(function(){o=$(this),l=o.data("member-id"),e=o.data("thumb-size"),n=!o.is("a"),l&&e&&$(this).replaceWith(TS.templates.builders.makeMemberPreviewLinkImage(l,e,!1,n))}),o=null},"_redrawRetinaAssets"),t=/{{\s*i18n_ns\s*('|")[a-zA-Z0-9]+('|")\s*}}/,f=d(function(){Object.keys(TS.raw_templates).forEach(function(l){TS.templates[l]=i(l,TS.raw_templates[l]),TS.raw_template_paths||(TS.raw_template_paths={},TS.interop.utility.getLogger({getState:TS.redux.getState}).error("MISSING_RAW_TEMPLATE_PATHS")),TS.templates[`${l}_path`]=TS.raw_template_paths[l],Handlebars.registerPartial(l,TS.templates[l])}),delete TS.raw_templates},"_load"),i=d(function(l,e){if(!e)return TS.warn(`${l} was passed no html`),null;t.test(e)&&(e+=" {{_i18n_ns_end}}");var n=Handlebars.compile(e);return function(o){o=o||{};var c=!1,v=!1,h=TS.interop.experiments.getGroupForUser("jira_newxp_2040");if(h==="variant"){var u=Math.floor(Math.random()*1e5);c=u==1,TS.templates_to_audit&&TS.templates_to_audit.includes(l)&&(c=!0,v=!0)}if(c)try{var m={contexts:{ui_context:{action:"impression",ui_properties:{element_name:`${l}.hbs`}}}};!TS.interop.environment.isDev&&!TS.interop.environment.isQa&&TS.interop.clog.track("HANDLEBARS_TEMPLATE_LOGS",m);var S=/\/[A-Z0-9-.]*\//g,b=window.location.pathname.replace(S,"/#####/"),w=new Error;w.fileName=TS.templates[`${l}_path`],w.message=`${b} ${window.location.hash}`,w.stack="";var x="HANDLEBARS_TEMPLATE_LOGS";v&&(x="HANDLEBARS_TEMPLATE_LOGS_AUDIT"),TS.interop.utility.getLogger({getState:TS.redux.getState}).error(w,x,{subtype:l})}catch{}return n(o)}},"_compile")})()},mmJJ:function(se,ae){(function(){TS.registerModule("utility.members",{checkMemberMatch:function(a,t,f){return!f&&a.profile&&a.profile.email&&a.profile.email.match(t)||a.profile&&a.profile.real_name_normalized&&a.profile.real_name_normalized.match(t)||a.profile&&a.profile.real_name&&a.profile.real_name.match(t)||a.profile&&a.profile.display_name_normalized&&a.profile.display_name_normalized.match(t)||a.profile&&a.profile.display_name&&a.profile.display_name.match(t)},isMemberRelevantToModel:function(a,t){return _.isObject(a)||(a=TS.interop.members.getMemberById(a)),a?TS.interop.rules.members.isSlackbot(a)?!0:a.deleted?!1:(_.isObject(t)||(t=TS.redux.channels.getEntityById(t)||TS.shared.legacyGetActiveModelOb()),!0):!1},isMemberEKMRevoked:function(a){return a&&a.id==="UREVOKEDU"}})})()},nOzb:function(se,ae){(function(){TS.registerModule("searcher",{search:function(T,s){s.tiered?TS.telemeter.mark("ts-searcher-search-tiered-mark"):TS.telemeter.mark("ts-searcher-search-mark"),s.limit?s.limit_option={limit:s.limit}:s.limit_option={limit:a},s.members&&s.members===!0&&(s.members=_.cloneDeep(l));var g=S(T,s);if(s.tiered){var A=n(T,s);return A.promise=g,Promise.resolve(A).finally(()=>{TS.telemeter.measureAndClear("ts-searcher-search-tiered-mark","ts-searcher-search-tiered")})}return g.then(j=>{try{const Z=["U0620EL8G","WFKHTCZ29","WKLQEGRRB"];if(_.get(TS,"model.user.id")&&j.members&&Z.indexOf(TS.model.user.id)>-1){const q=_.map(j.members,ne=>({user:ne.id,is_stranger:ne.is_stranger}));TS.interop.utility.getLogger({getState:TS.redux.getState}).error("guest_to_guest_visibility",{type:"flannel_search_results",member_list:q})}}catch(Z){TS.interop.utility.getLogger({getState:TS.redux.getState}).error("guest_to_guest_visibility",{type:"flannel_search_results",error:Z})}return j}).finally(()=>{TS.telemeter.measureAndClear("ts-searcher-search-mark","ts-searcher-search")})},test:function(){return{count:F}}});var a=24,t={prefer_exact_match:!0,frecency:!0,prefer_channels_user_belongs_to:!0},f={include_archived:!0,only_if_member:!1},i={include_archived:!0},l={include_self:!1,include_slackbot:!0,include_bots:!0,only_local_team:!1,only_admins:!1},e={include_deleted:!1,include_from_another_team:!1},n=d(function(T,s){y(s);var g={};if(s.members&&(g.members=o(s.members)),s.channels&&(g.channels=c(s.channels)),s.groups&&(g.groups=v(s.groups)),s.all_mpims&&(g.all_mpims=TS.redux.channels.dangerouslyGetMpims().filter(TS.interop.rules.channels.isVisibleMpim)),s.mpims&&(g.mpims=TS.redux.channels.dangerouslyGetMpims()),s.teams&&(g.teams=h(s.teams)),s.usergroups&&(g.usergroups=u(s.usergroups)),s.views&&(g.views=m(s.views)),s.filter&&(g=s.filter(g)),s.sort!==!1){var A=ee(s.sort,s.limit_option,t);return TS.sorter.search(T,g,A)}return g},"_searchLocal"),o=d(function(T){return T=ee(T,l),TS.members.getMembersWithOptions(T)},"_getLocalMembers"),c=d(function(T){T=ee(T,f);var s;return s=TS.redux.channels.dangerouslyGetPublicChannels({includeFromAnotherTeam:T.include_from_another_team}),T.include_archived||(s=_.reject(s,TS.interop.rules.channels.isArchived)),T.exclude_required&&(s=_.reject(s,TS.interop.rules.channels.isRequired)),T.only_if_member&&(s=_.filter(s,"is_member")),T.can_post&&(s=_.filter(s,TS.interop.rules.user.canPostInChannel)),s=_.reject(s,{is_moved:1,is_archived:!0}),s},"_getLocalPublicChannels"),v=d(function(T){T=ee(T,i);var s=TS.redux.channels.dangerouslyGetPrivateChannels({includeFromAnotherTeam:T.include_from_another_team});return T.include_archived||(s=_.reject(s,TS.interop.rules.channels.isArchived)),s=_.reject(s,{is_moved:1,is_archived:!0}),s},"_getLocalPrivateChannels"),h=d(function(){var T=_.map(TS.boot_data.other_accounts,g=>TS.teams.getTeamById(g.team_id)),s=[];return TS.boot_data.page_needs_enterprise&&(!TS.model.is_our_app||TS.interop.environment.isSSBAndAtLeastVersion("2.8"))&&(s=_.values(TS.teams.getEnterpriseTeams({only_member_of:!0,exclude_current_team:!0}))),_.uniqBy(s.concat(T),"id")},"_getLocalTeams"),u=d(function(T){let s=TS.interop.userGroups.getKnownUserGroups();return T.include_deleted||(s=s.filter(g=>TS.interop.userGroups.isUserGroupActive(g))),T.include_from_another_team||(s=s.filter(g=>!TS.interop.userGroups.isUserGroupFromAnotherTeam(g.id))),s},"_getLocalUserGroups"),m=d(function(){var T=[];return T.push(_.find(TS.model.NAMED_VIEWS,{id:"Vall_threads"})),T.push(_.find(TS.model.NAMED_VIEWS,{id:"Vapp_space"})),T},"_getLocalViews"),S=d(function(T,s){var g=[],A=[];if(s.members){const j=b(T,s);(s.members.runaway?A:g).push(j)}if(s.channels||s.groups){const j=w(T,s);(s.channels&&s.channels.runaway||s.groups&&s.groups.runaway?A:g).push(j)}if(s.usergroups){const j=x(T,s);(s.usergroups.runaway?A:g).push(j)}if(TS.boot_data.page_needs_enterprise&&s.teams){const j=U(T,s);(s.teams.runaway?A:g).push(j)}return Promise.all(g).then(function(){const j=n(T,s),Z=s.sort!==!1?!!j.length:_.some(_.values(j),"length");return A.length&&!Z?new Promise(function(ne){Promise.all(A).then(ne)}).then(function(){return n(T,s)}):j})},"_searchRemote"),b=d(function(T,s){const g=T.charAt(0);return g==="#"||(g==="@"&&(T=T.slice(1)),g&&!T)?Promise.resolve():(s=ee(s.members,s.limit_option,l),s.max_api_results=s.remote_limit||s.limit,s.query=T,TS.members.promiseToSearchMembers(s).timeout(TS.interop.connectivity.getMaximumSocketWait()).catch(_.noop))},"_promiseRemoteMembers"),w=d(function(T,s){const g=T.charAt(0);if(g==="@"||(g==="#"&&(T=T.slice(1)),g&&!T))return Promise.resolve();const A=s.channels&&s.channels.include_from_another_team||s.groups&&s.groups.include_from_another_team;s=ee(s.channels||s.groups,s.limit_option);const j=s.remote_limit||s.limit;return TS.interop.channels.fetchAndUpsertChannelsWithQuery({query:{query:T,count:j},includeFromAnotherTeam:A}).timeout(TS.interop.connectivity.getMaximumSocketWait()).catch(_.noop)},"_promiseRemoteChannels"),x=d(function(T,s){const g=T.charAt(0);if(g==="#"||(g==="@"&&(T=T.slice(1)),g&&!T))return Promise.resolve();s=ee(s.usergroups,s.limit_option,e);const A=s.remote_limit||s.limit;return TS.interop.userGroups.fetchAndUpsertUserGroupsWithQuery({query:T,count:A}).catch(_.noop)},"_promiseRemoteUserGroups"),U=d(function(T,s){s=ee(s.teams,s.limit_option);const g=s.remote_limit||s.limit;return TS.interop.teams.fetchAndUpsertTeamsWithQuery({query:T,count:g}).catch(_.noop)},"_promiseRemoteTeams"),ee=d(function(T,s){return T===!0&&(T={}),_.defaultsDeep.apply(null,arguments)},"_mergeDefaults"),F=d(function(T){return _.size(_.flatten(_.values(T)))},"_totalCount"),y=d(function(T){(T.members||T.mpims||T.all_mpims)&&TS.interop.members.pauseRefetch(),(T.channels||T.groups||T.mpims||T.all_mpims)&&TS.interop.channels.pauseRefetch(),T.teams&&TS.interop.teams.pauseRefetch()},"_pauseConditionalFetching")})()},oTOb:function(se,ae){(function(){TS.registerModule("ui.edit_member_profile",{onStart:function(){TS.members.changed_profile_sig.add(t)}});var a,t=d(function(){a&&$("#edit_member_profile_photo_container .member_image").replaceWith(TS.templates.builders.makeMemberPreviewLinkImage(TS.model.user.id,192,!1,!0))},"_maybeUpdateMemberPhoto")})()},q3cq:function(se,ae){(function(){TS.registerModule("redux.teams",{onStart:function(){Object.defineProperty(TS.model,"team",{get:function(){return TS.redux.teams.getCurrentTeam()},set:function(){return TS.error("TS.redux.teams: trying to set TS.model.team???"),!1}})},upsertTeam:function(a){if(!(!a||!a.id))return TS.interop.teams.upsertTeam({team:a})},getTeamById:function(a,t){return TS.interop.teams.getTeamById?TS.interop.teams.getTeamById(a,t):null},getAllTeams:function(){return TS.interop.teams.getAllTeams?TS.interop.teams.getAllTeams():null},getCurrentTeam:function(){return TS.interop.teams.getCurrentTeam?TS.interop.teams.getCurrentTeam():null},fetchAndUpsertEnterpriseOrgInfo:function(){return TS.interop.teams.fetchAndUpsertEnterpriseOrgInfo?TS.redux.dispatch(TS.interop.teams.fetchAndUpsertEnterpriseOrgInfo()):null}})})()},"qQ+f":function(se,ae){(function(){TS.registerModule("groups",{switched_sig:new signals.Signal,message_changed_sig:new signals.Signal})})()},qWi6:function(se,ae){(function(){TS.registerModule("utility.search",{test:function(){return{_fetchMembersFromFlannel:i}},makeClause:function(e,n,o){if(!a(e,n,o)){var c={type:e.toLowerCase(),value:n};return o&&(c.field_id=o),c}},makeConjunction:function(e,n){if(!t(e,n))return{type:e.toLowerCase(),clauses:n}},promiseToSearch:function(e){if(!e)return Promise.reject(new Error("Cannot search without arguments."));if(e.all_of_org&&!TS.boot_data.page_needs_enterprise)return Promise.reject(new Error("cannot search an org when not an enterprise team"));if(!e.solr){if(!e.hasOwnProperty("raw_query"))return Promise.reject(new Error("Flannel searches require a `raw_query` to be provided"));var n=e.raw_query,o=e.count||1/0,c;if(_.isEmpty(e.raw_query)&&!e.only_admins)c=Promise.resolve([]);else{var v={};e.only_admins?v.filter="admins":e.only_local_team&&(v.filter="team"),c=i(e.raw_query,o,e.determine_membership_for_channel,v)}return c.then(function(m){var S=m.objects;if(!e.include_bots){var b=_.remove(S,{is_bot:!0});b.length&&TS.has_pri[l]&&TS.log(l,"Flannel: removed these bots from results:",b)}if(e.exclude_slackbot&&e.include_bots){var w=_.remove(S,{is_slackbot:!0});w.length&&TS.has_pri[l]&&TS.log(l,"Flannel: removed slackbot from results:",w)}if(TS.boot_data.page_needs_enterprise&&!e.all_of_org){var x=_.remove(S,function(F){var y=_.get(F,"enterprise_user.teams",[]),T=_.includes(y,TS.model.team.id),s=e.include_profile_only_users&&F.is_profile_only_user;return!T&&!s});x.length&&TS.has_pri[l]&&TS.log(l,"Flannel: removed these org members from results:",x)}if(!e.include_deleted){var U=_.remove(S,{deleted:!0});U.length&&TS.has_pri[l]&&TS.log(l,"Flannel: removed these deleted members from results:",U)}if(!e.include_profile_only_users){var ee=_.remove(S,{is_profile_only_user:!0});ee.length&&TS.has_pri[l]&&TS.log(l,"Flannel: removed these profile-only users from results:",ee)}return S=_.intersectionBy(TS.members.getMembersForUser(),S,"id"),{ok:!0,data:{items:S.slice(0,o),next_cursor_mark:null,num_found:S.length,teams:[TS.model.team]},args:{query:n}}})}if(!e.query)return Promise.reject(new Error("Cannot search without a query."));var h={query:JSON.stringify(e.query)};["sort","sort_direction","count","cursor_mark","include_bots","include_deleted","exclude_slackbot","ignore_guest_accounts"].forEach(function(m){e.hasOwnProperty(m)&&(h[m]=e[m])});var u=e.endpoint;return u||(u=e.all_of_org?"search.enterprise":"search.team"),TS.interop.api.call(u,h).catch(f)}});var a=d(function(e,n,o){if(!e){TS.error("cannot make a clause without a type");return}if(!n){TS.error("cannot make a clause without a value");return}e==="custom"&&!o&&TS.error("cannot make a custom type clause without a field id")},"_validateClauseParameters"),t=d(function(e,n){if(!e){TS.error("cannot make a conjunction without an 'and' or 'or' type");return}(!n||n.length<2)&&TS.error("cannot make a conjunction without at least two clauses")},"_validateConjunctionParameters"),f=d(function(e){throw TS.error(`${e.data.error} error occured while searching`),TS.generic_dialog.alert(TS.interop.i18n.t("Sorry! Something went wrong. Please try again.","utility_search")()),e},"_handleError"),i=d(function(e,n,o,c){c=c||{};var v={query:e,count:n};c.filter&&(v.filter=c.filter);var h=TS.members.fetchAndUpsertMembersWithQuery(v);if(!o)return h;var u=_.assign({channels:[o]},v),m=TS.members.fetchAndUpsertMembersWithQuery(u);return Promise.join(h,m).then(function(S){var b=S[0],w=S[1],x=_.map(b.objects,"id"),U=_.map(w.objects,"id"),ee={};return U.forEach(function(F){ee[F]=!0}),_.difference(x,U).forEach(function(F){ee[F]=!1}),TS.redux.dispatch(TS.interop.redux.models.membership.setChannelMembershipInfoForUsers({channelId:o,membershipInfo:ee})),b})},"_fetchMembersFromFlannel"),l=1989})()},qYTV:function(se,ae,a){"use strict";a.r(ae);var t=a("LzIY"),f=a.n(t),i=a("GhXE"),l=a.n(i),e=a("XUc0"),n=a.n(e),o=a("J7dF"),c=a.n(o),v=a("laYx"),h=a.n(v),u=a("gYX6"),m=a.n(u),S=a("sOV0"),b=a.n(S),w=a("weHv"),x=a.n(w),U=a("VACg"),ee=a.n(U),F=a("2hNN"),y=a.n(F),T=a("EXLS"),s=a.n(T),g=a("Ysd/"),A=a.n(g),j=a("/xdr"),Z=a.n(j),q=a("GNek"),ne=a.n(q),oe=a("q3cq"),D=a.n(oe),Y=a("YZHV"),J=a.n(Y),B=a("fK9Z"),R=a.n(B),M=a("Oszc"),E=a.n(M),k=a("qQ+f"),O=a.n(k),z=a("Foai"),W=a.n(z),V=a("gm7A"),Q=a.n(V),K=a("F/UT"),te=a.n(K),de=a("W17R"),fe=a.n(de),ue=a("zkfd"),_e=a.n(ue),he=a("Pv2O"),N=a.n(he),p=a("rRwQ"),P=a.n(p),I=a("7EQy"),H=a.n(I),ie=a("4Cq+"),re=a.n(ie),ce=a("SaiC"),pe=a.n(ce),Se=a("8FFK"),Ee=a.n(Se),ye=a("mGpN"),Be=a.n(ye),ke=a("j9dp"),Ue=a.n(ke),Me=a("I1WX"),xe=a.n(Me),Ie=a("4KQo"),Ne=a.n(Ie),Oe=a("6btA"),je=a.n(Oe),Le=a("mmJJ"),ze=a.n(Le),Ae=a("aLMH"),We=a.n(Ae),De=a("Cs7e"),Ke=a.n(De),Fe=a("Chwb"),Ge=a.n(Fe),Re=a("EcSN"),Ve=a.n(Re),He=a("L48h"),r=a.n(He),C=a("oTOb"),G=a.n(C),L=a("UP61"),X=a.n(L),le=a("HUaD"),me=a.n(le),ge=a("9mk2"),ve=a.n(ge),Te=a("Zt5a"),$e=a.n(Te),be=a("HfRC"),Pe=a.n(be),we=a("IZwQ"),Ce=a.n(we),Ye=a("R0Lu"),_t=a.n(Ye),Je=a("5+2p"),ut=a.n(Je),Qe=a("bdn/"),dt=a.n(Qe),Ze=a("3Vm1"),ft=a.n(Ze),Xe=a("gj8S"),ct=a.n(Xe),qe=a("54vr"),mt=a.n(qe),et=a("qWi6"),pt=a.n(et),tt=a("m7EJ"),ht=a.n(tt),rt=a("Nyv6"),gt=a.n(rt),nt=a("VTIS"),vt=a.n(nt),it=a("G4VQ"),St=a.n(it),at=a("zmUN"),Tt=a.n(at),st=a("nOzb"),bt=a.n(st),lt=a("T0l3"),yt=a.n(lt)},rRwQ:function(se,ae){(function(){TS.registerModule("members",{presence_changed_sig:new signals.Signal,user_color_changed_sig:new signals.Signal,changed_current_status_sig:new signals.Signal,changed_name_sig:new signals.Signal,changed_real_name_sig:new signals.Signal,changed_deleted_sig:new signals.Signal,changed_profile_sig:new signals.Signal,changed_tz_sig:new signals.Signal,changed_account_type_sig:new signals.Signal,changed_admin_perms_sig:new signals.Signal,changed_owner_perms_sig:new signals.Signal,changed_self_sig:new signals.Signal,lazily_added_sig:new signals.Signal,batch_upserted_sig:new signals.Signal,member_was_upserted_sig:new signals.Signal,changed_is_unknown_sig:new signals.Signal,legacy_is_in_bulk_upsert_mode:!1,onStart:function(){TS.channels.joined_sig.add(()=>{TS.members.invalidateMembersUserCanSeeArrayCaches()}),TS.channels.left_sig.add(()=>{TS.members.invalidateMembersUserCanSeeArrayCaches()})},legacyUpsertAndSignal:function(s){var g=TS.members.legacyUpsertMember(s);return T(g,s)},legacyUpsertMember:function(s){var g=TS.redux.members.hasMemberWithId(s.id)&&TS.interop.members.getRawMemberById(s.id),A="NOOP",j=[];if(s=TS.interop.members.processMemberForUpserting(s),g){TS.has_pri[F]&&TS.log(F,`updating existing member "${s.id}"`);var Z=x(g,s);if(A=Z.status,j=Z.what_changed,_.includes(j,"deleted")){var q=TS.redux.channels.getImByMemberId(s.id);q&&(q.is_archived=s.deleted)}}else s.id?(A="ADDED",_.includes(c,s.id)&&j.push("is_unknown"),U(s),TS.has_pri[F]&&TS.log(F,`adding member "${s.id}" color:${s.color} member_color:${s.member_color}`)):TS.error("bad error, no member.id");if(s.is_self&&s.deleted){TS.reload(null,"member.is_self && member.deleted");return}TS.members.legacy_is_in_bulk_upsert_mode||(TS.members.invalidateMembersUserCanSeeArrayCaches(),TS.members.invalidateActiveMembersArrayCaches()),TS.members.member_was_upserted_sig.dispatch(),TS.members.legacy_is_in_bulk_upsert_mode||(A!=="NOOP"&&(TS.interop.members.dangerouslyAddMember(s),TS.redux.dispatch(TS.interop.redux.features.presence.updatePresence({memberId:s.id,presence:s.presence||"away"}))),TS.interop.members.markObjectsAsFresh([s.id]),TS.interop.members.setCanMembersInteract([s]));var ne={status:A,member:s,what_changed:j};return TS.members.legacy_is_in_bulk_upsert_mode&&a.push(ne),ne},setMemberUserColor:function(s,g){g=_.escape(g),s.member_color=g||s.color,g&&g!=s.color?TS.model.user_colors[s.id]=g:delete TS.model.user_colors[s.id],TS.members.user_color_changed_sig.dispatch(s)},getActiveMembersWithSelfAndNotSlackbot:function(){return t.length||(t=v(t,{include_self:!0,include_slackbot:!1,include_bots:!0})),t},getMembersWithOptions:function(s){var g=TS.members.getMembersForUser(),A=_.filter(g,function(j){return j.is_stranger?!1:s.only_admins?j.is_admin&&!j.deleted:!(s.only_local_team&&!TS.interop.rules.members.isMemberOnTeam(j,TS.model.team.id)||!s.include_deleted&&j.deleted||!s.include_slackbot&&TS.interop.rules.members.isSlackbot(j)||!s.include_self&&j.is_self||!s.include_bots&&j.is_bot)});return A},getMembersForUser:function(){return o.length||(o=_.filter(TS.redux.members.getAllMembers(),function(s){return s.is_stranger!==!0&&!!s.name})),o},legacyGetPrefCompliantMemberNameLowerCase:function(s,g){if(!s)return"";var A=function(){var j=TS.interop.rules.members.getMemberRealNameLowerCase(s);return!TS.interop.members.shouldDisplayRealNames()&&TS.interop.rules.members.getMemberProfileFieldDisplayNameLowerCase(s)&&(j=TS.interop.rules.members.getMemberProfileFieldDisplayNameLowerCase(s)),j}();return g?_.escape(A):A},invalidateMembersUserCanSeeArrayCaches:function(){if(TS.model.user){var s=o.length;s&&(o.length=0,TS.members.invalidateActiveMembersArrayCaches())}},invalidateActiveMembersArrayCaches:function(){t.length=0,f.length=0,i.length=0,l.length=0,e.length=0,n.length=0},legacyEnsureMembersInDataArePresent:function(s,g){var A=TS.interop.utility.extractAllMemberIds(s);if(_.get(TS,"model.team.id")==="T02J3DPUE"&&!_.isEmpty(A)){var j=_.some(A,function(q){return q[0]==="U"});if(j){var Z={message:`Fetching U users on W team from source: ${g}`,stack:TS.console.getStackTrace()};$.post(TS.boot_data.beacon_error_url,{description:"fetch_u_on_w_team",error_json:JSON.stringify(Z),team:_.get(TS,"model.team.id","none"),user:TS.boot_data.user_id,version:TS.boot_data.version_ts})}}return TS.interop.members.ensureMembersArePresent(A)},fetchAndUpsertMembersWithQuery:function(s){return TS.interop.members.fetchAndUpsertMembersWithQuery({query:s}).then(g=>{let{members:A,next_marker:j}=g;return{objects:A,next_marker:j}})},legacyStartBatchUpsert:function(){return TS.members.legacy_is_in_bulk_upsert_mode?!1:(TS.members.legacy_is_in_bulk_upsert_mode=!0,!0)},legacyFinishBatchUpsert:function(){if(!TS.members.legacy_is_in_bulk_upsert_mode)return!1;TS.members.legacy_is_in_bulk_upsert_mode=!1,TS.members.invalidateMembersUserCanSeeArrayCaches(),TS.members.invalidateActiveMembersArrayCaches();var s=_.partition(a,function(j){return _.includes(j.what_changed,"is_unknown")}),g=s[0];TS.interop.members.dangerouslyBulkAddMembers(a.map(j=>j.member));var A=a.reduce((j,Z)=>{var q=Z.member;return q.presence&&(j[q.id]=j[q.presence]),j},{});return TS.redux.dispatch(TS.interop.redux.features.presence.bulkUpdatePresence(A)),g.length>0&&TS.members.changed_is_unknown_sig.dispatch({batch:_.map(g,"member")}),TS.members.batch_upserted_sig.dispatch(a),TS.interop.members.markObjectsAsFresh(_.map(a,"member.id")),TS.interop.members.setCanMembersInteract(a.map(j=>j.member)),a=[],!0},legacyAllocateTeamListMembers:function(s){var g,A=[],j=[],Z=[],q=[],ne=[],oe=[];s.sort(function(Y,J){var B=Y._real_name_lc||Y._name_lc,R=J._real_name_lc||J._name_lc;return B>R?1:R>B?-1:0});for(var D=0;D<s.length;D+=1)g=s[D],g.deleted?g.is_bot?Z.push(g):j.push(g):g.is_ultra_restricted?oe.push(g):g.is_restricted?ne.push(g):g.is_bot||TS.interop.rules.members.isSlackbot(g)?q.push(g):A.push(g);return{members:A,disabled_members:j,deleted_bots:Z,bots:q,restricted_members:ne,ultra_restricted_members:oe}},promiseToSearchMembers:function(s){return Promise.resolve(s).then(function(g){return g?(g.query=g.query&&g.query.trim()||"",g.include_org=!!TS.boot_data.page_needs_enterprise&&!!g.include_org,g.org_team_ids=g.include_org&&Array.isArray(g.org_team_ids)?g.org_team_ids:[],g=u(g,TS.interop.searcher.isNewMemberSearch(g)),g._is_new||g.num_remaining>0?m(g):Promise.resolve(g)):Promise.reject(new Error("No search parameters provided"))})},legacySetMemberUnknown:function(s){c.push(s)},test:function(){var s={};return Object.defineProperty(s,"_accessible_user_ids_last_fetched_ts",{get:function(){return ee},set:function(g){ee=g}}),Object.defineProperty(s,"_processNewMemberForUpserting",{get:function(){return U},set:function(g){U=g}}),Object.defineProperty(s,"_processExistingMemberForUpserting",{get:function(){return x},set:function(g){x=g}}),Object.defineProperty(s,"_fillMembersWithOptions",{get:function(){return v},set:function(g){v=g}}),Object.defineProperty(s,"_members_for_user",{get:function(){return o},set:function(g){o=g}}),s}});var a=[],t=[],f=[],i=[],l=[],e=[],n=[],o=[],c=[],v=d(function(s,g){if(!_.isArray(s))throw new TypeError("members passed to _fillMembersWithOptions is not an array!");s.length=0;var A=TS.members.getMembersWithOptions(g);return _.each(A,function(j){s.push(j)}),s},"_fillMembersWithOptions"),h=d(function(s){var g=s?s.is_unknown:!1;return s&&s.is_unknown&&(s.is_unknown=!1),_.pull(c,s.id),g},"_maybeSetMemberKnown"),u=d(function(s,g){return s=s||{},s.hasOwnProperty("_searcher_p")&&g&&s._searcher_p.cancel(),(!s.hasOwnProperty("_cursor_mark")||g)&&(s._cursor_mark=""),s.hasOwnProperty("full_profile_filter")||(s.full_profile_filter=!0),s.hasOwnProperty("include_bots")||(s.include_bots=!0),s.hasOwnProperty("include_deleted")||(s.include_deleted=!1),s.hasOwnProperty("include_self")||(s.include_self=!1),s.hasOwnProperty("include_slackbot")||(s.include_slackbot=!0),s.hasOwnProperty("include_profile_only_users")||(s.include_profile_only_users=!1),s.hasOwnProperty("only_local_team")||(s.only_local_team=!1),s.hasOwnProperty("only_admins")||(s.only_admins=!1),(!s.hasOwnProperty("items")||g)&&(s.items=[]),s.hasOwnProperty("not_member_of")||(s.not_member_of=[]),s.hasOwnProperty("member_of")||(s.member_of=[]),(!s.hasOwnProperty("num_found")||g)&&(s.num_found=0),(!s.hasOwnProperty("num_remaining")||g)&&(s.num_remaining=0),(!s.hasOwnProperty("num_new")||g)&&(s.num_new=0),s.hasOwnProperty("max_api_results")||(s.max_api_results=100),g&&(s._last_query=s.query,s._last_include_org=s.include_org,s._last_org_team_ids=s.org_team_ids),s._is_new=!!g,s},"_readyMemberSearcher"),m=d(function(s){var g=d(function(){return b(s)},"promiseToSearch");return s._is_new?s._searcher_p=g():s._searcher_p=s._searcher_p.then(g),s._searcher_p},"_promiseToSearchMembers"),S=d(function(s){var g=[TS.utility.search.makeClause("is","user")];if(s._last_query){var A=s._last_query.split(/\s*,\s*|\s+/).map(function(D){return D.charAt("0")==="@"?D.substring(1):D}).filter(function(D){return!!D}).map(function(D){return D.length===1||!s.full_profile_filter?TS.utility.search.makeConjunction("OR",[TS.utility.search.makeClause("real_name",D),TS.utility.search.makeClause("display_name",D)]):TS.utility.search.makeClause("fuzzy_with_email",D)});g=g.concat(A)}if(s.not_member_of&&s.not_member_of.length){var j=s.not_member_of.map(function(D){return TS.utility.search.makeClause("not_member_of",D)});g.push(j.length>1?TS.utility.search.makeConjunction("OR",j):j[0])}if(s.member_of&&s.member_of.length){var Z=s.member_of.map(function(D){return TS.utility.search.makeClause("member_of",D)});g.push(Z.length>1?TS.utility.search.makeConjunction("OR",Z):Z[0])}if(s._last_include_org&&s._last_org_team_ids.length){var q=s._last_org_team_ids.map(function(D){return TS.utility.search.makeClause("belongs_to_team_id",D)});g.push(q.length>1?TS.utility.search.makeConjunction("OR",q):q[0])}var ne=g.length>1?TS.utility.search.makeConjunction("AND",g):g[0],oe={query:ne,count:s.max_api_results,include_bots:s.include_bots,include_deleted:s.include_deleted,ignore_guest_accounts:s.ignore_guest_accounts,only_local_team:s.only_local_team,only_admins:s.only_admins,include_profile_only_users:s.include_profile_only_users,raw_query:s.query,solr:s.solr};return s._last_include_org&&(oe.all_of_org=s._last_include_org),s._cursor_mark&&(oe.cursor_mark=s._cursor_mark),s.determine_membership_for_channel&&(oe.determine_membership_for_channel=s.determine_membership_for_channel),oe},"_buildPromiseToSearchMembersArguments"),b=d(function(s){var g=S(s);return s.num_new=0,TS.utility.search.promiseToSearch(g).then(function(A){if(!A.data.items.length)return Promise.resolve(s);s.num_remaining||(s.num_remaining=A.data.num_found,s.num_found=A.data.num_found),s.num_remaining-=A.data.items.length,s._cursor_mark=A.data.next_cursor_mark;var j=A.data.items.map(function(Z){var q=TS.interop.members.getMemberById(Z.id);return q||(s._last_include_org&&Z.team_id!==TS.model.team.id&&(Z.is_primary_owner=!1,Z.is_owner=!1,Z.is_admin=!1),q=TS.members.legacyUpsertMember(Z).member),q}).filter(function(Z){return Z.is_self&&!s.include_self||TS.interop.rules.members.isSlackbot(Z)&&!s.include_slackbot?(s.num_found-=1,!1):s.limit_by_model_relevancy?TS.utility.members.isMemberRelevantToModel(Z,s.limit_by_model_relevancy):!0});return s.num_new=j.length,s.items.push.apply(s.items,j),Promise.resolve(s)})},"_promiseToSearchMembersWorker"),w=d(function(s){return _.isObject(s)?_.omitBy(s,function(g,A){return A.indexOf("image_")===0}):s},"_omitImagesFromProfile"),x=d(function(s,g){var A="NOOP",j=[];return Object.keys(g).forEach(function(Z){if(Z==="profile"){var q=w(s.profile),ne=w(g.profile);if(_.isObject(ne)){(q.status_text!==ne.status_text||q.status_emoji!==ne.status_emoji)&&(A="CHANGED",j.push("current_status"));var oe=Object.keys(q).filter(function(R){return typeof ne[R]>"u"}).concat(["status_text","status_emoji"]);q=_.omit(q,oe),ne=_.omit(ne,oe),_.isEqual(q,ne)||(A="CHANGED",j.push(Z))}}else if(Z==="enterprise_user")if(s[Z])for(var D in g[Z])_.isEqual(s[Z][D],g[Z][D])||(A="CHANGED",j.push(Z));else A="CHANGED",j.push(Z);else if(Z==="id"){var Y=s.id!=g.id&&s.enterprise_user&&g.enterprise_user;if(Y){var J=s.enterprise_user.id===s.id,B=g.id!=g.enterprise_user.id;J&&B&&(A="CHANGED",j.push(Z))}}else Z==="teams"?(A="CHANGED",j.push(Z)):s[Z]!=g[Z]&&(Z==="is_admin"&&TS.has_pri[y]&&(TS.warn(y,`${Z}is changing from \`${s[Z]}\` to \`${g[Z]}\``),TS.console.trace(y)),g[Z]&&!TS.utility.isScalar(g[Z])?(s[Z]=g[Z],TS.warn(`${Z} is not scalar! it needs to be handled by upsertMember specifically to test if it has changed! ${typeof g[Z]}`)):(typeof g[Z]!="boolean"||!g[Z]!=!s[Z])&&(j.push(Z),A="CHANGED"))}),h(s)&&j.push("is_unknown"),{status:A,what_changed:j}},"_processExistingMemberForUpserting"),U=d(function(s){TS.members.user_color_changed_sig.dispatch(s)},"_processNewMemberForUpserting"),ee=0,F=4,y=1975,T=d(function(s,g){if(s.status==="ADDED")TS.members.lazily_added_sig.dispatch(s.member);else if(s.status==="CHANGED"){if(s.what_changed.indexOf("is_unknown")!==-1)return TS.members.changed_is_unknown_sig.dispatch(s.member),s;s.what_changed.indexOf("current_status")!==-1&&TS.members.changed_current_status_sig.dispatch(s.member),s.what_changed.indexOf("profile")!==-1&&TS.members.changed_profile_sig.dispatch(s.member),(s.what_changed.indexOf("is_restricted")!==-1||s.what_changed.indexOf("is_ultra_restricted")!==-1)&&TS.members.changed_account_type_sig.dispatch(s.member),s.what_changed.indexOf("real_name")!==-1&&TS.members.changed_real_name_sig.dispatch(s.member),(s.what_changed.indexOf("member_color")!==-1||s.what_changed.indexOf("color")!==-1)&&TS.members.user_color_changed_sig.dispatch(s.member),s.what_changed.indexOf("name")!==-1&&TS.members.changed_name_sig.dispatch(s.member),s.what_changed.indexOf("tz")!==-1&&TS.members.changed_tz_sig.dispatch(s.member),s.what_changed.indexOf("deleted")!==-1&&TS.members.changed_deleted_sig.dispatch(s.member),s.what_changed.indexOf("presence")!==-1&&TS.members.presence_changed_sig.dispatch(s.member),s.what_changed.indexOf("is_owner")!==-1&&TS.members.changed_owner_perms_sig.dispatch(s.member),s.what_changed.indexOf("is_admin")!==-1&&TS.members.changed_admin_perms_sig.dispatch(s.member),g.is_self&&TS.members.changed_self_sig.dispatch(s.member)}return s},"_signalUpsert")})()},sOV0:function(se,ae){(function(){TS.registerModule("redux.channels.interop",{maybeWrapEntity:function(F){return!F||!F.id?F:ee(F.id)}});var a=TS.interop.channels.getChannelById,t={},f={},i={},l=d(function(){var F=window.Proxy&&U();return F},"_shouldWrapEntityInProxyObject"),e=d(function(F,y,T){if(!(!F||!y)){var s={id:F};s[y]=T,TS.interop.channels.updateOneKeyForChannel(s)}},"_updateOneKeyForChannel"),n=["_show_in_list_even_though_no_unreads","deleted","has_draft","is_archived","is_frozen","is_channel","is_ext_shared","is_group","is_im","is_member","is_mpim","is_open","is_org_shared","is_pending_ext_shared","is_starred","last_read","members","priority","unread_cnt","unread_highlight_cnt","internalTeamIds","pendingAndConnectedTeamIds"],o=["_display_name","_archive_msgs","_checking_at_channel_status","_delayed_fetch_timer","_did_defer_initial_msg_history","_display_name_lc","_display_name_truncated","_i18n_ns_history","_i18n_ns","_internal_name","_jumper_previous_name_match","_latest_via_users_counts","_mark_most_recent_read_timer","_marked_reason","_members","_mention_count_display_via_users_counts","_name_lc","_prev_last_read","_score","_users_counts_info","active_members","can_thread","create_channel","created","creator","date_created","enterprise_id","fetched_history_after_scrollback_time","has_fetched_history_after_scrollback","has_pins","history_changed","history_fetch_failed","history_fetch_retries","history_is_being_fetched","id","inherit","is_default","is_general","is_global_shared","is_limited","is_moved","is_non_threadable","is_org_default","is_org_mandatory","is_private","is_read_only","is_thread_only","last_made_active","last_msg_input","latest","length","member","msgs","name_normalized","name","needs_joined_message","never_needs_joined_msg","note","num_members","old_name","oldest_msg_ts","opened_this_session","org","parent_group","pinned_items","pinned_items_count","presence","previous_names","purpose","scroll_top","shares","domain","tooltip","topic","unlinked","unread_count_display","unread_count","unread_highlight_cnt_in_client","unread_highlights","unreads","user","was_archived_this_session","isUnknown","isNonExistent","fromAnotherTeam","internalTeamIds","team_id","pendingAndConnectedTeamIds","previously_connected_team_ids","pending_connected_team_ids","conversation_host_id"],c=["_get","_is_interop_channel_object","_set","_setWithReduxAction","attributes","children","disabled","is_broadcast_keyword","is_divider","is_emoji","is_usergroup","is_view","is_app_action","nodeType","old_name","props_to_define","selector","then","title","toObject","toJSON","window","@@toStringTag"],v=_.reduce(n,function(F,y){return F[y]=!0,F},{}),h=_.reduce(o,function(F,y){return F[y]=!0,F},{}),u=_.reduce(c,function(F,y){return F[y]=!0,F},{}),m={},S=d(function(F,y){if(!h[y]&&!v[y]&&!u[y]&&_.isString(y)){TS.console.logStackTrace(`Accessing an unknown key ${y} on a model object`),i[y]||(i[y]=!0),U()&&TS.console.error(`Dev only warning: Trying to get an unknown field "${y}" from a model object. If this is not a typo and you are relying on this property, please try and store this data outside of the model ob, or add to the model_ob_keys_as_map whitelist in TS.redux.channels.interop.source.js. Questions? Feel free to ask in #dhtml`);var T=a(F.id);return T&&T[y]}return F[y]},"_proxyGet"),b=d(function(F,y,T){if(_.isString(y)&&(t[y]=(t[y]||0)+1),!h[y]&&!v[y]&&_.isString(y)){if(TS.console.logStackTrace(`Setting an unknown key ${y} on a model object`),i[y]||(i[y]=!0),U())throw new Error(`Dev only warning: Trying to set an unknown field "${y}" on a model object. If this is not a typo and you are relying on this property, please try and store this data outside of the model ob, or add to the model_ob_keys_as_map whitelist in TS.redux.channels.interop.source.js. Questions? Feel free to ask in #dhtml`);var s=a(F.id);s&&(s[y]=T)}return F[y]=T,!0},"_proxySet"),w=d(function(F){this.id=F,Object.defineProperties(this,this.props_to_define)},"_Channel"),x={};_.without(o,"id").forEach(function(F){x[F]={enumerable:!0,get:function(){return this._get(F)},set:function(y){return this._set(F,y)}},n.forEach(function(y){x[y]={enumerable:!0,get:function(){return this._get(y)},set:function(T){return this._setWithReduxAction(y,T)}}})}),w.prototype.props_to_define=x,w.prototype._is_interop_channel_object=!0,w.prototype._get=function(F){var y=a(this.id);if(y)return y[F]},w.prototype._set=function(F,y){var T=a(this.id);return T&&(T[F]=y),!0},w.prototype._setWithReduxAction=function(F,y){var T=a(this.id);return T&&T[F]!==y&&(e(this.id,F,y),f[F]=(f[F]||0)+1),!0};var U=d(function(){return TS.boot_data&&(TS.boot_data.version_ts==="dev"||TS.boot_data.version_ts==="local_js")},"_isDev"),ee=d(function(F){if(!F)throw new Error("Must pass in a valid id to _createWrappedEntityById");var y,T=l();return m[F]?y=m[F]:(y=new w(F),T&&(y=new window.Proxy(y,{get:function(s,g){return S(s,g)},set:function(s,g,A){return b(s,g,A)}})),m[F]=y),y},"_createWrappedEntityById")})()},weHv:function(se,ae){(function(){TS.registerModule("redux.presence",{onStart:function(){i()},getPresenceByMemberId:function(l){return a(l)},updatePresenceForMember:function(l){!l||!l.id||TS.redux.dispatch(TS.interop.redux.features.presence.updatePresence({memberId:l.id,presence:l.presence}))}});var a=TS.redux.bindSelectorToStore("TS.interop.redux.features.presence.getPresenceByMemberId"),t={},f=d(function(){t.length&&(TS.redux.dispatch(TS.interop.redux.features.presence.bulkUpdatePresence(t)),t={})},"_bulkUpsertPresences"),i=d(function(){TS.members.presence_changed_sig.add(TS.redux.presence.updatePresenceForMember),TS.members.batch_upserted_sig.add(f)},"_addSignalListeners")})()},zkfd:function(se,ae){(function(){TS.registerModule("teams",{rename_sig:new signals.Signal,changed_icon_sig:new signals.Signal,onStart:function(){TS.teams.changed_icon_sig.add(f),TS.teams.rename_sig.add(f)},getTeamById:function(h,u){return _.isString(h)?TS.redux.teams.getTeamById(h,u):null},isPartOfMyOrg:function(h){if(!_.isObject(h))return!1;const u=v();return u&&u===h.enterprise_id},getAllEnterpriseTeams:function(){return _.pickBy(TS.redux.teams.getAllTeams(),TS.teams.isPartOfMyOrg)},getEnterpriseTeams:function(h){h=_.isObject(h)?h:{};var u=TS.teams.getAllEnterpriseTeams();return h.only_member_of&&(u=_.pickBy(u,m=>TS.model.user.enterprise_user.teams.indexOf(m.id)>-1)),h.exclude_current_team&&(u=_.omitBy(u,m=>m.id===TS.model.team.id)),u},ensureTeamsArePresent:function(h){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"TS.teams.ensureTeamsArePresent";if(!_.isArray(h))return Promise.reject(Error("t_ids is not an array"));var m=_.filter(h,function(S){var b=!1,w=TS.teams.getTeamById(S,b);return!w||w._other_account});return m.length?t(m,u):Promise.resolve()},ensureTeamsInDataArePresent:function(h){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"TS.teams.ensureTeamsInDataArePresent";var m=TS.interop.utility.extractAllTeamIds(h);return TS.teams.ensureTeamsArePresent(m,u)},promiseToSearchTeams:function(h){return v()?Promise.resolve(h).then(function(u){return u?(u=e(u),u._is_new||u.num_remaining>0?o(u):Promise.resolve(u)):Promise.reject(new Error("No search parameters provided"))}):Promise.resolve(h)},test:function(){var h={_getSharedTeamIdsForMember:l};return Object.defineProperty(h,"_readyTeamSearcher",{get:function(){return e},set:function(u){e=u}}),Object.defineProperty(h,"_promiseToSearchTeamsWorker",{get:function(){return c},set:function(u){c=u}}),Object.defineProperty(h,"_buildPromiseToSearchTeamsArguments",{get:function(){return n},set:function(u){n=u}}),Object.defineProperty(h,"_getTeamsByIdFromApi",{get:function(){return t},set:function(u){t=u}}),h}});const a=100;var t=d(function(h,u){if(!_.isArray(h))return Promise.reject(Error("t_ids is not an array"));const m=250,S=_.chunk(h,m);return Promise.map(S,b=>TS.interop.api.callExpedited("team.info",{teams:b,_x_reason:u}).then(w=>{var x=[];return w.data.teams.forEach(function(U){U&&U.id&&U.id.charAt(0)==="E"?TS.warn(`EVALUE-1721: team.info response included an Enterprise org of ${U.id}. NOT adding to model. Client requested teams=${b.join(", ")}.`):x.push(TS.redux.teams.upsertTeam(U))}),x}).catch(w=>{TS.error(`_getTeamsByIdFromApi failed with ${w.data&&w.data.error||"unknown error"}, when requesting teams=${b.join(", ")}`)})).then(b=>_.compact(_.flatten(b)))},"_getTeamsByIdFromApi"),f=d(function(h){h.id!==TS.model.team.id&&i(h)},"_handleTeamChange"),i=d(function(h){if(_.isObject(h)){var u=TS.utility.teams.getMembersForTeam(h);u.length&&_.forEach(u,function(m){TS.members.changed_profile_sig.dispatch(m)})}},"_updateTeamMembers"),l=d(function(h){return h?_.get(h,"enterprise_user")?_.intersection(_.get(h,"enterprise_user.teams",[]),_.get(TS.model.user,"enterprise_user.teams",[])):_.get(h,"team_id")===_.get(TS.model.user,"team_id")?[h.team_id]:[]:[]},"_getSharedTeamIdsForMember"),e=d(function(h){return h=h||{},h._is_new=!1,h.hasOwnProperty("query")||(h.query=""),h.hasOwnProperty("additional_args")||(h.additional_args={}),h._last_query!==h.query&&(h.hasOwnProperty("_searcher_p")&&h._searcher_p.cancel(),h._last_query=h.query,h._is_new=!0,h._cursor_mark=null,h.items=[]),_.isEqual(h._last_additional_args,h.additional_args)||(h.hasOwnProperty("_searcher_p")&&h._searcher_p.cancel(),h._last_additional_args=_.assign({},h.additional_args),h._is_new=!0,h._cursor_mark=null,h.items=[]),h},"_readyTeamSearcher"),n=d(function(h){var u=[TS.utility.search.makeClause("is","team")];h.query&&u.push(TS.utility.search.makeClause("fuzzy",h.query)),_.get(h,"included_ids.length")&&(h.included_ids.length===1?u.push(TS.utility.search.makeClause("id",_.head(h.included_ids))):u.push(TS.utility.search.makeConjunction("or",_.map(h.included_ids,S=>TS.utility.search.makeClause("id",S)))));var m={count:h.max_api_results||a,query:u.length>1?JSON.stringify(TS.utility.search.makeConjunction("and",u)):JSON.stringify(_.head(u))};return _.isEmpty(_.get(h,"additional_args"))||(m=_.merge(m,h.additional_args)),h._cursor_mark&&(m.cursor_mark=h._cursor_mark),m},"_buildPromiseToSearchTeamsArguments"),o=d(function(h){var u=d(function(){return c(h)},"promiseToSearch");return h._is_new?h._searcher_p=u():h._searcher_p=h._searcher_p.then(u),h._searcher_p},"_promiseToSearchTeams"),c=d(function(h){var u=_.get(h,"endpoint","search.enterprise"),m=_.get(h,"response_key","items");return TS.interop.api.call(u,n(h)).then(function(S){if(h._cursor_mark||(h.num_remaining=S.data.num_found,h.num_found=S.data.num_found),!S.data[m].length)return Promise.resolve(h);h.num_remaining-=S.data[m].length,h._cursor_mark=S.data.next_cursor_mark;var b=_.keyBy(h.omitted_ids,_.identity),w=_(S.data[m]).filter(x=>!b[x.id]).map(x=>TS.redux.teams.upsertTeam(x)).value();return h.num_found-=S.data[m].length-w.length,h.items=_.concat(h.items,w),Promise.resolve(h)})},"_promiseToSearchTeamsWorker"),v=d(function(){return _.get(TS.model,"team.enterprise_id",TS.boot_data.enterprise_id)},"_getEnterpriseId")})()},zmUN:function(se,ae){(function(){TS.registerModule("ui.enterprise_teams_dialog",{show:function(c){e(c)},test:function(){var c={};return Object.defineProperty(c,"_showTeamsDialog",{get:function(){return e},set:function(v){e=v}}),Object.defineProperty(c,"_getTeamsDialogChannelTitle",{get:function(){return n},set:function(v){n=v}}),Object.defineProperty(c,"_getTeamsDialogMemberTitle",{get:function(){return o},set:function(v){o=v}}),c}});var a="p-enterprise_teams_dialog",t="enterprise_team_dialog",f=null;function i(c){$(window.document).bind("keydown",l);var v=$(".p-searchable_enterprise_team_list"),h=new TS.SearchableEnterpriseTeamList({$container:v,id:t,model_ob_id:c.id,triggered_by_user_action:!0});h.showInitial(),v.on("click",".p-enterprise_team_row",TS.generic_dialog.cancel)}d(i,"_initDialogUI");var l=d(function(c){c.which==TS.utility.keymap.esc&&TS.generic_dialog.div.find("input").val()===""&&TS.generic_dialog.cancel()},"_onKeydown"),e=d(function(c){var v=_.get(c,"id");if(f!==v){f=v;var h=TS.templates.enterprise_teams_dialog(),u=TS.interop.utility.looksLikeMemberId(_.get(c,"id")),m;u&&!_.get(c,"enterprise_user.teams.length")||!u&&!c.is_global_shared&&!TS.interop.rules.channels.getInternalTeamIds(TS.redux.getState(),c)||(m=u?o(c):n(c),TS.generic_dialog.start({dialog_class:a,title:m,body:h,cancel_button_text:TS.interop.i18n.t("Close","teams")(),hide_footer:!0,show_cancel_button:!0,show_go_button:!1,backdrop_click_to_dismiss:!0,onShow:function(){i(c)},onEnd:function(){var S=TS.SearchableEnterpriseTeamList.get(t);S&&S.destroy(),TS.generic_dialog.div.remove(),TS.generic_dialog.div=void 0,$(window.document).unbind("keydown",l),f=null}}))}},"_showTeamsDialog"),n=d(function(c){return c.is_global_shared?TS.interop.i18n.t("All workspaces in {channel_name}","teams")({channel_name:TS.interop.rules.channels.getDisplayNameForChannel(c)}):TS.interop.i18n.t("{team_count, number} workspaces in {channel_name}","teams")({team_count:TS.interop.rules.channels.getInternalTeamIds(TS.redux.getState(),c).length,channel_name:TS.interop.rules.channels.getDisplayNameForChannel(c)})},"_getTeamsDialogChannelTitle"),o=d(function(c){return TS.interop.i18n.t("Your {enterprise_name} workspaces","teams")({enterprise_name:_.get(c,"enterprise_user.enterprise_name")})},"_getTeamsDialogMemberTitle")})()}},[["qYTV","webpack.manifest"]]]);})();
